create or replace procedure DATAHUB_INTEGRATION.SP_EAM_R5STANDWORKS()
    returns varchar not null
                language javascript
                as
                $$

//  Variables

var result = "";                                    // return status of this proc call
const process_name = Object.keys(this)[0];          // name of currently executing process
var number_of_rows_inserted = 0;                             // track number of rows we have inserted
var number_of_rows_updated = 0;                             // track number of rows we have updated


//  Step 1.

//  Start execution - log start

log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('Insert','" + process_name + "','Running','Started process execution.', 0,0,0);";
snowflake.execute({sqlText: log_sql_command});

snowflake.execute( {sqlText: "begin transaction;"} );
try
    {
        var sql_command = `
                            INSERT INTO LANDING_ERROR.EAM_RAW_ERROR
                            SELECT * FROM LANDING_ERROR.VW_STREAM_EAM_R5STANDWORKS_ERROR`;
    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();
        
        var sql_command = ` 
                            merge into  TARGET_EAM.EAM_R5STANDWORKS as target using (SELECT * FROM (SELECT 
            strm.STW_CLASS, 
            strm.STW_CLASS_ORG, 
            strm.STW_CODE, 
            strm.STW_CREATED, 
            strm.STW_CREATEDBY, 
            strm.STW_DESC, 
            strm.STW_DURATION, 
            strm.STW_JOBTYPE, 
            strm.STW_LASTSAVED, 
            strm.STW_NOTUSED, 
            strm.STW_OBCLASS, 
            strm.STW_OBCLASS_ORG, 
            strm.STW_OBJECT, 
            strm.STW_OBJECT_ORG, 
            strm.STW_OBRTYPE, 
            strm.STW_OBTYPE, 
            strm.STW_ORG, 
            strm.STW_PERMITREVIEWED, 
            strm.STW_PERMITREVIEWEDBY, 
            strm.STW_PERMITREVIEWEDNAME, 
            strm.STW_PERMITREVIEWEDTYPE, 
            strm.STW_PERMITREVIEWREQUIRED, 
            strm.STW_PRIORITY, 
            strm.STW_REQM, 
            strm.STW_SAFETYREVIEWED, 
            strm.STW_SAFETYREVIEWEDBY, 
            strm.STW_SAFETYREVIEWEDNAME, 
            strm.STW_SAFETYREVIEWEDTYPE, 
            strm.STW_SAFETYREVIEWREQUIRED, 
            strm.STW_TYPE, 
            strm.STW_UDFCHAR01, 
            strm.STW_UDFCHAR02, 
            strm.STW_UDFCHAR03, 
            strm.STW_UDFCHAR04, 
            strm.STW_UDFCHAR05, 
            strm.STW_UDFCHAR06, 
            strm.STW_UDFCHAR07, 
            strm.STW_UDFCHAR08, 
            strm.STW_UDFCHAR09, 
            strm.STW_UDFCHAR10, 
            strm.STW_UDFCHAR11, 
            strm.STW_UDFCHAR12, 
            strm.STW_UDFCHAR13, 
            strm.STW_UDFCHAR14, 
            strm.STW_UDFCHAR15, 
            strm.STW_UDFCHAR16, 
            strm.STW_UDFCHAR17, 
            strm.STW_UDFCHAR18, 
            strm.STW_UDFCHAR19, 
            strm.STW_UDFCHAR20, 
            strm.STW_UDFCHAR21, 
            strm.STW_UDFCHAR22, 
            strm.STW_UDFCHAR23, 
            strm.STW_UDFCHAR24, 
            strm.STW_UDFCHAR25, 
            strm.STW_UDFCHAR26, 
            strm.STW_UDFCHAR27, 
            strm.STW_UDFCHAR28, 
            strm.STW_UDFCHAR29, 
            strm.STW_UDFCHAR30, 
            strm.STW_UDFCHAR31, 
            strm.STW_UDFCHAR32, 
            strm.STW_UDFCHAR33, 
            strm.STW_UDFCHAR34, 
            strm.STW_UDFCHAR35, 
            strm.STW_UDFCHAR36, 
            strm.STW_UDFCHAR37, 
            strm.STW_UDFCHAR38, 
            strm.STW_UDFCHAR39, 
            strm.STW_UDFCHAR40, 
            strm.STW_UDFCHAR41, 
            strm.STW_UDFCHAR42, 
            strm.STW_UDFCHAR43, 
            strm.STW_UDFCHAR44, 
            strm.STW_UDFCHAR45, 
            strm.STW_UDFCHAR46, 
            strm.STW_UDFCHAR47, 
            strm.STW_UDFCHAR48, 
            strm.STW_UDFCHAR49, 
            strm.STW_UDFCHAR50, 
            strm.STW_UDFCHAR51, 
            strm.STW_UDFCHAR52, 
            strm.STW_UDFCHAR53, 
            strm.STW_UDFCHAR54, 
            strm.STW_UDFCHAR55, 
            strm.STW_UDFCHKBOX01, 
            strm.STW_UDFCHKBOX02, 
            strm.STW_UDFCHKBOX03, 
            strm.STW_UDFCHKBOX04, 
            strm.STW_UDFCHKBOX05, 
            strm.STW_UDFCHKBOX06, 
            strm.STW_UDFCHKBOX07, 
            strm.STW_UDFCHKBOX08, 
            strm.STW_UDFCHKBOX09, 
            strm.STW_UDFCHKBOX10, 
            strm.STW_UDFDATE01, 
            strm.STW_UDFDATE02, 
            strm.STW_UDFDATE03, 
            strm.STW_UDFDATE04, 
            strm.STW_UDFDATE05, 
            strm.STW_UDFDATE06, 
            strm.STW_UDFDATE07, 
            strm.STW_UDFDATE08, 
            strm.STW_UDFDATE09, 
            strm.STW_UDFDATE10, 
            strm.STW_UDFNOTE01, 
            strm.STW_UDFNOTE02, 
            strm.STW_UDFNUM01, 
            strm.STW_UDFNUM02, 
            strm.STW_UDFNUM03, 
            strm.STW_UDFNUM04, 
            strm.STW_UDFNUM05, 
            strm.STW_UDFNUM06, 
            strm.STW_UDFNUM07, 
            strm.STW_UDFNUM08, 
            strm.STW_UDFNUM09, 
            strm.STW_UDFNUM10, 
            strm.STW_UPDATECOUNT, 
            strm.STW_UPDATED, 
            strm.STW_UPDATEDBY, 
            strm.STW_WOCLASS, 
            strm.STW_WOCLASS_ORG, 
            strm._DELETED, 
            strm.ETL_LASTSAVED,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.STW_CODE ORDER BY strm.ETL_LASTSAVED desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_EAM_R5STANDWORKS as  strm
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.STW_CODE=src.STW_CODE) OR (target.STW_CODE IS NULL AND src.STW_CODE IS NULL)) 
                when matched and src.ETL_DELETED=TRUE THEN DELETE
                when matched then update set
                    target.STW_CLASS=src.STW_CLASS, 
                    target.STW_CLASS_ORG=src.STW_CLASS_ORG, 
                    target.STW_CODE=src.STW_CODE, 
                    target.STW_CREATED=src.STW_CREATED, 
                    target.STW_CREATEDBY=src.STW_CREATEDBY, 
                    target.STW_DESC=src.STW_DESC, 
                    target.STW_DURATION=src.STW_DURATION, 
                    target.STW_JOBTYPE=src.STW_JOBTYPE, 
                    target.STW_LASTSAVED=src.STW_LASTSAVED, 
                    target.STW_NOTUSED=src.STW_NOTUSED, 
                    target.STW_OBCLASS=src.STW_OBCLASS, 
                    target.STW_OBCLASS_ORG=src.STW_OBCLASS_ORG, 
                    target.STW_OBJECT=src.STW_OBJECT, 
                    target.STW_OBJECT_ORG=src.STW_OBJECT_ORG, 
                    target.STW_OBRTYPE=src.STW_OBRTYPE, 
                    target.STW_OBTYPE=src.STW_OBTYPE, 
                    target.STW_ORG=src.STW_ORG, 
                    target.STW_PERMITREVIEWED=src.STW_PERMITREVIEWED, 
                    target.STW_PERMITREVIEWEDBY=src.STW_PERMITREVIEWEDBY, 
                    target.STW_PERMITREVIEWEDNAME=src.STW_PERMITREVIEWEDNAME, 
                    target.STW_PERMITREVIEWEDTYPE=src.STW_PERMITREVIEWEDTYPE, 
                    target.STW_PERMITREVIEWREQUIRED=src.STW_PERMITREVIEWREQUIRED, 
                    target.STW_PRIORITY=src.STW_PRIORITY, 
                    target.STW_REQM=src.STW_REQM, 
                    target.STW_SAFETYREVIEWED=src.STW_SAFETYREVIEWED, 
                    target.STW_SAFETYREVIEWEDBY=src.STW_SAFETYREVIEWEDBY, 
                    target.STW_SAFETYREVIEWEDNAME=src.STW_SAFETYREVIEWEDNAME, 
                    target.STW_SAFETYREVIEWEDTYPE=src.STW_SAFETYREVIEWEDTYPE, 
                    target.STW_SAFETYREVIEWREQUIRED=src.STW_SAFETYREVIEWREQUIRED, 
                    target.STW_TYPE=src.STW_TYPE, 
                    target.STW_UDFCHAR01=src.STW_UDFCHAR01, 
                    target.STW_UDFCHAR02=src.STW_UDFCHAR02, 
                    target.STW_UDFCHAR03=src.STW_UDFCHAR03, 
                    target.STW_UDFCHAR04=src.STW_UDFCHAR04, 
                    target.STW_UDFCHAR05=src.STW_UDFCHAR05, 
                    target.STW_UDFCHAR06=src.STW_UDFCHAR06, 
                    target.STW_UDFCHAR07=src.STW_UDFCHAR07, 
                    target.STW_UDFCHAR08=src.STW_UDFCHAR08, 
                    target.STW_UDFCHAR09=src.STW_UDFCHAR09, 
                    target.STW_UDFCHAR10=src.STW_UDFCHAR10, 
                    target.STW_UDFCHAR11=src.STW_UDFCHAR11, 
                    target.STW_UDFCHAR12=src.STW_UDFCHAR12, 
                    target.STW_UDFCHAR13=src.STW_UDFCHAR13, 
                    target.STW_UDFCHAR14=src.STW_UDFCHAR14, 
                    target.STW_UDFCHAR15=src.STW_UDFCHAR15, 
                    target.STW_UDFCHAR16=src.STW_UDFCHAR16, 
                    target.STW_UDFCHAR17=src.STW_UDFCHAR17, 
                    target.STW_UDFCHAR18=src.STW_UDFCHAR18, 
                    target.STW_UDFCHAR19=src.STW_UDFCHAR19, 
                    target.STW_UDFCHAR20=src.STW_UDFCHAR20, 
                    target.STW_UDFCHAR21=src.STW_UDFCHAR21, 
                    target.STW_UDFCHAR22=src.STW_UDFCHAR22, 
                    target.STW_UDFCHAR23=src.STW_UDFCHAR23, 
                    target.STW_UDFCHAR24=src.STW_UDFCHAR24, 
                    target.STW_UDFCHAR25=src.STW_UDFCHAR25, 
                    target.STW_UDFCHAR26=src.STW_UDFCHAR26, 
                    target.STW_UDFCHAR27=src.STW_UDFCHAR27, 
                    target.STW_UDFCHAR28=src.STW_UDFCHAR28, 
                    target.STW_UDFCHAR29=src.STW_UDFCHAR29, 
                    target.STW_UDFCHAR30=src.STW_UDFCHAR30, 
                    target.STW_UDFCHAR31=src.STW_UDFCHAR31, 
                    target.STW_UDFCHAR32=src.STW_UDFCHAR32, 
                    target.STW_UDFCHAR33=src.STW_UDFCHAR33, 
                    target.STW_UDFCHAR34=src.STW_UDFCHAR34, 
                    target.STW_UDFCHAR35=src.STW_UDFCHAR35, 
                    target.STW_UDFCHAR36=src.STW_UDFCHAR36, 
                    target.STW_UDFCHAR37=src.STW_UDFCHAR37, 
                    target.STW_UDFCHAR38=src.STW_UDFCHAR38, 
                    target.STW_UDFCHAR39=src.STW_UDFCHAR39, 
                    target.STW_UDFCHAR40=src.STW_UDFCHAR40, 
                    target.STW_UDFCHAR41=src.STW_UDFCHAR41, 
                    target.STW_UDFCHAR42=src.STW_UDFCHAR42, 
                    target.STW_UDFCHAR43=src.STW_UDFCHAR43, 
                    target.STW_UDFCHAR44=src.STW_UDFCHAR44, 
                    target.STW_UDFCHAR45=src.STW_UDFCHAR45, 
                    target.STW_UDFCHAR46=src.STW_UDFCHAR46, 
                    target.STW_UDFCHAR47=src.STW_UDFCHAR47, 
                    target.STW_UDFCHAR48=src.STW_UDFCHAR48, 
                    target.STW_UDFCHAR49=src.STW_UDFCHAR49, 
                    target.STW_UDFCHAR50=src.STW_UDFCHAR50, 
                    target.STW_UDFCHAR51=src.STW_UDFCHAR51, 
                    target.STW_UDFCHAR52=src.STW_UDFCHAR52, 
                    target.STW_UDFCHAR53=src.STW_UDFCHAR53, 
                    target.STW_UDFCHAR54=src.STW_UDFCHAR54, 
                    target.STW_UDFCHAR55=src.STW_UDFCHAR55, 
                    target.STW_UDFCHKBOX01=src.STW_UDFCHKBOX01, 
                    target.STW_UDFCHKBOX02=src.STW_UDFCHKBOX02, 
                    target.STW_UDFCHKBOX03=src.STW_UDFCHKBOX03, 
                    target.STW_UDFCHKBOX04=src.STW_UDFCHKBOX04, 
                    target.STW_UDFCHKBOX05=src.STW_UDFCHKBOX05, 
                    target.STW_UDFCHKBOX06=src.STW_UDFCHKBOX06, 
                    target.STW_UDFCHKBOX07=src.STW_UDFCHKBOX07, 
                    target.STW_UDFCHKBOX08=src.STW_UDFCHKBOX08, 
                    target.STW_UDFCHKBOX09=src.STW_UDFCHKBOX09, 
                    target.STW_UDFCHKBOX10=src.STW_UDFCHKBOX10, 
                    target.STW_UDFDATE01=src.STW_UDFDATE01, 
                    target.STW_UDFDATE02=src.STW_UDFDATE02, 
                    target.STW_UDFDATE03=src.STW_UDFDATE03, 
                    target.STW_UDFDATE04=src.STW_UDFDATE04, 
                    target.STW_UDFDATE05=src.STW_UDFDATE05, 
                    target.STW_UDFDATE06=src.STW_UDFDATE06, 
                    target.STW_UDFDATE07=src.STW_UDFDATE07, 
                    target.STW_UDFDATE08=src.STW_UDFDATE08, 
                    target.STW_UDFDATE09=src.STW_UDFDATE09, 
                    target.STW_UDFDATE10=src.STW_UDFDATE10, 
                    target.STW_UDFNOTE01=src.STW_UDFNOTE01, 
                    target.STW_UDFNOTE02=src.STW_UDFNOTE02, 
                    target.STW_UDFNUM01=src.STW_UDFNUM01, 
                    target.STW_UDFNUM02=src.STW_UDFNUM02, 
                    target.STW_UDFNUM03=src.STW_UDFNUM03, 
                    target.STW_UDFNUM04=src.STW_UDFNUM04, 
                    target.STW_UDFNUM05=src.STW_UDFNUM05, 
                    target.STW_UDFNUM06=src.STW_UDFNUM06, 
                    target.STW_UDFNUM07=src.STW_UDFNUM07, 
                    target.STW_UDFNUM08=src.STW_UDFNUM08, 
                    target.STW_UDFNUM09=src.STW_UDFNUM09, 
                    target.STW_UDFNUM10=src.STW_UDFNUM10, 
                    target.STW_UPDATECOUNT=src.STW_UPDATECOUNT, 
                    target.STW_UPDATED=src.STW_UPDATED, 
                    target.STW_UPDATEDBY=src.STW_UPDATEDBY, 
                    target.STW_WOCLASS=src.STW_WOCLASS, 
                    target.STW_WOCLASS_ORG=src.STW_WOCLASS_ORG, 
                    target._DELETED=src._DELETED, 
                    target.ETL_LASTSAVED=src.ETL_LASTSAVED,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename
        when not matched and (src.ETL_DELETED=FALSE OR src.ETL_DELETED IS NULL)  then insert ( 
                    STW_CLASS, 
                    STW_CLASS_ORG, 
                    STW_CODE, 
                    STW_CREATED, 
                    STW_CREATEDBY, 
                    STW_DESC, 
                    STW_DURATION, 
                    STW_JOBTYPE, 
                    STW_LASTSAVED, 
                    STW_NOTUSED, 
                    STW_OBCLASS, 
                    STW_OBCLASS_ORG, 
                    STW_OBJECT, 
                    STW_OBJECT_ORG, 
                    STW_OBRTYPE, 
                    STW_OBTYPE, 
                    STW_ORG, 
                    STW_PERMITREVIEWED, 
                    STW_PERMITREVIEWEDBY, 
                    STW_PERMITREVIEWEDNAME, 
                    STW_PERMITREVIEWEDTYPE, 
                    STW_PERMITREVIEWREQUIRED, 
                    STW_PRIORITY, 
                    STW_REQM, 
                    STW_SAFETYREVIEWED, 
                    STW_SAFETYREVIEWEDBY, 
                    STW_SAFETYREVIEWEDNAME, 
                    STW_SAFETYREVIEWEDTYPE, 
                    STW_SAFETYREVIEWREQUIRED, 
                    STW_TYPE, 
                    STW_UDFCHAR01, 
                    STW_UDFCHAR02, 
                    STW_UDFCHAR03, 
                    STW_UDFCHAR04, 
                    STW_UDFCHAR05, 
                    STW_UDFCHAR06, 
                    STW_UDFCHAR07, 
                    STW_UDFCHAR08, 
                    STW_UDFCHAR09, 
                    STW_UDFCHAR10, 
                    STW_UDFCHAR11, 
                    STW_UDFCHAR12, 
                    STW_UDFCHAR13, 
                    STW_UDFCHAR14, 
                    STW_UDFCHAR15, 
                    STW_UDFCHAR16, 
                    STW_UDFCHAR17, 
                    STW_UDFCHAR18, 
                    STW_UDFCHAR19, 
                    STW_UDFCHAR20, 
                    STW_UDFCHAR21, 
                    STW_UDFCHAR22, 
                    STW_UDFCHAR23, 
                    STW_UDFCHAR24, 
                    STW_UDFCHAR25, 
                    STW_UDFCHAR26, 
                    STW_UDFCHAR27, 
                    STW_UDFCHAR28, 
                    STW_UDFCHAR29, 
                    STW_UDFCHAR30, 
                    STW_UDFCHAR31, 
                    STW_UDFCHAR32, 
                    STW_UDFCHAR33, 
                    STW_UDFCHAR34, 
                    STW_UDFCHAR35, 
                    STW_UDFCHAR36, 
                    STW_UDFCHAR37, 
                    STW_UDFCHAR38, 
                    STW_UDFCHAR39, 
                    STW_UDFCHAR40, 
                    STW_UDFCHAR41, 
                    STW_UDFCHAR42, 
                    STW_UDFCHAR43, 
                    STW_UDFCHAR44, 
                    STW_UDFCHAR45, 
                    STW_UDFCHAR46, 
                    STW_UDFCHAR47, 
                    STW_UDFCHAR48, 
                    STW_UDFCHAR49, 
                    STW_UDFCHAR50, 
                    STW_UDFCHAR51, 
                    STW_UDFCHAR52, 
                    STW_UDFCHAR53, 
                    STW_UDFCHAR54, 
                    STW_UDFCHAR55, 
                    STW_UDFCHKBOX01, 
                    STW_UDFCHKBOX02, 
                    STW_UDFCHKBOX03, 
                    STW_UDFCHKBOX04, 
                    STW_UDFCHKBOX05, 
                    STW_UDFCHKBOX06, 
                    STW_UDFCHKBOX07, 
                    STW_UDFCHKBOX08, 
                    STW_UDFCHKBOX09, 
                    STW_UDFCHKBOX10, 
                    STW_UDFDATE01, 
                    STW_UDFDATE02, 
                    STW_UDFDATE03, 
                    STW_UDFDATE04, 
                    STW_UDFDATE05, 
                    STW_UDFDATE06, 
                    STW_UDFDATE07, 
                    STW_UDFDATE08, 
                    STW_UDFDATE09, 
                    STW_UDFDATE10, 
                    STW_UDFNOTE01, 
                    STW_UDFNOTE02, 
                    STW_UDFNUM01, 
                    STW_UDFNUM02, 
                    STW_UDFNUM03, 
                    STW_UDFNUM04, 
                    STW_UDFNUM05, 
                    STW_UDFNUM06, 
                    STW_UDFNUM07, 
                    STW_UDFNUM08, 
                    STW_UDFNUM09, 
                    STW_UDFNUM10, 
                    STW_UPDATECOUNT, 
                    STW_UPDATED, 
                    STW_UPDATEDBY, 
                    STW_WOCLASS, 
                    STW_WOCLASS_ORG, 
                    _DELETED, 
                    ETL_LASTSAVED,                       
                    etl_load_datetime,
                    etl_load_metadatafilename) 
            values (
                    src.STW_CLASS, 
                    src.STW_CLASS_ORG, 
                    src.STW_CODE, 
                    src.STW_CREATED, 
                    src.STW_CREATEDBY, 
                    src.STW_DESC, 
                    src.STW_DURATION, 
                    src.STW_JOBTYPE, 
                    src.STW_LASTSAVED, 
                    src.STW_NOTUSED, 
                    src.STW_OBCLASS, 
                    src.STW_OBCLASS_ORG, 
                    src.STW_OBJECT, 
                    src.STW_OBJECT_ORG, 
                    src.STW_OBRTYPE, 
                    src.STW_OBTYPE, 
                    src.STW_ORG, 
                    src.STW_PERMITREVIEWED, 
                    src.STW_PERMITREVIEWEDBY, 
                    src.STW_PERMITREVIEWEDNAME, 
                    src.STW_PERMITREVIEWEDTYPE, 
                    src.STW_PERMITREVIEWREQUIRED, 
                    src.STW_PRIORITY, 
                    src.STW_REQM, 
                    src.STW_SAFETYREVIEWED, 
                    src.STW_SAFETYREVIEWEDBY, 
                    src.STW_SAFETYREVIEWEDNAME, 
                    src.STW_SAFETYREVIEWEDTYPE, 
                    src.STW_SAFETYREVIEWREQUIRED, 
                    src.STW_TYPE, 
                    src.STW_UDFCHAR01, 
                    src.STW_UDFCHAR02, 
                    src.STW_UDFCHAR03, 
                    src.STW_UDFCHAR04, 
                    src.STW_UDFCHAR05, 
                    src.STW_UDFCHAR06, 
                    src.STW_UDFCHAR07, 
                    src.STW_UDFCHAR08, 
                    src.STW_UDFCHAR09, 
                    src.STW_UDFCHAR10, 
                    src.STW_UDFCHAR11, 
                    src.STW_UDFCHAR12, 
                    src.STW_UDFCHAR13, 
                    src.STW_UDFCHAR14, 
                    src.STW_UDFCHAR15, 
                    src.STW_UDFCHAR16, 
                    src.STW_UDFCHAR17, 
                    src.STW_UDFCHAR18, 
                    src.STW_UDFCHAR19, 
                    src.STW_UDFCHAR20, 
                    src.STW_UDFCHAR21, 
                    src.STW_UDFCHAR22, 
                    src.STW_UDFCHAR23, 
                    src.STW_UDFCHAR24, 
                    src.STW_UDFCHAR25, 
                    src.STW_UDFCHAR26, 
                    src.STW_UDFCHAR27, 
                    src.STW_UDFCHAR28, 
                    src.STW_UDFCHAR29, 
                    src.STW_UDFCHAR30, 
                    src.STW_UDFCHAR31, 
                    src.STW_UDFCHAR32, 
                    src.STW_UDFCHAR33, 
                    src.STW_UDFCHAR34, 
                    src.STW_UDFCHAR35, 
                    src.STW_UDFCHAR36, 
                    src.STW_UDFCHAR37, 
                    src.STW_UDFCHAR38, 
                    src.STW_UDFCHAR39, 
                    src.STW_UDFCHAR40, 
                    src.STW_UDFCHAR41, 
                    src.STW_UDFCHAR42, 
                    src.STW_UDFCHAR43, 
                    src.STW_UDFCHAR44, 
                    src.STW_UDFCHAR45, 
                    src.STW_UDFCHAR46, 
                    src.STW_UDFCHAR47, 
                    src.STW_UDFCHAR48, 
                    src.STW_UDFCHAR49, 
                    src.STW_UDFCHAR50, 
                    src.STW_UDFCHAR51, 
                    src.STW_UDFCHAR52, 
                    src.STW_UDFCHAR53, 
                    src.STW_UDFCHAR54, 
                    src.STW_UDFCHAR55, 
                    src.STW_UDFCHKBOX01, 
                    src.STW_UDFCHKBOX02, 
                    src.STW_UDFCHKBOX03, 
                    src.STW_UDFCHKBOX04, 
                    src.STW_UDFCHKBOX05, 
                    src.STW_UDFCHKBOX06, 
                    src.STW_UDFCHKBOX07, 
                    src.STW_UDFCHKBOX08, 
                    src.STW_UDFCHKBOX09, 
                    src.STW_UDFCHKBOX10, 
                    src.STW_UDFDATE01, 
                    src.STW_UDFDATE02, 
                    src.STW_UDFDATE03, 
                    src.STW_UDFDATE04, 
                    src.STW_UDFDATE05, 
                    src.STW_UDFDATE06, 
                    src.STW_UDFDATE07, 
                    src.STW_UDFDATE08, 
                    src.STW_UDFDATE09, 
                    src.STW_UDFDATE10, 
                    src.STW_UDFNOTE01, 
                    src.STW_UDFNOTE02, 
                    src.STW_UDFNUM01, 
                    src.STW_UDFNUM02, 
                    src.STW_UDFNUM03, 
                    src.STW_UDFNUM04, 
                    src.STW_UDFNUM05, 
                    src.STW_UDFNUM06, 
                    src.STW_UDFNUM07, 
                    src.STW_UDFNUM08, 
                    src.STW_UDFNUM09, 
                    src.STW_UDFNUM10, 
                    src.STW_UPDATECOUNT, 
                    src.STW_UPDATED, 
                    src.STW_UPDATEDBY, 
                    src.STW_WOCLASS, 
                    src.STW_WOCLASS_ORG, 
                    src._DELETED,     
                    src.ETL_LASTSAVED,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename);`;

    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();

    snowflake.execute( {sqlText: `merge into TARGET_HISTORY_EAM.EAM_R5STANDWORKS_DELETED as target using (
                SELECT * FROM (SELECT 
            strm.STW_CLASS, 
            strm.STW_CLASS_ORG, 
            strm.STW_CODE, 
            strm.STW_CREATED, 
            strm.STW_CREATEDBY, 
            strm.STW_DESC, 
            strm.STW_DURATION, 
            strm.STW_JOBTYPE, 
            strm.STW_LASTSAVED, 
            strm.STW_NOTUSED, 
            strm.STW_OBCLASS, 
            strm.STW_OBCLASS_ORG, 
            strm.STW_OBJECT, 
            strm.STW_OBJECT_ORG, 
            strm.STW_OBRTYPE, 
            strm.STW_OBTYPE, 
            strm.STW_ORG, 
            strm.STW_PERMITREVIEWED, 
            strm.STW_PERMITREVIEWEDBY, 
            strm.STW_PERMITREVIEWEDNAME, 
            strm.STW_PERMITREVIEWEDTYPE, 
            strm.STW_PERMITREVIEWREQUIRED, 
            strm.STW_PRIORITY, 
            strm.STW_REQM, 
            strm.STW_SAFETYREVIEWED, 
            strm.STW_SAFETYREVIEWEDBY, 
            strm.STW_SAFETYREVIEWEDNAME, 
            strm.STW_SAFETYREVIEWEDTYPE, 
            strm.STW_SAFETYREVIEWREQUIRED, 
            strm.STW_TYPE, 
            strm.STW_UDFCHAR01, 
            strm.STW_UDFCHAR02, 
            strm.STW_UDFCHAR03, 
            strm.STW_UDFCHAR04, 
            strm.STW_UDFCHAR05, 
            strm.STW_UDFCHAR06, 
            strm.STW_UDFCHAR07, 
            strm.STW_UDFCHAR08, 
            strm.STW_UDFCHAR09, 
            strm.STW_UDFCHAR10, 
            strm.STW_UDFCHAR11, 
            strm.STW_UDFCHAR12, 
            strm.STW_UDFCHAR13, 
            strm.STW_UDFCHAR14, 
            strm.STW_UDFCHAR15, 
            strm.STW_UDFCHAR16, 
            strm.STW_UDFCHAR17, 
            strm.STW_UDFCHAR18, 
            strm.STW_UDFCHAR19, 
            strm.STW_UDFCHAR20, 
            strm.STW_UDFCHAR21, 
            strm.STW_UDFCHAR22, 
            strm.STW_UDFCHAR23, 
            strm.STW_UDFCHAR24, 
            strm.STW_UDFCHAR25, 
            strm.STW_UDFCHAR26, 
            strm.STW_UDFCHAR27, 
            strm.STW_UDFCHAR28, 
            strm.STW_UDFCHAR29, 
            strm.STW_UDFCHAR30, 
            strm.STW_UDFCHAR31, 
            strm.STW_UDFCHAR32, 
            strm.STW_UDFCHAR33, 
            strm.STW_UDFCHAR34, 
            strm.STW_UDFCHAR35, 
            strm.STW_UDFCHAR36, 
            strm.STW_UDFCHAR37, 
            strm.STW_UDFCHAR38, 
            strm.STW_UDFCHAR39, 
            strm.STW_UDFCHAR40, 
            strm.STW_UDFCHAR41, 
            strm.STW_UDFCHAR42, 
            strm.STW_UDFCHAR43, 
            strm.STW_UDFCHAR44, 
            strm.STW_UDFCHAR45, 
            strm.STW_UDFCHAR46, 
            strm.STW_UDFCHAR47, 
            strm.STW_UDFCHAR48, 
            strm.STW_UDFCHAR49, 
            strm.STW_UDFCHAR50, 
            strm.STW_UDFCHAR51, 
            strm.STW_UDFCHAR52, 
            strm.STW_UDFCHAR53, 
            strm.STW_UDFCHAR54, 
            strm.STW_UDFCHAR55, 
            strm.STW_UDFCHKBOX01, 
            strm.STW_UDFCHKBOX02, 
            strm.STW_UDFCHKBOX03, 
            strm.STW_UDFCHKBOX04, 
            strm.STW_UDFCHKBOX05, 
            strm.STW_UDFCHKBOX06, 
            strm.STW_UDFCHKBOX07, 
            strm.STW_UDFCHKBOX08, 
            strm.STW_UDFCHKBOX09, 
            strm.STW_UDFCHKBOX10, 
            strm.STW_UDFDATE01, 
            strm.STW_UDFDATE02, 
            strm.STW_UDFDATE03, 
            strm.STW_UDFDATE04, 
            strm.STW_UDFDATE05, 
            strm.STW_UDFDATE06, 
            strm.STW_UDFDATE07, 
            strm.STW_UDFDATE08, 
            strm.STW_UDFDATE09, 
            strm.STW_UDFDATE10, 
            strm.STW_UDFNOTE01, 
            strm.STW_UDFNOTE02, 
            strm.STW_UDFNUM01, 
            strm.STW_UDFNUM02, 
            strm.STW_UDFNUM03, 
            strm.STW_UDFNUM04, 
            strm.STW_UDFNUM05, 
            strm.STW_UDFNUM06, 
            strm.STW_UDFNUM07, 
            strm.STW_UDFNUM08, 
            strm.STW_UDFNUM09, 
            strm.STW_UDFNUM10, 
            strm.STW_UPDATECOUNT, 
            strm.STW_UPDATED, 
            strm.STW_UPDATEDBY, 
            strm.STW_WOCLASS, 
            strm.STW_WOCLASS_ORG, 
            strm._DELETED, 
            strm.ETL_LASTSAVED,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.STW_CODE ORDER BY strm.ETL_LASTSAVED desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_EAM_R5STANDWORKS as  strm
        WHERE strm.ETL_DELETED=TRUE
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.STW_CODE=src.STW_CODE) OR (target.STW_CODE IS NULL AND src.STW_CODE IS NULL)) 
                when matched then update set
                    target.STW_CLASS=src.STW_CLASS, 
                    target.STW_CLASS_ORG=src.STW_CLASS_ORG, 
                    target.STW_CODE=src.STW_CODE, 
                    target.STW_CREATED=src.STW_CREATED, 
                    target.STW_CREATEDBY=src.STW_CREATEDBY, 
                    target.STW_DESC=src.STW_DESC, 
                    target.STW_DURATION=src.STW_DURATION, 
                    target.STW_JOBTYPE=src.STW_JOBTYPE, 
                    target.STW_LASTSAVED=src.STW_LASTSAVED, 
                    target.STW_NOTUSED=src.STW_NOTUSED, 
                    target.STW_OBCLASS=src.STW_OBCLASS, 
                    target.STW_OBCLASS_ORG=src.STW_OBCLASS_ORG, 
                    target.STW_OBJECT=src.STW_OBJECT, 
                    target.STW_OBJECT_ORG=src.STW_OBJECT_ORG, 
                    target.STW_OBRTYPE=src.STW_OBRTYPE, 
                    target.STW_OBTYPE=src.STW_OBTYPE, 
                    target.STW_ORG=src.STW_ORG, 
                    target.STW_PERMITREVIEWED=src.STW_PERMITREVIEWED, 
                    target.STW_PERMITREVIEWEDBY=src.STW_PERMITREVIEWEDBY, 
                    target.STW_PERMITREVIEWEDNAME=src.STW_PERMITREVIEWEDNAME, 
                    target.STW_PERMITREVIEWEDTYPE=src.STW_PERMITREVIEWEDTYPE, 
                    target.STW_PERMITREVIEWREQUIRED=src.STW_PERMITREVIEWREQUIRED, 
                    target.STW_PRIORITY=src.STW_PRIORITY, 
                    target.STW_REQM=src.STW_REQM, 
                    target.STW_SAFETYREVIEWED=src.STW_SAFETYREVIEWED, 
                    target.STW_SAFETYREVIEWEDBY=src.STW_SAFETYREVIEWEDBY, 
                    target.STW_SAFETYREVIEWEDNAME=src.STW_SAFETYREVIEWEDNAME, 
                    target.STW_SAFETYREVIEWEDTYPE=src.STW_SAFETYREVIEWEDTYPE, 
                    target.STW_SAFETYREVIEWREQUIRED=src.STW_SAFETYREVIEWREQUIRED, 
                    target.STW_TYPE=src.STW_TYPE, 
                    target.STW_UDFCHAR01=src.STW_UDFCHAR01, 
                    target.STW_UDFCHAR02=src.STW_UDFCHAR02, 
                    target.STW_UDFCHAR03=src.STW_UDFCHAR03, 
                    target.STW_UDFCHAR04=src.STW_UDFCHAR04, 
                    target.STW_UDFCHAR05=src.STW_UDFCHAR05, 
                    target.STW_UDFCHAR06=src.STW_UDFCHAR06, 
                    target.STW_UDFCHAR07=src.STW_UDFCHAR07, 
                    target.STW_UDFCHAR08=src.STW_UDFCHAR08, 
                    target.STW_UDFCHAR09=src.STW_UDFCHAR09, 
                    target.STW_UDFCHAR10=src.STW_UDFCHAR10, 
                    target.STW_UDFCHAR11=src.STW_UDFCHAR11, 
                    target.STW_UDFCHAR12=src.STW_UDFCHAR12, 
                    target.STW_UDFCHAR13=src.STW_UDFCHAR13, 
                    target.STW_UDFCHAR14=src.STW_UDFCHAR14, 
                    target.STW_UDFCHAR15=src.STW_UDFCHAR15, 
                    target.STW_UDFCHAR16=src.STW_UDFCHAR16, 
                    target.STW_UDFCHAR17=src.STW_UDFCHAR17, 
                    target.STW_UDFCHAR18=src.STW_UDFCHAR18, 
                    target.STW_UDFCHAR19=src.STW_UDFCHAR19, 
                    target.STW_UDFCHAR20=src.STW_UDFCHAR20, 
                    target.STW_UDFCHAR21=src.STW_UDFCHAR21, 
                    target.STW_UDFCHAR22=src.STW_UDFCHAR22, 
                    target.STW_UDFCHAR23=src.STW_UDFCHAR23, 
                    target.STW_UDFCHAR24=src.STW_UDFCHAR24, 
                    target.STW_UDFCHAR25=src.STW_UDFCHAR25, 
                    target.STW_UDFCHAR26=src.STW_UDFCHAR26, 
                    target.STW_UDFCHAR27=src.STW_UDFCHAR27, 
                    target.STW_UDFCHAR28=src.STW_UDFCHAR28, 
                    target.STW_UDFCHAR29=src.STW_UDFCHAR29, 
                    target.STW_UDFCHAR30=src.STW_UDFCHAR30, 
                    target.STW_UDFCHAR31=src.STW_UDFCHAR31, 
                    target.STW_UDFCHAR32=src.STW_UDFCHAR32, 
                    target.STW_UDFCHAR33=src.STW_UDFCHAR33, 
                    target.STW_UDFCHAR34=src.STW_UDFCHAR34, 
                    target.STW_UDFCHAR35=src.STW_UDFCHAR35, 
                    target.STW_UDFCHAR36=src.STW_UDFCHAR36, 
                    target.STW_UDFCHAR37=src.STW_UDFCHAR37, 
                    target.STW_UDFCHAR38=src.STW_UDFCHAR38, 
                    target.STW_UDFCHAR39=src.STW_UDFCHAR39, 
                    target.STW_UDFCHAR40=src.STW_UDFCHAR40, 
                    target.STW_UDFCHAR41=src.STW_UDFCHAR41, 
                    target.STW_UDFCHAR42=src.STW_UDFCHAR42, 
                    target.STW_UDFCHAR43=src.STW_UDFCHAR43, 
                    target.STW_UDFCHAR44=src.STW_UDFCHAR44, 
                    target.STW_UDFCHAR45=src.STW_UDFCHAR45, 
                    target.STW_UDFCHAR46=src.STW_UDFCHAR46, 
                    target.STW_UDFCHAR47=src.STW_UDFCHAR47, 
                    target.STW_UDFCHAR48=src.STW_UDFCHAR48, 
                    target.STW_UDFCHAR49=src.STW_UDFCHAR49, 
                    target.STW_UDFCHAR50=src.STW_UDFCHAR50, 
                    target.STW_UDFCHAR51=src.STW_UDFCHAR51, 
                    target.STW_UDFCHAR52=src.STW_UDFCHAR52, 
                    target.STW_UDFCHAR53=src.STW_UDFCHAR53, 
                    target.STW_UDFCHAR54=src.STW_UDFCHAR54, 
                    target.STW_UDFCHAR55=src.STW_UDFCHAR55, 
                    target.STW_UDFCHKBOX01=src.STW_UDFCHKBOX01, 
                    target.STW_UDFCHKBOX02=src.STW_UDFCHKBOX02, 
                    target.STW_UDFCHKBOX03=src.STW_UDFCHKBOX03, 
                    target.STW_UDFCHKBOX04=src.STW_UDFCHKBOX04, 
                    target.STW_UDFCHKBOX05=src.STW_UDFCHKBOX05, 
                    target.STW_UDFCHKBOX06=src.STW_UDFCHKBOX06, 
                    target.STW_UDFCHKBOX07=src.STW_UDFCHKBOX07, 
                    target.STW_UDFCHKBOX08=src.STW_UDFCHKBOX08, 
                    target.STW_UDFCHKBOX09=src.STW_UDFCHKBOX09, 
                    target.STW_UDFCHKBOX10=src.STW_UDFCHKBOX10, 
                    target.STW_UDFDATE01=src.STW_UDFDATE01, 
                    target.STW_UDFDATE02=src.STW_UDFDATE02, 
                    target.STW_UDFDATE03=src.STW_UDFDATE03, 
                    target.STW_UDFDATE04=src.STW_UDFDATE04, 
                    target.STW_UDFDATE05=src.STW_UDFDATE05, 
                    target.STW_UDFDATE06=src.STW_UDFDATE06, 
                    target.STW_UDFDATE07=src.STW_UDFDATE07, 
                    target.STW_UDFDATE08=src.STW_UDFDATE08, 
                    target.STW_UDFDATE09=src.STW_UDFDATE09, 
                    target.STW_UDFDATE10=src.STW_UDFDATE10, 
                    target.STW_UDFNOTE01=src.STW_UDFNOTE01, 
                    target.STW_UDFNOTE02=src.STW_UDFNOTE02, 
                    target.STW_UDFNUM01=src.STW_UDFNUM01, 
                    target.STW_UDFNUM02=src.STW_UDFNUM02, 
                    target.STW_UDFNUM03=src.STW_UDFNUM03, 
                    target.STW_UDFNUM04=src.STW_UDFNUM04, 
                    target.STW_UDFNUM05=src.STW_UDFNUM05, 
                    target.STW_UDFNUM06=src.STW_UDFNUM06, 
                    target.STW_UDFNUM07=src.STW_UDFNUM07, 
                    target.STW_UDFNUM08=src.STW_UDFNUM08, 
                    target.STW_UDFNUM09=src.STW_UDFNUM09, 
                    target.STW_UDFNUM10=src.STW_UDFNUM10, 
                    target.STW_UPDATECOUNT=src.STW_UPDATECOUNT, 
                    target.STW_UPDATED=src.STW_UPDATED, 
                    target.STW_UPDATEDBY=src.STW_UPDATEDBY, 
                    target.STW_WOCLASS=src.STW_WOCLASS, 
                    target.STW_WOCLASS_ORG=src.STW_WOCLASS_ORG, 
                    target._DELETED=src._DELETED, 
                    target.ETL_LASTSAVED=src.ETL_LASTSAVED,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename,
                    target.ETL_DELETED=src.ETL_DELETED
        when not matched   then insert ( STW_CLASS, STW_CLASS_ORG, STW_CODE, STW_CREATED, STW_CREATEDBY, STW_DESC, STW_DURATION, STW_JOBTYPE, STW_LASTSAVED, STW_NOTUSED, STW_OBCLASS, STW_OBCLASS_ORG, STW_OBJECT, STW_OBJECT_ORG, STW_OBRTYPE, STW_OBTYPE, STW_ORG, STW_PERMITREVIEWED, STW_PERMITREVIEWEDBY, STW_PERMITREVIEWEDNAME, STW_PERMITREVIEWEDTYPE, STW_PERMITREVIEWREQUIRED, STW_PRIORITY, STW_REQM, STW_SAFETYREVIEWED, STW_SAFETYREVIEWEDBY, STW_SAFETYREVIEWEDNAME, STW_SAFETYREVIEWEDTYPE, STW_SAFETYREVIEWREQUIRED, STW_TYPE, STW_UDFCHAR01, STW_UDFCHAR02, STW_UDFCHAR03, STW_UDFCHAR04, STW_UDFCHAR05, STW_UDFCHAR06, STW_UDFCHAR07, STW_UDFCHAR08, STW_UDFCHAR09, STW_UDFCHAR10, STW_UDFCHAR11, STW_UDFCHAR12, STW_UDFCHAR13, STW_UDFCHAR14, STW_UDFCHAR15, STW_UDFCHAR16, STW_UDFCHAR17, STW_UDFCHAR18, STW_UDFCHAR19, STW_UDFCHAR20, STW_UDFCHAR21, STW_UDFCHAR22, STW_UDFCHAR23, STW_UDFCHAR24, STW_UDFCHAR25, STW_UDFCHAR26, STW_UDFCHAR27, STW_UDFCHAR28, STW_UDFCHAR29, STW_UDFCHAR30, STW_UDFCHAR31, STW_UDFCHAR32, STW_UDFCHAR33, STW_UDFCHAR34, STW_UDFCHAR35, STW_UDFCHAR36, STW_UDFCHAR37, STW_UDFCHAR38, STW_UDFCHAR39, STW_UDFCHAR40, STW_UDFCHAR41, STW_UDFCHAR42, STW_UDFCHAR43, STW_UDFCHAR44, STW_UDFCHAR45, STW_UDFCHAR46, STW_UDFCHAR47, STW_UDFCHAR48, STW_UDFCHAR49, STW_UDFCHAR50, STW_UDFCHAR51, STW_UDFCHAR52, STW_UDFCHAR53, STW_UDFCHAR54, STW_UDFCHAR55, STW_UDFCHKBOX01, STW_UDFCHKBOX02, STW_UDFCHKBOX03, STW_UDFCHKBOX04, STW_UDFCHKBOX05, STW_UDFCHKBOX06, STW_UDFCHKBOX07, STW_UDFCHKBOX08, STW_UDFCHKBOX09, STW_UDFCHKBOX10, STW_UDFDATE01, STW_UDFDATE02, STW_UDFDATE03, STW_UDFDATE04, STW_UDFDATE05, STW_UDFDATE06, STW_UDFDATE07, STW_UDFDATE08, STW_UDFDATE09, STW_UDFDATE10, STW_UDFNOTE01, STW_UDFNOTE02, STW_UDFNUM01, STW_UDFNUM02, STW_UDFNUM03, STW_UDFNUM04, STW_UDFNUM05, STW_UDFNUM06, STW_UDFNUM07, STW_UDFNUM08, STW_UDFNUM09, STW_UDFNUM10, STW_UPDATECOUNT, STW_UPDATED, STW_UPDATEDBY, STW_WOCLASS, STW_WOCLASS_ORG, _DELETED, 
                    ETL_LASTSAVED,                       
                    etl_load_datetime,
                    etl_load_metadatafilename,
                    etl_is_deleted,
                    ETL_DELETED) 
            values (
                    src.STW_CLASS, 
                    src.STW_CLASS_ORG, 
                    src.STW_CODE, 
                    src.STW_CREATED, 
                    src.STW_CREATEDBY, 
                    src.STW_DESC, 
                    src.STW_DURATION, 
                    src.STW_JOBTYPE, 
                    src.STW_LASTSAVED, 
                    src.STW_NOTUSED, 
                    src.STW_OBCLASS, 
                    src.STW_OBCLASS_ORG, 
                    src.STW_OBJECT, 
                    src.STW_OBJECT_ORG, 
                    src.STW_OBRTYPE, 
                    src.STW_OBTYPE, 
                    src.STW_ORG, 
                    src.STW_PERMITREVIEWED, 
                    src.STW_PERMITREVIEWEDBY, 
                    src.STW_PERMITREVIEWEDNAME, 
                    src.STW_PERMITREVIEWEDTYPE, 
                    src.STW_PERMITREVIEWREQUIRED, 
                    src.STW_PRIORITY, 
                    src.STW_REQM, 
                    src.STW_SAFETYREVIEWED, 
                    src.STW_SAFETYREVIEWEDBY, 
                    src.STW_SAFETYREVIEWEDNAME, 
                    src.STW_SAFETYREVIEWEDTYPE, 
                    src.STW_SAFETYREVIEWREQUIRED, 
                    src.STW_TYPE, 
                    src.STW_UDFCHAR01, 
                    src.STW_UDFCHAR02, 
                    src.STW_UDFCHAR03, 
                    src.STW_UDFCHAR04, 
                    src.STW_UDFCHAR05, 
                    src.STW_UDFCHAR06, 
                    src.STW_UDFCHAR07, 
                    src.STW_UDFCHAR08, 
                    src.STW_UDFCHAR09, 
                    src.STW_UDFCHAR10, 
                    src.STW_UDFCHAR11, 
                    src.STW_UDFCHAR12, 
                    src.STW_UDFCHAR13, 
                    src.STW_UDFCHAR14, 
                    src.STW_UDFCHAR15, 
                    src.STW_UDFCHAR16, 
                    src.STW_UDFCHAR17, 
                    src.STW_UDFCHAR18, 
                    src.STW_UDFCHAR19, 
                    src.STW_UDFCHAR20, 
                    src.STW_UDFCHAR21, 
                    src.STW_UDFCHAR22, 
                    src.STW_UDFCHAR23, 
                    src.STW_UDFCHAR24, 
                    src.STW_UDFCHAR25, 
                    src.STW_UDFCHAR26, 
                    src.STW_UDFCHAR27, 
                    src.STW_UDFCHAR28, 
                    src.STW_UDFCHAR29, 
                    src.STW_UDFCHAR30, 
                    src.STW_UDFCHAR31, 
                    src.STW_UDFCHAR32, 
                    src.STW_UDFCHAR33, 
                    src.STW_UDFCHAR34, 
                    src.STW_UDFCHAR35, 
                    src.STW_UDFCHAR36, 
                    src.STW_UDFCHAR37, 
                    src.STW_UDFCHAR38, 
                    src.STW_UDFCHAR39, 
                    src.STW_UDFCHAR40, 
                    src.STW_UDFCHAR41, 
                    src.STW_UDFCHAR42, 
                    src.STW_UDFCHAR43, 
                    src.STW_UDFCHAR44, 
                    src.STW_UDFCHAR45, 
                    src.STW_UDFCHAR46, 
                    src.STW_UDFCHAR47, 
                    src.STW_UDFCHAR48, 
                    src.STW_UDFCHAR49, 
                    src.STW_UDFCHAR50, 
                    src.STW_UDFCHAR51, 
                    src.STW_UDFCHAR52, 
                    src.STW_UDFCHAR53, 
                    src.STW_UDFCHAR54, 
                    src.STW_UDFCHAR55, 
                    src.STW_UDFCHKBOX01, 
                    src.STW_UDFCHKBOX02, 
                    src.STW_UDFCHKBOX03, 
                    src.STW_UDFCHKBOX04, 
                    src.STW_UDFCHKBOX05, 
                    src.STW_UDFCHKBOX06, 
                    src.STW_UDFCHKBOX07, 
                    src.STW_UDFCHKBOX08, 
                    src.STW_UDFCHKBOX09, 
                    src.STW_UDFCHKBOX10, 
                    src.STW_UDFDATE01, 
                    src.STW_UDFDATE02, 
                    src.STW_UDFDATE03, 
                    src.STW_UDFDATE04, 
                    src.STW_UDFDATE05, 
                    src.STW_UDFDATE06, 
                    src.STW_UDFDATE07, 
                    src.STW_UDFDATE08, 
                    src.STW_UDFDATE09, 
                    src.STW_UDFDATE10, 
                    src.STW_UDFNOTE01, 
                    src.STW_UDFNOTE02, 
                    src.STW_UDFNUM01, 
                    src.STW_UDFNUM02, 
                    src.STW_UDFNUM03, 
                    src.STW_UDFNUM04, 
                    src.STW_UDFNUM05, 
                    src.STW_UDFNUM06, 
                    src.STW_UDFNUM07, 
                    src.STW_UDFNUM08, 
                    src.STW_UDFNUM09, 
                    src.STW_UDFNUM10, 
                    src.STW_UPDATECOUNT, 
                    src.STW_UPDATED, 
                    src.STW_UPDATEDBY, 
                    src.STW_WOCLASS, 
                    src.STW_WOCLASS_ORG, 
                    src._DELETED,     
                    src.ETL_LASTSAVED,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename,
                    case when ETL_DELETED=TRUE then TRUE else FALSE end,
                    ETL_DELETED);
    `
} );

                    
//  Get number of rows inserted
        
        var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
        var rs = sqlStmt.execute();
        var number_of_rows_inserted = sqlStmt.getNumRowsInserted();
        var number_of_rows_updated =  sqlStmt.getNumRowsUpdated();
                    

        
    snowflake.execute ({sqlText: "commit"});

    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Success','Completed process execution.', 0 ," + number_of_rows_inserted.toString()+ "," +  number_of_rows_updated.toString() + ");";
    snowflake.execute({sqlText: log_sql_command});

    result = "Success"; 

    }       

    catch (err)  {
        snowflake.execute( {sqlText: "rollback;"} )
        var clean_error_msg = err.message.replace(/[^\w\s]/gi, '');
    //  Create a log entry to say INSERT STATEMENT failed
    
    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Failed','MERGE Failed. Error:" + err.code.toString()+" : "+ clean_error_msg  + "', 0 ,0,0);";
    snowflake.execute({sqlText: log_sql_command});
        ;
        throw "Failed: " + err.message;   // Return a success/error indicator.
        }
    return result;
    $$;