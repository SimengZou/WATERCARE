create or replace procedure DATAHUB_INTEGRATION.SP_LN_WHWMD200()
    returns varchar not null
                language javascript
                as
                $$

//  Variables

var result = "";                                    // return status of this proc call
const process_name = Object.keys(this)[0];          // name of currently executing process
var number_of_rows_inserted = 0;                             // track number of rows we have inserted
var number_of_rows_updated = 0;                             // track number of rows we have updated


//  Step 1.

//  Start execution - log start

log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('Insert','" + process_name + "','Running','Started process execution.', 0,0,0);";
snowflake.execute({sqlText: log_sql_command});

snowflake.execute( {sqlText: "begin transaction;"} );
try
    {
        var sql_command = `
                            INSERT INTO LANDING_ERROR.LN_RAW_ERROR
                            SELECT * FROM LANDING_ERROR.VW_STREAM_LN_WHWMD200_ERROR`;
    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();
        
        var sql_command = ` 
                            merge into  TARGET_LN.LN_WHWMD200 as target using (SELECT * FROM (SELECT 
            strm.aipd, 
            strm.aipd_kw, 
            strm.aoit, 
            strm.aoit_kw, 
            strm.arlo, 
            strm.bcyc, 
            strm.bcyc_kw, 
            strm.binb, 
            strm.binb_kw, 
            strm.bloc, 
            strm.bloc_ref_compnr, 
            strm.bout, 
            strm.bout_kw, 
            strm.ccal, 
            strm.ccal_ref_compnr, 
            strm.cdap, 
            strm.cdap_kw, 
            strm.cdcr, 
            strm.cdcr_kw, 
            strm.cdlt, 
            strm.cdlu, 
            strm.cdlu_kw, 
            strm.cdoa, 
            strm.cdoa_kw, 
            strm.cdpd, 
            strm.cdpd_ref_compnr, 
            strm.cdrd, 
            strm.cdrd_ref_compnr, 
            strm.cdro, 
            strm.cdro_kw, 
            strm.coka, 
            strm.compnr, 
            strm.cons, 
            strm.cons_kw, 
            strm.copa, 
            strm.copc, 
            strm.copp, 
            strm.copr, 
            strm.copu, 
            strm.cwar, 
            strm.cwar_arlo_ref_compnr, 
            strm.cwar_palo_ref_compnr, 
            strm.cwar_ref_compnr, 
            strm.cwar_relo_ref_compnr, 
            strm.cwar_stlo_ref_compnr, 
            strm.ddti, 
            strm.ddti_kw, 
            strm.ddwi, 
            strm.ddwi_kw, 
            strm.ddwr, 
            strm.ddwr_kw, 
            strm.deleted, 
            strm.diws, 
            strm.diws_kw, 
            strm.dmdt, 
            strm.dmdt_kw, 
            strm.dmph, 
            strm.dmsi, 
            strm.dmsi_kw, 
            strm.dmsl, 
            strm.dmsl_ref_compnr, 
            strm.dmsp, 
            strm.dmsp_kw, 
            strm.dmsr, 
            strm.dmsr_kw, 
            strm.dmss, 
            strm.dmss_kw, 
            strm.dphi, 
            strm.dprl, 
            strm.dprl_kw, 
            strm.dptr, 
            strm.dptr_kw, 
            strm.dycd, 
            strm.dycd_kw, 
            strm.fire, 
            strm.fire_kw, 
            strm.flhu, 
            strm.flhu_kw, 
            strm.flup, 
            strm.flup_kw, 
            strm.free, 
            strm.frlo, 
            strm.frlo_kw, 
            strm.geha, 
            strm.geha_kw, 
            strm.gehc, 
            strm.gehc_kw, 
            strm.gehp, 
            strm.gehp_kw, 
            strm.gehr, 
            strm.gehr_kw, 
            strm.gehu, 
            strm.gehu_kw, 
            strm.ghps, 
            strm.ghps_kw, 
            strm.gnsh, 
            strm.gnsh_kw, 
            strm.ialt, 
            strm.ialt_kw, 
            strm.ieod, 
            strm.ieod_kw, 
            strm.ilmc, 
            strm.ilmc_ref_compnr, 
            strm.iltm, 
            strm.iltu, 
            strm.iltu_kw, 
            strm.imdp, 
            strm.imdp_ref_compnr, 
            strm.itlo, 
            strm.itlo_kw, 
            strm.karu, 
            strm.karu_ref_compnr, 
            strm.kdev, 
            strm.kmsk, 
            strm.kmsk_ref_compnr, 
            strm.laba, 
            strm.laba_ref_compnr, 
            strm.labc, 
            strm.labc_ref_compnr, 
            strm.labi, 
            strm.labi_ref_compnr, 
            strm.labo, 
            strm.labo_ref_compnr, 
            strm.labr, 
            strm.labr_ref_compnr, 
            strm.lolo, 
            strm.lolo_kw, 
            strm.lpad, 
            strm.lpad_kw, 
            strm.lpas, 
            strm.lpas_kw, 
            strm.lpcc, 
            strm.lpcc_kw, 
            strm.lppi, 
            strm.lppi_kw, 
            strm.lpre, 
            strm.lpre_kw, 
            strm.mada, 
            strm.mada_kw, 
            strm.masi, 
            strm.masu, 
            strm.masu_kw, 
            strm.matt, 
            strm.matu, 
            strm.matu_kw, 
            strm.mcca, 
            strm.mcca_kw, 
            strm.mipa, 
            strm.mipa_kw, 
            strm.misi, 
            strm.misu, 
            strm.misu_kw, 
            strm.mitt, 
            strm.mitu, 
            strm.mitu_kw, 
            strm.mopa, 
            strm.mopa_kw, 
            strm.mrhu, 
            strm.mrhu_kw, 
            strm.olmc, 
            strm.olmc_ref_compnr, 
            strm.oltm, 
            strm.oltu, 
            strm.oltu_kw, 
            strm.orbo, 
            strm.orbo_kw, 
            strm.palo, 
            strm.prla, 
            strm.prla_kw, 
            strm.prlc, 
            strm.prlc_kw, 
            strm.prlp, 
            strm.prlp_kw, 
            strm.prlr, 
            strm.prlr_kw, 
            strm.prlu, 
            strm.prlu_kw, 
            strm.prmp, 
            strm.prmp_kw, 
            strm.prmr, 
            strm.prmr_kw, 
            strm.prmu, 
            strm.prmu_kw, 
            strm.prva, 
            strm.prva_kw, 
            strm.qfma, 
            strm.qfmi, 
            strm.qmoo, 
            strm.qmoo_kw, 
            strm.qwrh, 
            strm.qwrh_ref_compnr, 
            strm.ract, 
            strm.ract_ref_compnr, 
            strm.reje, 
            strm.reje_kw, 
            strm.relo, 
            strm.rfsa, 
            strm.rfsa_kw, 
            strm.rilt, 
            strm.rilu, 
            strm.rilu_kw, 
            strm.rkbs, 
            strm.rkbs_kw, 
            strm.rolt, 
            strm.rolu, 
            strm.rolu_kw, 
            strm.rsdn, 
            strm.rsdn_kw, 
            strm.rsrc, 
            strm.rsrc_kw, 
            strm.rtcf, 
            strm.rtcf_kw, 
            strm.scom, 
            strm.sequencenumber, 
            strm.sfwh, 
            strm.sfwh_kw, 
            strm.shhu, 
            strm.shhu_kw, 
            strm.shtw, 
            strm.shtw_ref_compnr, 
            strm.site, 
            strm.site_ref_compnr, 
            strm.sloc, 
            strm.sloc_kw, 
            strm.smsh, 
            strm.smsh_kw, 
            strm.spps, 
            strm.spps_kw, 
            strm.sscc, 
            strm.sscc_kw, 
            strm.stlo, 
            strm.sups, 
            strm.sups_kw, 
            strm.supw, 
            strm.supw_ref_compnr, 
            strm.timestamp, 
            strm.trdc, 
            strm.trdc_kw, 
            strm.ufpl, 
            strm.ufpl_kw, 
            strm.uhii, 
            strm.uhii_kw, 
            strm.uhin, 
            strm.uhin_kw, 
            strm.uhir, 
            strm.uhir_kw, 
            strm.uhis, 
            strm.uhis_kw, 
            strm.uhnd, 
            strm.uhnd_kw, 
            strm.uhoa, 
            strm.uhoa_kw, 
            strm.uhri, 
            strm.uhri_kw, 
            strm.uidt, 
            strm.uidt_kw, 
            strm.uolo, 
            strm.uolo_kw, 
            strm.username, 
            strm.usmd, 
            strm.usmd_kw, 
            strm.usse, 
            strm.usse_kw, 
            strm.uudl, 
            strm.uudl_kw, 
            strm.uwtr, 
            strm.uwtr_kw, 
            strm.vpad, 
            strm.vpad_kw, 
            strm.vpcc, 
            strm.vpcc_kw, 
            strm.wvgr, 
            strm.wvgr_ref_compnr, 
            strm.zere, 
            strm.zere_kw, 
            strm.ETL_SEQUENCE_NUMBER,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.compnr,
            strm.cwar ORDER BY strm.ETL_SEQUENCE_NUMBER desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_LN_WHWMD200 as  strm
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.compnr=src.compnr) OR (target.compnr IS NULL AND src.compnr IS NULL)) AND
            ((target.cwar=src.cwar) OR (target.cwar IS NULL AND src.cwar IS NULL)) 
                when matched and src.ETL_DELETED=TRUE THEN DELETE
                when matched then update set
                    target.aipd=src.aipd, 
                    target.aipd_kw=src.aipd_kw, 
                    target.aoit=src.aoit, 
                    target.aoit_kw=src.aoit_kw, 
                    target.arlo=src.arlo, 
                    target.bcyc=src.bcyc, 
                    target.bcyc_kw=src.bcyc_kw, 
                    target.binb=src.binb, 
                    target.binb_kw=src.binb_kw, 
                    target.bloc=src.bloc, 
                    target.bloc_ref_compnr=src.bloc_ref_compnr, 
                    target.bout=src.bout, 
                    target.bout_kw=src.bout_kw, 
                    target.ccal=src.ccal, 
                    target.ccal_ref_compnr=src.ccal_ref_compnr, 
                    target.cdap=src.cdap, 
                    target.cdap_kw=src.cdap_kw, 
                    target.cdcr=src.cdcr, 
                    target.cdcr_kw=src.cdcr_kw, 
                    target.cdlt=src.cdlt, 
                    target.cdlu=src.cdlu, 
                    target.cdlu_kw=src.cdlu_kw, 
                    target.cdoa=src.cdoa, 
                    target.cdoa_kw=src.cdoa_kw, 
                    target.cdpd=src.cdpd, 
                    target.cdpd_ref_compnr=src.cdpd_ref_compnr, 
                    target.cdrd=src.cdrd, 
                    target.cdrd_ref_compnr=src.cdrd_ref_compnr, 
                    target.cdro=src.cdro, 
                    target.cdro_kw=src.cdro_kw, 
                    target.coka=src.coka, 
                    target.compnr=src.compnr, 
                    target.cons=src.cons, 
                    target.cons_kw=src.cons_kw, 
                    target.copa=src.copa, 
                    target.copc=src.copc, 
                    target.copp=src.copp, 
                    target.copr=src.copr, 
                    target.copu=src.copu, 
                    target.cwar=src.cwar, 
                    target.cwar_arlo_ref_compnr=src.cwar_arlo_ref_compnr, 
                    target.cwar_palo_ref_compnr=src.cwar_palo_ref_compnr, 
                    target.cwar_ref_compnr=src.cwar_ref_compnr, 
                    target.cwar_relo_ref_compnr=src.cwar_relo_ref_compnr, 
                    target.cwar_stlo_ref_compnr=src.cwar_stlo_ref_compnr, 
                    target.ddti=src.ddti, 
                    target.ddti_kw=src.ddti_kw, 
                    target.ddwi=src.ddwi, 
                    target.ddwi_kw=src.ddwi_kw, 
                    target.ddwr=src.ddwr, 
                    target.ddwr_kw=src.ddwr_kw, 
                    target.deleted=src.deleted, 
                    target.diws=src.diws, 
                    target.diws_kw=src.diws_kw, 
                    target.dmdt=src.dmdt, 
                    target.dmdt_kw=src.dmdt_kw, 
                    target.dmph=src.dmph, 
                    target.dmsi=src.dmsi, 
                    target.dmsi_kw=src.dmsi_kw, 
                    target.dmsl=src.dmsl, 
                    target.dmsl_ref_compnr=src.dmsl_ref_compnr, 
                    target.dmsp=src.dmsp, 
                    target.dmsp_kw=src.dmsp_kw, 
                    target.dmsr=src.dmsr, 
                    target.dmsr_kw=src.dmsr_kw, 
                    target.dmss=src.dmss, 
                    target.dmss_kw=src.dmss_kw, 
                    target.dphi=src.dphi, 
                    target.dprl=src.dprl, 
                    target.dprl_kw=src.dprl_kw, 
                    target.dptr=src.dptr, 
                    target.dptr_kw=src.dptr_kw, 
                    target.dycd=src.dycd, 
                    target.dycd_kw=src.dycd_kw, 
                    target.fire=src.fire, 
                    target.fire_kw=src.fire_kw, 
                    target.flhu=src.flhu, 
                    target.flhu_kw=src.flhu_kw, 
                    target.flup=src.flup, 
                    target.flup_kw=src.flup_kw, 
                    target.free=src.free, 
                    target.frlo=src.frlo, 
                    target.frlo_kw=src.frlo_kw, 
                    target.geha=src.geha, 
                    target.geha_kw=src.geha_kw, 
                    target.gehc=src.gehc, 
                    target.gehc_kw=src.gehc_kw, 
                    target.gehp=src.gehp, 
                    target.gehp_kw=src.gehp_kw, 
                    target.gehr=src.gehr, 
                    target.gehr_kw=src.gehr_kw, 
                    target.gehu=src.gehu, 
                    target.gehu_kw=src.gehu_kw, 
                    target.ghps=src.ghps, 
                    target.ghps_kw=src.ghps_kw, 
                    target.gnsh=src.gnsh, 
                    target.gnsh_kw=src.gnsh_kw, 
                    target.ialt=src.ialt, 
                    target.ialt_kw=src.ialt_kw, 
                    target.ieod=src.ieod, 
                    target.ieod_kw=src.ieod_kw, 
                    target.ilmc=src.ilmc, 
                    target.ilmc_ref_compnr=src.ilmc_ref_compnr, 
                    target.iltm=src.iltm, 
                    target.iltu=src.iltu, 
                    target.iltu_kw=src.iltu_kw, 
                    target.imdp=src.imdp, 
                    target.imdp_ref_compnr=src.imdp_ref_compnr, 
                    target.itlo=src.itlo, 
                    target.itlo_kw=src.itlo_kw, 
                    target.karu=src.karu, 
                    target.karu_ref_compnr=src.karu_ref_compnr, 
                    target.kdev=src.kdev, 
                    target.kmsk=src.kmsk, 
                    target.kmsk_ref_compnr=src.kmsk_ref_compnr, 
                    target.laba=src.laba, 
                    target.laba_ref_compnr=src.laba_ref_compnr, 
                    target.labc=src.labc, 
                    target.labc_ref_compnr=src.labc_ref_compnr, 
                    target.labi=src.labi, 
                    target.labi_ref_compnr=src.labi_ref_compnr, 
                    target.labo=src.labo, 
                    target.labo_ref_compnr=src.labo_ref_compnr, 
                    target.labr=src.labr, 
                    target.labr_ref_compnr=src.labr_ref_compnr, 
                    target.lolo=src.lolo, 
                    target.lolo_kw=src.lolo_kw, 
                    target.lpad=src.lpad, 
                    target.lpad_kw=src.lpad_kw, 
                    target.lpas=src.lpas, 
                    target.lpas_kw=src.lpas_kw, 
                    target.lpcc=src.lpcc, 
                    target.lpcc_kw=src.lpcc_kw, 
                    target.lppi=src.lppi, 
                    target.lppi_kw=src.lppi_kw, 
                    target.lpre=src.lpre, 
                    target.lpre_kw=src.lpre_kw, 
                    target.mada=src.mada, 
                    target.mada_kw=src.mada_kw, 
                    target.masi=src.masi, 
                    target.masu=src.masu, 
                    target.masu_kw=src.masu_kw, 
                    target.matt=src.matt, 
                    target.matu=src.matu, 
                    target.matu_kw=src.matu_kw, 
                    target.mcca=src.mcca, 
                    target.mcca_kw=src.mcca_kw, 
                    target.mipa=src.mipa, 
                    target.mipa_kw=src.mipa_kw, 
                    target.misi=src.misi, 
                    target.misu=src.misu, 
                    target.misu_kw=src.misu_kw, 
                    target.mitt=src.mitt, 
                    target.mitu=src.mitu, 
                    target.mitu_kw=src.mitu_kw, 
                    target.mopa=src.mopa, 
                    target.mopa_kw=src.mopa_kw, 
                    target.mrhu=src.mrhu, 
                    target.mrhu_kw=src.mrhu_kw, 
                    target.olmc=src.olmc, 
                    target.olmc_ref_compnr=src.olmc_ref_compnr, 
                    target.oltm=src.oltm, 
                    target.oltu=src.oltu, 
                    target.oltu_kw=src.oltu_kw, 
                    target.orbo=src.orbo, 
                    target.orbo_kw=src.orbo_kw, 
                    target.palo=src.palo, 
                    target.prla=src.prla, 
                    target.prla_kw=src.prla_kw, 
                    target.prlc=src.prlc, 
                    target.prlc_kw=src.prlc_kw, 
                    target.prlp=src.prlp, 
                    target.prlp_kw=src.prlp_kw, 
                    target.prlr=src.prlr, 
                    target.prlr_kw=src.prlr_kw, 
                    target.prlu=src.prlu, 
                    target.prlu_kw=src.prlu_kw, 
                    target.prmp=src.prmp, 
                    target.prmp_kw=src.prmp_kw, 
                    target.prmr=src.prmr, 
                    target.prmr_kw=src.prmr_kw, 
                    target.prmu=src.prmu, 
                    target.prmu_kw=src.prmu_kw, 
                    target.prva=src.prva, 
                    target.prva_kw=src.prva_kw, 
                    target.qfma=src.qfma, 
                    target.qfmi=src.qfmi, 
                    target.qmoo=src.qmoo, 
                    target.qmoo_kw=src.qmoo_kw, 
                    target.qwrh=src.qwrh, 
                    target.qwrh_ref_compnr=src.qwrh_ref_compnr, 
                    target.ract=src.ract, 
                    target.ract_ref_compnr=src.ract_ref_compnr, 
                    target.reje=src.reje, 
                    target.reje_kw=src.reje_kw, 
                    target.relo=src.relo, 
                    target.rfsa=src.rfsa, 
                    target.rfsa_kw=src.rfsa_kw, 
                    target.rilt=src.rilt, 
                    target.rilu=src.rilu, 
                    target.rilu_kw=src.rilu_kw, 
                    target.rkbs=src.rkbs, 
                    target.rkbs_kw=src.rkbs_kw, 
                    target.rolt=src.rolt, 
                    target.rolu=src.rolu, 
                    target.rolu_kw=src.rolu_kw, 
                    target.rsdn=src.rsdn, 
                    target.rsdn_kw=src.rsdn_kw, 
                    target.rsrc=src.rsrc, 
                    target.rsrc_kw=src.rsrc_kw, 
                    target.rtcf=src.rtcf, 
                    target.rtcf_kw=src.rtcf_kw, 
                    target.scom=src.scom, 
                    target.sequencenumber=src.sequencenumber, 
                    target.sfwh=src.sfwh, 
                    target.sfwh_kw=src.sfwh_kw, 
                    target.shhu=src.shhu, 
                    target.shhu_kw=src.shhu_kw, 
                    target.shtw=src.shtw, 
                    target.shtw_ref_compnr=src.shtw_ref_compnr, 
                    target.site=src.site, 
                    target.site_ref_compnr=src.site_ref_compnr, 
                    target.sloc=src.sloc, 
                    target.sloc_kw=src.sloc_kw, 
                    target.smsh=src.smsh, 
                    target.smsh_kw=src.smsh_kw, 
                    target.spps=src.spps, 
                    target.spps_kw=src.spps_kw, 
                    target.sscc=src.sscc, 
                    target.sscc_kw=src.sscc_kw, 
                    target.stlo=src.stlo, 
                    target.sups=src.sups, 
                    target.sups_kw=src.sups_kw, 
                    target.supw=src.supw, 
                    target.supw_ref_compnr=src.supw_ref_compnr, 
                    target.timestamp=src.timestamp, 
                    target.trdc=src.trdc, 
                    target.trdc_kw=src.trdc_kw, 
                    target.ufpl=src.ufpl, 
                    target.ufpl_kw=src.ufpl_kw, 
                    target.uhii=src.uhii, 
                    target.uhii_kw=src.uhii_kw, 
                    target.uhin=src.uhin, 
                    target.uhin_kw=src.uhin_kw, 
                    target.uhir=src.uhir, 
                    target.uhir_kw=src.uhir_kw, 
                    target.uhis=src.uhis, 
                    target.uhis_kw=src.uhis_kw, 
                    target.uhnd=src.uhnd, 
                    target.uhnd_kw=src.uhnd_kw, 
                    target.uhoa=src.uhoa, 
                    target.uhoa_kw=src.uhoa_kw, 
                    target.uhri=src.uhri, 
                    target.uhri_kw=src.uhri_kw, 
                    target.uidt=src.uidt, 
                    target.uidt_kw=src.uidt_kw, 
                    target.uolo=src.uolo, 
                    target.uolo_kw=src.uolo_kw, 
                    target.username=src.username, 
                    target.usmd=src.usmd, 
                    target.usmd_kw=src.usmd_kw, 
                    target.usse=src.usse, 
                    target.usse_kw=src.usse_kw, 
                    target.uudl=src.uudl, 
                    target.uudl_kw=src.uudl_kw, 
                    target.uwtr=src.uwtr, 
                    target.uwtr_kw=src.uwtr_kw, 
                    target.vpad=src.vpad, 
                    target.vpad_kw=src.vpad_kw, 
                    target.vpcc=src.vpcc, 
                    target.vpcc_kw=src.vpcc_kw, 
                    target.wvgr=src.wvgr, 
                    target.wvgr_ref_compnr=src.wvgr_ref_compnr, 
                    target.zere=src.zere, 
                    target.zere_kw=src.zere_kw, 
                    target.ETL_SEQUENCE_NUMBER=src.ETL_SEQUENCE_NUMBER,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename
        when not matched and (src.ETL_DELETED=FALSE OR src.ETL_DELETED IS NULL)  then insert ( 
                    aipd, 
                    aipd_kw, 
                    aoit, 
                    aoit_kw, 
                    arlo, 
                    bcyc, 
                    bcyc_kw, 
                    binb, 
                    binb_kw, 
                    bloc, 
                    bloc_ref_compnr, 
                    bout, 
                    bout_kw, 
                    ccal, 
                    ccal_ref_compnr, 
                    cdap, 
                    cdap_kw, 
                    cdcr, 
                    cdcr_kw, 
                    cdlt, 
                    cdlu, 
                    cdlu_kw, 
                    cdoa, 
                    cdoa_kw, 
                    cdpd, 
                    cdpd_ref_compnr, 
                    cdrd, 
                    cdrd_ref_compnr, 
                    cdro, 
                    cdro_kw, 
                    coka, 
                    compnr, 
                    cons, 
                    cons_kw, 
                    copa, 
                    copc, 
                    copp, 
                    copr, 
                    copu, 
                    cwar, 
                    cwar_arlo_ref_compnr, 
                    cwar_palo_ref_compnr, 
                    cwar_ref_compnr, 
                    cwar_relo_ref_compnr, 
                    cwar_stlo_ref_compnr, 
                    ddti, 
                    ddti_kw, 
                    ddwi, 
                    ddwi_kw, 
                    ddwr, 
                    ddwr_kw, 
                    deleted, 
                    diws, 
                    diws_kw, 
                    dmdt, 
                    dmdt_kw, 
                    dmph, 
                    dmsi, 
                    dmsi_kw, 
                    dmsl, 
                    dmsl_ref_compnr, 
                    dmsp, 
                    dmsp_kw, 
                    dmsr, 
                    dmsr_kw, 
                    dmss, 
                    dmss_kw, 
                    dphi, 
                    dprl, 
                    dprl_kw, 
                    dptr, 
                    dptr_kw, 
                    dycd, 
                    dycd_kw, 
                    fire, 
                    fire_kw, 
                    flhu, 
                    flhu_kw, 
                    flup, 
                    flup_kw, 
                    free, 
                    frlo, 
                    frlo_kw, 
                    geha, 
                    geha_kw, 
                    gehc, 
                    gehc_kw, 
                    gehp, 
                    gehp_kw, 
                    gehr, 
                    gehr_kw, 
                    gehu, 
                    gehu_kw, 
                    ghps, 
                    ghps_kw, 
                    gnsh, 
                    gnsh_kw, 
                    ialt, 
                    ialt_kw, 
                    ieod, 
                    ieod_kw, 
                    ilmc, 
                    ilmc_ref_compnr, 
                    iltm, 
                    iltu, 
                    iltu_kw, 
                    imdp, 
                    imdp_ref_compnr, 
                    itlo, 
                    itlo_kw, 
                    karu, 
                    karu_ref_compnr, 
                    kdev, 
                    kmsk, 
                    kmsk_ref_compnr, 
                    laba, 
                    laba_ref_compnr, 
                    labc, 
                    labc_ref_compnr, 
                    labi, 
                    labi_ref_compnr, 
                    labo, 
                    labo_ref_compnr, 
                    labr, 
                    labr_ref_compnr, 
                    lolo, 
                    lolo_kw, 
                    lpad, 
                    lpad_kw, 
                    lpas, 
                    lpas_kw, 
                    lpcc, 
                    lpcc_kw, 
                    lppi, 
                    lppi_kw, 
                    lpre, 
                    lpre_kw, 
                    mada, 
                    mada_kw, 
                    masi, 
                    masu, 
                    masu_kw, 
                    matt, 
                    matu, 
                    matu_kw, 
                    mcca, 
                    mcca_kw, 
                    mipa, 
                    mipa_kw, 
                    misi, 
                    misu, 
                    misu_kw, 
                    mitt, 
                    mitu, 
                    mitu_kw, 
                    mopa, 
                    mopa_kw, 
                    mrhu, 
                    mrhu_kw, 
                    olmc, 
                    olmc_ref_compnr, 
                    oltm, 
                    oltu, 
                    oltu_kw, 
                    orbo, 
                    orbo_kw, 
                    palo, 
                    prla, 
                    prla_kw, 
                    prlc, 
                    prlc_kw, 
                    prlp, 
                    prlp_kw, 
                    prlr, 
                    prlr_kw, 
                    prlu, 
                    prlu_kw, 
                    prmp, 
                    prmp_kw, 
                    prmr, 
                    prmr_kw, 
                    prmu, 
                    prmu_kw, 
                    prva, 
                    prva_kw, 
                    qfma, 
                    qfmi, 
                    qmoo, 
                    qmoo_kw, 
                    qwrh, 
                    qwrh_ref_compnr, 
                    ract, 
                    ract_ref_compnr, 
                    reje, 
                    reje_kw, 
                    relo, 
                    rfsa, 
                    rfsa_kw, 
                    rilt, 
                    rilu, 
                    rilu_kw, 
                    rkbs, 
                    rkbs_kw, 
                    rolt, 
                    rolu, 
                    rolu_kw, 
                    rsdn, 
                    rsdn_kw, 
                    rsrc, 
                    rsrc_kw, 
                    rtcf, 
                    rtcf_kw, 
                    scom, 
                    sequencenumber, 
                    sfwh, 
                    sfwh_kw, 
                    shhu, 
                    shhu_kw, 
                    shtw, 
                    shtw_ref_compnr, 
                    site, 
                    site_ref_compnr, 
                    sloc, 
                    sloc_kw, 
                    smsh, 
                    smsh_kw, 
                    spps, 
                    spps_kw, 
                    sscc, 
                    sscc_kw, 
                    stlo, 
                    sups, 
                    sups_kw, 
                    supw, 
                    supw_ref_compnr, 
                    timestamp, 
                    trdc, 
                    trdc_kw, 
                    ufpl, 
                    ufpl_kw, 
                    uhii, 
                    uhii_kw, 
                    uhin, 
                    uhin_kw, 
                    uhir, 
                    uhir_kw, 
                    uhis, 
                    uhis_kw, 
                    uhnd, 
                    uhnd_kw, 
                    uhoa, 
                    uhoa_kw, 
                    uhri, 
                    uhri_kw, 
                    uidt, 
                    uidt_kw, 
                    uolo, 
                    uolo_kw, 
                    username, 
                    usmd, 
                    usmd_kw, 
                    usse, 
                    usse_kw, 
                    uudl, 
                    uudl_kw, 
                    uwtr, 
                    uwtr_kw, 
                    vpad, 
                    vpad_kw, 
                    vpcc, 
                    vpcc_kw, 
                    wvgr, 
                    wvgr_ref_compnr, 
                    zere, 
                    zere_kw, 
                    ETL_SEQUENCE_NUMBER,                       
                    etl_load_datetime,
                    etl_load_metadatafilename) 
            values (
                    src.aipd, 
                    src.aipd_kw, 
                    src.aoit, 
                    src.aoit_kw, 
                    src.arlo, 
                    src.bcyc, 
                    src.bcyc_kw, 
                    src.binb, 
                    src.binb_kw, 
                    src.bloc, 
                    src.bloc_ref_compnr, 
                    src.bout, 
                    src.bout_kw, 
                    src.ccal, 
                    src.ccal_ref_compnr, 
                    src.cdap, 
                    src.cdap_kw, 
                    src.cdcr, 
                    src.cdcr_kw, 
                    src.cdlt, 
                    src.cdlu, 
                    src.cdlu_kw, 
                    src.cdoa, 
                    src.cdoa_kw, 
                    src.cdpd, 
                    src.cdpd_ref_compnr, 
                    src.cdrd, 
                    src.cdrd_ref_compnr, 
                    src.cdro, 
                    src.cdro_kw, 
                    src.coka, 
                    src.compnr, 
                    src.cons, 
                    src.cons_kw, 
                    src.copa, 
                    src.copc, 
                    src.copp, 
                    src.copr, 
                    src.copu, 
                    src.cwar, 
                    src.cwar_arlo_ref_compnr, 
                    src.cwar_palo_ref_compnr, 
                    src.cwar_ref_compnr, 
                    src.cwar_relo_ref_compnr, 
                    src.cwar_stlo_ref_compnr, 
                    src.ddti, 
                    src.ddti_kw, 
                    src.ddwi, 
                    src.ddwi_kw, 
                    src.ddwr, 
                    src.ddwr_kw, 
                    src.deleted, 
                    src.diws, 
                    src.diws_kw, 
                    src.dmdt, 
                    src.dmdt_kw, 
                    src.dmph, 
                    src.dmsi, 
                    src.dmsi_kw, 
                    src.dmsl, 
                    src.dmsl_ref_compnr, 
                    src.dmsp, 
                    src.dmsp_kw, 
                    src.dmsr, 
                    src.dmsr_kw, 
                    src.dmss, 
                    src.dmss_kw, 
                    src.dphi, 
                    src.dprl, 
                    src.dprl_kw, 
                    src.dptr, 
                    src.dptr_kw, 
                    src.dycd, 
                    src.dycd_kw, 
                    src.fire, 
                    src.fire_kw, 
                    src.flhu, 
                    src.flhu_kw, 
                    src.flup, 
                    src.flup_kw, 
                    src.free, 
                    src.frlo, 
                    src.frlo_kw, 
                    src.geha, 
                    src.geha_kw, 
                    src.gehc, 
                    src.gehc_kw, 
                    src.gehp, 
                    src.gehp_kw, 
                    src.gehr, 
                    src.gehr_kw, 
                    src.gehu, 
                    src.gehu_kw, 
                    src.ghps, 
                    src.ghps_kw, 
                    src.gnsh, 
                    src.gnsh_kw, 
                    src.ialt, 
                    src.ialt_kw, 
                    src.ieod, 
                    src.ieod_kw, 
                    src.ilmc, 
                    src.ilmc_ref_compnr, 
                    src.iltm, 
                    src.iltu, 
                    src.iltu_kw, 
                    src.imdp, 
                    src.imdp_ref_compnr, 
                    src.itlo, 
                    src.itlo_kw, 
                    src.karu, 
                    src.karu_ref_compnr, 
                    src.kdev, 
                    src.kmsk, 
                    src.kmsk_ref_compnr, 
                    src.laba, 
                    src.laba_ref_compnr, 
                    src.labc, 
                    src.labc_ref_compnr, 
                    src.labi, 
                    src.labi_ref_compnr, 
                    src.labo, 
                    src.labo_ref_compnr, 
                    src.labr, 
                    src.labr_ref_compnr, 
                    src.lolo, 
                    src.lolo_kw, 
                    src.lpad, 
                    src.lpad_kw, 
                    src.lpas, 
                    src.lpas_kw, 
                    src.lpcc, 
                    src.lpcc_kw, 
                    src.lppi, 
                    src.lppi_kw, 
                    src.lpre, 
                    src.lpre_kw, 
                    src.mada, 
                    src.mada_kw, 
                    src.masi, 
                    src.masu, 
                    src.masu_kw, 
                    src.matt, 
                    src.matu, 
                    src.matu_kw, 
                    src.mcca, 
                    src.mcca_kw, 
                    src.mipa, 
                    src.mipa_kw, 
                    src.misi, 
                    src.misu, 
                    src.misu_kw, 
                    src.mitt, 
                    src.mitu, 
                    src.mitu_kw, 
                    src.mopa, 
                    src.mopa_kw, 
                    src.mrhu, 
                    src.mrhu_kw, 
                    src.olmc, 
                    src.olmc_ref_compnr, 
                    src.oltm, 
                    src.oltu, 
                    src.oltu_kw, 
                    src.orbo, 
                    src.orbo_kw, 
                    src.palo, 
                    src.prla, 
                    src.prla_kw, 
                    src.prlc, 
                    src.prlc_kw, 
                    src.prlp, 
                    src.prlp_kw, 
                    src.prlr, 
                    src.prlr_kw, 
                    src.prlu, 
                    src.prlu_kw, 
                    src.prmp, 
                    src.prmp_kw, 
                    src.prmr, 
                    src.prmr_kw, 
                    src.prmu, 
                    src.prmu_kw, 
                    src.prva, 
                    src.prva_kw, 
                    src.qfma, 
                    src.qfmi, 
                    src.qmoo, 
                    src.qmoo_kw, 
                    src.qwrh, 
                    src.qwrh_ref_compnr, 
                    src.ract, 
                    src.ract_ref_compnr, 
                    src.reje, 
                    src.reje_kw, 
                    src.relo, 
                    src.rfsa, 
                    src.rfsa_kw, 
                    src.rilt, 
                    src.rilu, 
                    src.rilu_kw, 
                    src.rkbs, 
                    src.rkbs_kw, 
                    src.rolt, 
                    src.rolu, 
                    src.rolu_kw, 
                    src.rsdn, 
                    src.rsdn_kw, 
                    src.rsrc, 
                    src.rsrc_kw, 
                    src.rtcf, 
                    src.rtcf_kw, 
                    src.scom, 
                    src.sequencenumber, 
                    src.sfwh, 
                    src.sfwh_kw, 
                    src.shhu, 
                    src.shhu_kw, 
                    src.shtw, 
                    src.shtw_ref_compnr, 
                    src.site, 
                    src.site_ref_compnr, 
                    src.sloc, 
                    src.sloc_kw, 
                    src.smsh, 
                    src.smsh_kw, 
                    src.spps, 
                    src.spps_kw, 
                    src.sscc, 
                    src.sscc_kw, 
                    src.stlo, 
                    src.sups, 
                    src.sups_kw, 
                    src.supw, 
                    src.supw_ref_compnr, 
                    src.timestamp, 
                    src.trdc, 
                    src.trdc_kw, 
                    src.ufpl, 
                    src.ufpl_kw, 
                    src.uhii, 
                    src.uhii_kw, 
                    src.uhin, 
                    src.uhin_kw, 
                    src.uhir, 
                    src.uhir_kw, 
                    src.uhis, 
                    src.uhis_kw, 
                    src.uhnd, 
                    src.uhnd_kw, 
                    src.uhoa, 
                    src.uhoa_kw, 
                    src.uhri, 
                    src.uhri_kw, 
                    src.uidt, 
                    src.uidt_kw, 
                    src.uolo, 
                    src.uolo_kw, 
                    src.username, 
                    src.usmd, 
                    src.usmd_kw, 
                    src.usse, 
                    src.usse_kw, 
                    src.uudl, 
                    src.uudl_kw, 
                    src.uwtr, 
                    src.uwtr_kw, 
                    src.vpad, 
                    src.vpad_kw, 
                    src.vpcc, 
                    src.vpcc_kw, 
                    src.wvgr, 
                    src.wvgr_ref_compnr, 
                    src.zere, 
                    src.zere_kw,     
                    src.ETL_SEQUENCE_NUMBER,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename);`;

    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();

    snowflake.execute( {sqlText: `merge into TARGET_HISTORY_LN.LN_WHWMD200_DELETED as target using (
                SELECT * FROM (SELECT 
            strm.aipd, 
            strm.aipd_kw, 
            strm.aoit, 
            strm.aoit_kw, 
            strm.arlo, 
            strm.bcyc, 
            strm.bcyc_kw, 
            strm.binb, 
            strm.binb_kw, 
            strm.bloc, 
            strm.bloc_ref_compnr, 
            strm.bout, 
            strm.bout_kw, 
            strm.ccal, 
            strm.ccal_ref_compnr, 
            strm.cdap, 
            strm.cdap_kw, 
            strm.cdcr, 
            strm.cdcr_kw, 
            strm.cdlt, 
            strm.cdlu, 
            strm.cdlu_kw, 
            strm.cdoa, 
            strm.cdoa_kw, 
            strm.cdpd, 
            strm.cdpd_ref_compnr, 
            strm.cdrd, 
            strm.cdrd_ref_compnr, 
            strm.cdro, 
            strm.cdro_kw, 
            strm.coka, 
            strm.compnr, 
            strm.cons, 
            strm.cons_kw, 
            strm.copa, 
            strm.copc, 
            strm.copp, 
            strm.copr, 
            strm.copu, 
            strm.cwar, 
            strm.cwar_arlo_ref_compnr, 
            strm.cwar_palo_ref_compnr, 
            strm.cwar_ref_compnr, 
            strm.cwar_relo_ref_compnr, 
            strm.cwar_stlo_ref_compnr, 
            strm.ddti, 
            strm.ddti_kw, 
            strm.ddwi, 
            strm.ddwi_kw, 
            strm.ddwr, 
            strm.ddwr_kw, 
            strm.deleted, 
            strm.diws, 
            strm.diws_kw, 
            strm.dmdt, 
            strm.dmdt_kw, 
            strm.dmph, 
            strm.dmsi, 
            strm.dmsi_kw, 
            strm.dmsl, 
            strm.dmsl_ref_compnr, 
            strm.dmsp, 
            strm.dmsp_kw, 
            strm.dmsr, 
            strm.dmsr_kw, 
            strm.dmss, 
            strm.dmss_kw, 
            strm.dphi, 
            strm.dprl, 
            strm.dprl_kw, 
            strm.dptr, 
            strm.dptr_kw, 
            strm.dycd, 
            strm.dycd_kw, 
            strm.fire, 
            strm.fire_kw, 
            strm.flhu, 
            strm.flhu_kw, 
            strm.flup, 
            strm.flup_kw, 
            strm.free, 
            strm.frlo, 
            strm.frlo_kw, 
            strm.geha, 
            strm.geha_kw, 
            strm.gehc, 
            strm.gehc_kw, 
            strm.gehp, 
            strm.gehp_kw, 
            strm.gehr, 
            strm.gehr_kw, 
            strm.gehu, 
            strm.gehu_kw, 
            strm.ghps, 
            strm.ghps_kw, 
            strm.gnsh, 
            strm.gnsh_kw, 
            strm.ialt, 
            strm.ialt_kw, 
            strm.ieod, 
            strm.ieod_kw, 
            strm.ilmc, 
            strm.ilmc_ref_compnr, 
            strm.iltm, 
            strm.iltu, 
            strm.iltu_kw, 
            strm.imdp, 
            strm.imdp_ref_compnr, 
            strm.itlo, 
            strm.itlo_kw, 
            strm.karu, 
            strm.karu_ref_compnr, 
            strm.kdev, 
            strm.kmsk, 
            strm.kmsk_ref_compnr, 
            strm.laba, 
            strm.laba_ref_compnr, 
            strm.labc, 
            strm.labc_ref_compnr, 
            strm.labi, 
            strm.labi_ref_compnr, 
            strm.labo, 
            strm.labo_ref_compnr, 
            strm.labr, 
            strm.labr_ref_compnr, 
            strm.lolo, 
            strm.lolo_kw, 
            strm.lpad, 
            strm.lpad_kw, 
            strm.lpas, 
            strm.lpas_kw, 
            strm.lpcc, 
            strm.lpcc_kw, 
            strm.lppi, 
            strm.lppi_kw, 
            strm.lpre, 
            strm.lpre_kw, 
            strm.mada, 
            strm.mada_kw, 
            strm.masi, 
            strm.masu, 
            strm.masu_kw, 
            strm.matt, 
            strm.matu, 
            strm.matu_kw, 
            strm.mcca, 
            strm.mcca_kw, 
            strm.mipa, 
            strm.mipa_kw, 
            strm.misi, 
            strm.misu, 
            strm.misu_kw, 
            strm.mitt, 
            strm.mitu, 
            strm.mitu_kw, 
            strm.mopa, 
            strm.mopa_kw, 
            strm.mrhu, 
            strm.mrhu_kw, 
            strm.olmc, 
            strm.olmc_ref_compnr, 
            strm.oltm, 
            strm.oltu, 
            strm.oltu_kw, 
            strm.orbo, 
            strm.orbo_kw, 
            strm.palo, 
            strm.prla, 
            strm.prla_kw, 
            strm.prlc, 
            strm.prlc_kw, 
            strm.prlp, 
            strm.prlp_kw, 
            strm.prlr, 
            strm.prlr_kw, 
            strm.prlu, 
            strm.prlu_kw, 
            strm.prmp, 
            strm.prmp_kw, 
            strm.prmr, 
            strm.prmr_kw, 
            strm.prmu, 
            strm.prmu_kw, 
            strm.prva, 
            strm.prva_kw, 
            strm.qfma, 
            strm.qfmi, 
            strm.qmoo, 
            strm.qmoo_kw, 
            strm.qwrh, 
            strm.qwrh_ref_compnr, 
            strm.ract, 
            strm.ract_ref_compnr, 
            strm.reje, 
            strm.reje_kw, 
            strm.relo, 
            strm.rfsa, 
            strm.rfsa_kw, 
            strm.rilt, 
            strm.rilu, 
            strm.rilu_kw, 
            strm.rkbs, 
            strm.rkbs_kw, 
            strm.rolt, 
            strm.rolu, 
            strm.rolu_kw, 
            strm.rsdn, 
            strm.rsdn_kw, 
            strm.rsrc, 
            strm.rsrc_kw, 
            strm.rtcf, 
            strm.rtcf_kw, 
            strm.scom, 
            strm.sequencenumber, 
            strm.sfwh, 
            strm.sfwh_kw, 
            strm.shhu, 
            strm.shhu_kw, 
            strm.shtw, 
            strm.shtw_ref_compnr, 
            strm.site, 
            strm.site_ref_compnr, 
            strm.sloc, 
            strm.sloc_kw, 
            strm.smsh, 
            strm.smsh_kw, 
            strm.spps, 
            strm.spps_kw, 
            strm.sscc, 
            strm.sscc_kw, 
            strm.stlo, 
            strm.sups, 
            strm.sups_kw, 
            strm.supw, 
            strm.supw_ref_compnr, 
            strm.timestamp, 
            strm.trdc, 
            strm.trdc_kw, 
            strm.ufpl, 
            strm.ufpl_kw, 
            strm.uhii, 
            strm.uhii_kw, 
            strm.uhin, 
            strm.uhin_kw, 
            strm.uhir, 
            strm.uhir_kw, 
            strm.uhis, 
            strm.uhis_kw, 
            strm.uhnd, 
            strm.uhnd_kw, 
            strm.uhoa, 
            strm.uhoa_kw, 
            strm.uhri, 
            strm.uhri_kw, 
            strm.uidt, 
            strm.uidt_kw, 
            strm.uolo, 
            strm.uolo_kw, 
            strm.username, 
            strm.usmd, 
            strm.usmd_kw, 
            strm.usse, 
            strm.usse_kw, 
            strm.uudl, 
            strm.uudl_kw, 
            strm.uwtr, 
            strm.uwtr_kw, 
            strm.vpad, 
            strm.vpad_kw, 
            strm.vpcc, 
            strm.vpcc_kw, 
            strm.wvgr, 
            strm.wvgr_ref_compnr, 
            strm.zere, 
            strm.zere_kw, 
            strm.ETL_SEQUENCE_NUMBER,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.compnr,
            strm.cwar ORDER BY strm.ETL_SEQUENCE_NUMBER desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_LN_WHWMD200 as  strm
        WHERE strm.ETL_DELETED=TRUE
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.compnr=src.compnr) OR (target.compnr IS NULL AND src.compnr IS NULL)) AND
            ((target.cwar=src.cwar) OR (target.cwar IS NULL AND src.cwar IS NULL)) 
                when matched then update set
                    target.aipd=src.aipd, 
                    target.aipd_kw=src.aipd_kw, 
                    target.aoit=src.aoit, 
                    target.aoit_kw=src.aoit_kw, 
                    target.arlo=src.arlo, 
                    target.bcyc=src.bcyc, 
                    target.bcyc_kw=src.bcyc_kw, 
                    target.binb=src.binb, 
                    target.binb_kw=src.binb_kw, 
                    target.bloc=src.bloc, 
                    target.bloc_ref_compnr=src.bloc_ref_compnr, 
                    target.bout=src.bout, 
                    target.bout_kw=src.bout_kw, 
                    target.ccal=src.ccal, 
                    target.ccal_ref_compnr=src.ccal_ref_compnr, 
                    target.cdap=src.cdap, 
                    target.cdap_kw=src.cdap_kw, 
                    target.cdcr=src.cdcr, 
                    target.cdcr_kw=src.cdcr_kw, 
                    target.cdlt=src.cdlt, 
                    target.cdlu=src.cdlu, 
                    target.cdlu_kw=src.cdlu_kw, 
                    target.cdoa=src.cdoa, 
                    target.cdoa_kw=src.cdoa_kw, 
                    target.cdpd=src.cdpd, 
                    target.cdpd_ref_compnr=src.cdpd_ref_compnr, 
                    target.cdrd=src.cdrd, 
                    target.cdrd_ref_compnr=src.cdrd_ref_compnr, 
                    target.cdro=src.cdro, 
                    target.cdro_kw=src.cdro_kw, 
                    target.coka=src.coka, 
                    target.compnr=src.compnr, 
                    target.cons=src.cons, 
                    target.cons_kw=src.cons_kw, 
                    target.copa=src.copa, 
                    target.copc=src.copc, 
                    target.copp=src.copp, 
                    target.copr=src.copr, 
                    target.copu=src.copu, 
                    target.cwar=src.cwar, 
                    target.cwar_arlo_ref_compnr=src.cwar_arlo_ref_compnr, 
                    target.cwar_palo_ref_compnr=src.cwar_palo_ref_compnr, 
                    target.cwar_ref_compnr=src.cwar_ref_compnr, 
                    target.cwar_relo_ref_compnr=src.cwar_relo_ref_compnr, 
                    target.cwar_stlo_ref_compnr=src.cwar_stlo_ref_compnr, 
                    target.ddti=src.ddti, 
                    target.ddti_kw=src.ddti_kw, 
                    target.ddwi=src.ddwi, 
                    target.ddwi_kw=src.ddwi_kw, 
                    target.ddwr=src.ddwr, 
                    target.ddwr_kw=src.ddwr_kw, 
                    target.deleted=src.deleted, 
                    target.diws=src.diws, 
                    target.diws_kw=src.diws_kw, 
                    target.dmdt=src.dmdt, 
                    target.dmdt_kw=src.dmdt_kw, 
                    target.dmph=src.dmph, 
                    target.dmsi=src.dmsi, 
                    target.dmsi_kw=src.dmsi_kw, 
                    target.dmsl=src.dmsl, 
                    target.dmsl_ref_compnr=src.dmsl_ref_compnr, 
                    target.dmsp=src.dmsp, 
                    target.dmsp_kw=src.dmsp_kw, 
                    target.dmsr=src.dmsr, 
                    target.dmsr_kw=src.dmsr_kw, 
                    target.dmss=src.dmss, 
                    target.dmss_kw=src.dmss_kw, 
                    target.dphi=src.dphi, 
                    target.dprl=src.dprl, 
                    target.dprl_kw=src.dprl_kw, 
                    target.dptr=src.dptr, 
                    target.dptr_kw=src.dptr_kw, 
                    target.dycd=src.dycd, 
                    target.dycd_kw=src.dycd_kw, 
                    target.fire=src.fire, 
                    target.fire_kw=src.fire_kw, 
                    target.flhu=src.flhu, 
                    target.flhu_kw=src.flhu_kw, 
                    target.flup=src.flup, 
                    target.flup_kw=src.flup_kw, 
                    target.free=src.free, 
                    target.frlo=src.frlo, 
                    target.frlo_kw=src.frlo_kw, 
                    target.geha=src.geha, 
                    target.geha_kw=src.geha_kw, 
                    target.gehc=src.gehc, 
                    target.gehc_kw=src.gehc_kw, 
                    target.gehp=src.gehp, 
                    target.gehp_kw=src.gehp_kw, 
                    target.gehr=src.gehr, 
                    target.gehr_kw=src.gehr_kw, 
                    target.gehu=src.gehu, 
                    target.gehu_kw=src.gehu_kw, 
                    target.ghps=src.ghps, 
                    target.ghps_kw=src.ghps_kw, 
                    target.gnsh=src.gnsh, 
                    target.gnsh_kw=src.gnsh_kw, 
                    target.ialt=src.ialt, 
                    target.ialt_kw=src.ialt_kw, 
                    target.ieod=src.ieod, 
                    target.ieod_kw=src.ieod_kw, 
                    target.ilmc=src.ilmc, 
                    target.ilmc_ref_compnr=src.ilmc_ref_compnr, 
                    target.iltm=src.iltm, 
                    target.iltu=src.iltu, 
                    target.iltu_kw=src.iltu_kw, 
                    target.imdp=src.imdp, 
                    target.imdp_ref_compnr=src.imdp_ref_compnr, 
                    target.itlo=src.itlo, 
                    target.itlo_kw=src.itlo_kw, 
                    target.karu=src.karu, 
                    target.karu_ref_compnr=src.karu_ref_compnr, 
                    target.kdev=src.kdev, 
                    target.kmsk=src.kmsk, 
                    target.kmsk_ref_compnr=src.kmsk_ref_compnr, 
                    target.laba=src.laba, 
                    target.laba_ref_compnr=src.laba_ref_compnr, 
                    target.labc=src.labc, 
                    target.labc_ref_compnr=src.labc_ref_compnr, 
                    target.labi=src.labi, 
                    target.labi_ref_compnr=src.labi_ref_compnr, 
                    target.labo=src.labo, 
                    target.labo_ref_compnr=src.labo_ref_compnr, 
                    target.labr=src.labr, 
                    target.labr_ref_compnr=src.labr_ref_compnr, 
                    target.lolo=src.lolo, 
                    target.lolo_kw=src.lolo_kw, 
                    target.lpad=src.lpad, 
                    target.lpad_kw=src.lpad_kw, 
                    target.lpas=src.lpas, 
                    target.lpas_kw=src.lpas_kw, 
                    target.lpcc=src.lpcc, 
                    target.lpcc_kw=src.lpcc_kw, 
                    target.lppi=src.lppi, 
                    target.lppi_kw=src.lppi_kw, 
                    target.lpre=src.lpre, 
                    target.lpre_kw=src.lpre_kw, 
                    target.mada=src.mada, 
                    target.mada_kw=src.mada_kw, 
                    target.masi=src.masi, 
                    target.masu=src.masu, 
                    target.masu_kw=src.masu_kw, 
                    target.matt=src.matt, 
                    target.matu=src.matu, 
                    target.matu_kw=src.matu_kw, 
                    target.mcca=src.mcca, 
                    target.mcca_kw=src.mcca_kw, 
                    target.mipa=src.mipa, 
                    target.mipa_kw=src.mipa_kw, 
                    target.misi=src.misi, 
                    target.misu=src.misu, 
                    target.misu_kw=src.misu_kw, 
                    target.mitt=src.mitt, 
                    target.mitu=src.mitu, 
                    target.mitu_kw=src.mitu_kw, 
                    target.mopa=src.mopa, 
                    target.mopa_kw=src.mopa_kw, 
                    target.mrhu=src.mrhu, 
                    target.mrhu_kw=src.mrhu_kw, 
                    target.olmc=src.olmc, 
                    target.olmc_ref_compnr=src.olmc_ref_compnr, 
                    target.oltm=src.oltm, 
                    target.oltu=src.oltu, 
                    target.oltu_kw=src.oltu_kw, 
                    target.orbo=src.orbo, 
                    target.orbo_kw=src.orbo_kw, 
                    target.palo=src.palo, 
                    target.prla=src.prla, 
                    target.prla_kw=src.prla_kw, 
                    target.prlc=src.prlc, 
                    target.prlc_kw=src.prlc_kw, 
                    target.prlp=src.prlp, 
                    target.prlp_kw=src.prlp_kw, 
                    target.prlr=src.prlr, 
                    target.prlr_kw=src.prlr_kw, 
                    target.prlu=src.prlu, 
                    target.prlu_kw=src.prlu_kw, 
                    target.prmp=src.prmp, 
                    target.prmp_kw=src.prmp_kw, 
                    target.prmr=src.prmr, 
                    target.prmr_kw=src.prmr_kw, 
                    target.prmu=src.prmu, 
                    target.prmu_kw=src.prmu_kw, 
                    target.prva=src.prva, 
                    target.prva_kw=src.prva_kw, 
                    target.qfma=src.qfma, 
                    target.qfmi=src.qfmi, 
                    target.qmoo=src.qmoo, 
                    target.qmoo_kw=src.qmoo_kw, 
                    target.qwrh=src.qwrh, 
                    target.qwrh_ref_compnr=src.qwrh_ref_compnr, 
                    target.ract=src.ract, 
                    target.ract_ref_compnr=src.ract_ref_compnr, 
                    target.reje=src.reje, 
                    target.reje_kw=src.reje_kw, 
                    target.relo=src.relo, 
                    target.rfsa=src.rfsa, 
                    target.rfsa_kw=src.rfsa_kw, 
                    target.rilt=src.rilt, 
                    target.rilu=src.rilu, 
                    target.rilu_kw=src.rilu_kw, 
                    target.rkbs=src.rkbs, 
                    target.rkbs_kw=src.rkbs_kw, 
                    target.rolt=src.rolt, 
                    target.rolu=src.rolu, 
                    target.rolu_kw=src.rolu_kw, 
                    target.rsdn=src.rsdn, 
                    target.rsdn_kw=src.rsdn_kw, 
                    target.rsrc=src.rsrc, 
                    target.rsrc_kw=src.rsrc_kw, 
                    target.rtcf=src.rtcf, 
                    target.rtcf_kw=src.rtcf_kw, 
                    target.scom=src.scom, 
                    target.sequencenumber=src.sequencenumber, 
                    target.sfwh=src.sfwh, 
                    target.sfwh_kw=src.sfwh_kw, 
                    target.shhu=src.shhu, 
                    target.shhu_kw=src.shhu_kw, 
                    target.shtw=src.shtw, 
                    target.shtw_ref_compnr=src.shtw_ref_compnr, 
                    target.site=src.site, 
                    target.site_ref_compnr=src.site_ref_compnr, 
                    target.sloc=src.sloc, 
                    target.sloc_kw=src.sloc_kw, 
                    target.smsh=src.smsh, 
                    target.smsh_kw=src.smsh_kw, 
                    target.spps=src.spps, 
                    target.spps_kw=src.spps_kw, 
                    target.sscc=src.sscc, 
                    target.sscc_kw=src.sscc_kw, 
                    target.stlo=src.stlo, 
                    target.sups=src.sups, 
                    target.sups_kw=src.sups_kw, 
                    target.supw=src.supw, 
                    target.supw_ref_compnr=src.supw_ref_compnr, 
                    target.timestamp=src.timestamp, 
                    target.trdc=src.trdc, 
                    target.trdc_kw=src.trdc_kw, 
                    target.ufpl=src.ufpl, 
                    target.ufpl_kw=src.ufpl_kw, 
                    target.uhii=src.uhii, 
                    target.uhii_kw=src.uhii_kw, 
                    target.uhin=src.uhin, 
                    target.uhin_kw=src.uhin_kw, 
                    target.uhir=src.uhir, 
                    target.uhir_kw=src.uhir_kw, 
                    target.uhis=src.uhis, 
                    target.uhis_kw=src.uhis_kw, 
                    target.uhnd=src.uhnd, 
                    target.uhnd_kw=src.uhnd_kw, 
                    target.uhoa=src.uhoa, 
                    target.uhoa_kw=src.uhoa_kw, 
                    target.uhri=src.uhri, 
                    target.uhri_kw=src.uhri_kw, 
                    target.uidt=src.uidt, 
                    target.uidt_kw=src.uidt_kw, 
                    target.uolo=src.uolo, 
                    target.uolo_kw=src.uolo_kw, 
                    target.username=src.username, 
                    target.usmd=src.usmd, 
                    target.usmd_kw=src.usmd_kw, 
                    target.usse=src.usse, 
                    target.usse_kw=src.usse_kw, 
                    target.uudl=src.uudl, 
                    target.uudl_kw=src.uudl_kw, 
                    target.uwtr=src.uwtr, 
                    target.uwtr_kw=src.uwtr_kw, 
                    target.vpad=src.vpad, 
                    target.vpad_kw=src.vpad_kw, 
                    target.vpcc=src.vpcc, 
                    target.vpcc_kw=src.vpcc_kw, 
                    target.wvgr=src.wvgr, 
                    target.wvgr_ref_compnr=src.wvgr_ref_compnr, 
                    target.zere=src.zere, 
                    target.zere_kw=src.zere_kw, 
                    target.ETL_SEQUENCE_NUMBER=src.ETL_SEQUENCE_NUMBER,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename,
                    target.ETL_DELETED=src.ETL_DELETED
        when not matched   then insert ( aipd, aipd_kw, aoit, aoit_kw, arlo, bcyc, bcyc_kw, binb, binb_kw, bloc, bloc_ref_compnr, bout, bout_kw, ccal, ccal_ref_compnr, cdap, cdap_kw, cdcr, cdcr_kw, cdlt, cdlu, cdlu_kw, cdoa, cdoa_kw, cdpd, cdpd_ref_compnr, cdrd, cdrd_ref_compnr, cdro, cdro_kw, coka, compnr, cons, cons_kw, copa, copc, copp, copr, copu, cwar, cwar_arlo_ref_compnr, cwar_palo_ref_compnr, cwar_ref_compnr, cwar_relo_ref_compnr, cwar_stlo_ref_compnr, ddti, ddti_kw, ddwi, ddwi_kw, ddwr, ddwr_kw, deleted, diws, diws_kw, dmdt, dmdt_kw, dmph, dmsi, dmsi_kw, dmsl, dmsl_ref_compnr, dmsp, dmsp_kw, dmsr, dmsr_kw, dmss, dmss_kw, dphi, dprl, dprl_kw, dptr, dptr_kw, dycd, dycd_kw, fire, fire_kw, flhu, flhu_kw, flup, flup_kw, free, frlo, frlo_kw, geha, geha_kw, gehc, gehc_kw, gehp, gehp_kw, gehr, gehr_kw, gehu, gehu_kw, ghps, ghps_kw, gnsh, gnsh_kw, ialt, ialt_kw, ieod, ieod_kw, ilmc, ilmc_ref_compnr, iltm, iltu, iltu_kw, imdp, imdp_ref_compnr, itlo, itlo_kw, karu, karu_ref_compnr, kdev, kmsk, kmsk_ref_compnr, laba, laba_ref_compnr, labc, labc_ref_compnr, labi, labi_ref_compnr, labo, labo_ref_compnr, labr, labr_ref_compnr, lolo, lolo_kw, lpad, lpad_kw, lpas, lpas_kw, lpcc, lpcc_kw, lppi, lppi_kw, lpre, lpre_kw, mada, mada_kw, masi, masu, masu_kw, matt, matu, matu_kw, mcca, mcca_kw, mipa, mipa_kw, misi, misu, misu_kw, mitt, mitu, mitu_kw, mopa, mopa_kw, mrhu, mrhu_kw, olmc, olmc_ref_compnr, oltm, oltu, oltu_kw, orbo, orbo_kw, palo, prla, prla_kw, prlc, prlc_kw, prlp, prlp_kw, prlr, prlr_kw, prlu, prlu_kw, prmp, prmp_kw, prmr, prmr_kw, prmu, prmu_kw, prva, prva_kw, qfma, qfmi, qmoo, qmoo_kw, qwrh, qwrh_ref_compnr, ract, ract_ref_compnr, reje, reje_kw, relo, rfsa, rfsa_kw, rilt, rilu, rilu_kw, rkbs, rkbs_kw, rolt, rolu, rolu_kw, rsdn, rsdn_kw, rsrc, rsrc_kw, rtcf, rtcf_kw, scom, sequencenumber, sfwh, sfwh_kw, shhu, shhu_kw, shtw, shtw_ref_compnr, site, site_ref_compnr, sloc, sloc_kw, smsh, smsh_kw, spps, spps_kw, sscc, sscc_kw, stlo, sups, sups_kw, supw, supw_ref_compnr, timestamp, trdc, trdc_kw, ufpl, ufpl_kw, uhii, uhii_kw, uhin, uhin_kw, uhir, uhir_kw, uhis, uhis_kw, uhnd, uhnd_kw, uhoa, uhoa_kw, uhri, uhri_kw, uidt, uidt_kw, uolo, uolo_kw, username, usmd, usmd_kw, usse, usse_kw, uudl, uudl_kw, uwtr, uwtr_kw, vpad, vpad_kw, vpcc, vpcc_kw, wvgr, wvgr_ref_compnr, zere, zere_kw, 
                    ETL_SEQUENCE_NUMBER,                       
                    etl_load_datetime,
                    etl_load_metadatafilename,
                    etl_is_deleted,
                    ETL_DELETED) 
            values (
                    src.aipd, 
                    src.aipd_kw, 
                    src.aoit, 
                    src.aoit_kw, 
                    src.arlo, 
                    src.bcyc, 
                    src.bcyc_kw, 
                    src.binb, 
                    src.binb_kw, 
                    src.bloc, 
                    src.bloc_ref_compnr, 
                    src.bout, 
                    src.bout_kw, 
                    src.ccal, 
                    src.ccal_ref_compnr, 
                    src.cdap, 
                    src.cdap_kw, 
                    src.cdcr, 
                    src.cdcr_kw, 
                    src.cdlt, 
                    src.cdlu, 
                    src.cdlu_kw, 
                    src.cdoa, 
                    src.cdoa_kw, 
                    src.cdpd, 
                    src.cdpd_ref_compnr, 
                    src.cdrd, 
                    src.cdrd_ref_compnr, 
                    src.cdro, 
                    src.cdro_kw, 
                    src.coka, 
                    src.compnr, 
                    src.cons, 
                    src.cons_kw, 
                    src.copa, 
                    src.copc, 
                    src.copp, 
                    src.copr, 
                    src.copu, 
                    src.cwar, 
                    src.cwar_arlo_ref_compnr, 
                    src.cwar_palo_ref_compnr, 
                    src.cwar_ref_compnr, 
                    src.cwar_relo_ref_compnr, 
                    src.cwar_stlo_ref_compnr, 
                    src.ddti, 
                    src.ddti_kw, 
                    src.ddwi, 
                    src.ddwi_kw, 
                    src.ddwr, 
                    src.ddwr_kw, 
                    src.deleted, 
                    src.diws, 
                    src.diws_kw, 
                    src.dmdt, 
                    src.dmdt_kw, 
                    src.dmph, 
                    src.dmsi, 
                    src.dmsi_kw, 
                    src.dmsl, 
                    src.dmsl_ref_compnr, 
                    src.dmsp, 
                    src.dmsp_kw, 
                    src.dmsr, 
                    src.dmsr_kw, 
                    src.dmss, 
                    src.dmss_kw, 
                    src.dphi, 
                    src.dprl, 
                    src.dprl_kw, 
                    src.dptr, 
                    src.dptr_kw, 
                    src.dycd, 
                    src.dycd_kw, 
                    src.fire, 
                    src.fire_kw, 
                    src.flhu, 
                    src.flhu_kw, 
                    src.flup, 
                    src.flup_kw, 
                    src.free, 
                    src.frlo, 
                    src.frlo_kw, 
                    src.geha, 
                    src.geha_kw, 
                    src.gehc, 
                    src.gehc_kw, 
                    src.gehp, 
                    src.gehp_kw, 
                    src.gehr, 
                    src.gehr_kw, 
                    src.gehu, 
                    src.gehu_kw, 
                    src.ghps, 
                    src.ghps_kw, 
                    src.gnsh, 
                    src.gnsh_kw, 
                    src.ialt, 
                    src.ialt_kw, 
                    src.ieod, 
                    src.ieod_kw, 
                    src.ilmc, 
                    src.ilmc_ref_compnr, 
                    src.iltm, 
                    src.iltu, 
                    src.iltu_kw, 
                    src.imdp, 
                    src.imdp_ref_compnr, 
                    src.itlo, 
                    src.itlo_kw, 
                    src.karu, 
                    src.karu_ref_compnr, 
                    src.kdev, 
                    src.kmsk, 
                    src.kmsk_ref_compnr, 
                    src.laba, 
                    src.laba_ref_compnr, 
                    src.labc, 
                    src.labc_ref_compnr, 
                    src.labi, 
                    src.labi_ref_compnr, 
                    src.labo, 
                    src.labo_ref_compnr, 
                    src.labr, 
                    src.labr_ref_compnr, 
                    src.lolo, 
                    src.lolo_kw, 
                    src.lpad, 
                    src.lpad_kw, 
                    src.lpas, 
                    src.lpas_kw, 
                    src.lpcc, 
                    src.lpcc_kw, 
                    src.lppi, 
                    src.lppi_kw, 
                    src.lpre, 
                    src.lpre_kw, 
                    src.mada, 
                    src.mada_kw, 
                    src.masi, 
                    src.masu, 
                    src.masu_kw, 
                    src.matt, 
                    src.matu, 
                    src.matu_kw, 
                    src.mcca, 
                    src.mcca_kw, 
                    src.mipa, 
                    src.mipa_kw, 
                    src.misi, 
                    src.misu, 
                    src.misu_kw, 
                    src.mitt, 
                    src.mitu, 
                    src.mitu_kw, 
                    src.mopa, 
                    src.mopa_kw, 
                    src.mrhu, 
                    src.mrhu_kw, 
                    src.olmc, 
                    src.olmc_ref_compnr, 
                    src.oltm, 
                    src.oltu, 
                    src.oltu_kw, 
                    src.orbo, 
                    src.orbo_kw, 
                    src.palo, 
                    src.prla, 
                    src.prla_kw, 
                    src.prlc, 
                    src.prlc_kw, 
                    src.prlp, 
                    src.prlp_kw, 
                    src.prlr, 
                    src.prlr_kw, 
                    src.prlu, 
                    src.prlu_kw, 
                    src.prmp, 
                    src.prmp_kw, 
                    src.prmr, 
                    src.prmr_kw, 
                    src.prmu, 
                    src.prmu_kw, 
                    src.prva, 
                    src.prva_kw, 
                    src.qfma, 
                    src.qfmi, 
                    src.qmoo, 
                    src.qmoo_kw, 
                    src.qwrh, 
                    src.qwrh_ref_compnr, 
                    src.ract, 
                    src.ract_ref_compnr, 
                    src.reje, 
                    src.reje_kw, 
                    src.relo, 
                    src.rfsa, 
                    src.rfsa_kw, 
                    src.rilt, 
                    src.rilu, 
                    src.rilu_kw, 
                    src.rkbs, 
                    src.rkbs_kw, 
                    src.rolt, 
                    src.rolu, 
                    src.rolu_kw, 
                    src.rsdn, 
                    src.rsdn_kw, 
                    src.rsrc, 
                    src.rsrc_kw, 
                    src.rtcf, 
                    src.rtcf_kw, 
                    src.scom, 
                    src.sequencenumber, 
                    src.sfwh, 
                    src.sfwh_kw, 
                    src.shhu, 
                    src.shhu_kw, 
                    src.shtw, 
                    src.shtw_ref_compnr, 
                    src.site, 
                    src.site_ref_compnr, 
                    src.sloc, 
                    src.sloc_kw, 
                    src.smsh, 
                    src.smsh_kw, 
                    src.spps, 
                    src.spps_kw, 
                    src.sscc, 
                    src.sscc_kw, 
                    src.stlo, 
                    src.sups, 
                    src.sups_kw, 
                    src.supw, 
                    src.supw_ref_compnr, 
                    src.timestamp, 
                    src.trdc, 
                    src.trdc_kw, 
                    src.ufpl, 
                    src.ufpl_kw, 
                    src.uhii, 
                    src.uhii_kw, 
                    src.uhin, 
                    src.uhin_kw, 
                    src.uhir, 
                    src.uhir_kw, 
                    src.uhis, 
                    src.uhis_kw, 
                    src.uhnd, 
                    src.uhnd_kw, 
                    src.uhoa, 
                    src.uhoa_kw, 
                    src.uhri, 
                    src.uhri_kw, 
                    src.uidt, 
                    src.uidt_kw, 
                    src.uolo, 
                    src.uolo_kw, 
                    src.username, 
                    src.usmd, 
                    src.usmd_kw, 
                    src.usse, 
                    src.usse_kw, 
                    src.uudl, 
                    src.uudl_kw, 
                    src.uwtr, 
                    src.uwtr_kw, 
                    src.vpad, 
                    src.vpad_kw, 
                    src.vpcc, 
                    src.vpcc_kw, 
                    src.wvgr, 
                    src.wvgr_ref_compnr, 
                    src.zere, 
                    src.zere_kw,     
                    src.ETL_SEQUENCE_NUMBER,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename,
                    case when ETL_DELETED=TRUE then TRUE else FALSE end,
                    ETL_DELETED);
    `
} );

                    
//  Get number of rows inserted
        
        var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
        var rs = sqlStmt.execute();
        var number_of_rows_inserted = sqlStmt.getNumRowsInserted();
        var number_of_rows_updated =  sqlStmt.getNumRowsUpdated();
                    

        
    snowflake.execute ({sqlText: "commit"});

    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Success','Completed process execution.', 0 ," + number_of_rows_inserted.toString()+ "," +  number_of_rows_updated.toString() + ");";
    snowflake.execute({sqlText: log_sql_command});

    result = "Success"; 

    }       

    catch (err)  {
        snowflake.execute( {sqlText: "rollback;"} )
        var clean_error_msg = err.message.replace(/[^\w\s]/gi, '');
    //  Create a log entry to say INSERT STATEMENT failed
    
    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Failed','MERGE Failed. Error:" + err.code.toString()+" : "+ clean_error_msg  + "', 0 ,0,0);";
    snowflake.execute({sqlText: log_sql_command});
        ;
        throw "Failed: " + err.message;   // Return a success/error indicator.
        }
    return result;
    $$;