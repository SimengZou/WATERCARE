CREATE OR REPLACE SECURE VIEW DATAHUB_SHARED_TCC.VWS_WATER_MISC
AS
SELECT 
 A1."ACQTYPE"::VARCHAR(10) AS "Acquistion Type"
, A2."ADDRKEY"::NUMBER(38) AS "Address"
, A2."BLDGFLOOR"::NUMBER(38) AS "BLDGFLOOR"
, A1."BUSINESSAREA"::VARCHAR(10) AS "BUSINESSAREA"
, A2."UNITID"::VARCHAR(50) AS "Asset ID"
, A2."COMPKEY"::NUMBER(38) AS "CompKey"
, A1."COSTCENTRE"::VARCHAR(10) AS "Cost Centre Code"
, 'TBD'::VARCHAR(3) AS "Cost Centre Description"
, A1."CRITICALITY"::VARCHAR(10) AS "Criticality Code"
, 'TBD'::VARCHAR(3) AS "Criticality Description"
, A2."DPTH"::FLOAT AS "Depth"
, A2."UNITDESC"::VARCHAR(300) AS "Description"
, A2."DIAM"::FLOAT AS "Diameter"
, A1."FORDISPOSAL"::VARCHAR(10) AS "Disposal Reason"
, A1."DRAWINGNO"::VARCHAR(30) AS "Drawing No"
, A1."DRAWINGNOREF"::VARCHAR(30) AS "Drawing No Ref"
, A2."BGTNO"::VARCHAR(24) AS "Equipment No"
, A2."EXPDATE"::TIMESTAMP_NTZ(9) AS "Expire Date"
, A2."AREA"::VARCHAR(10) AS "Facility Code"
, 'TBD'::VARCHAR(3) AS "Facility Description"
, A2."HT"::FLOAT AS "Height"
, A2."INSTDATE"::TIMESTAMP_NTZ(9) AS "Installed"
, A2."ASBLT"::VARCHAR(10) AS "Legacy Key"
, A2."LEN"::FLOAT AS "Length"
, A2."MATL"::VARCHAR(10) AS "Material Code"
, 'TBD'::VARCHAR(3) AS "Material Description"
, A2."UNITTYPE"::VARCHAR(10) AS "Miscellaneous Type"
, A1."MODELNO"::VARCHAR(30) AS "Model #"
, A2."OWN"::VARCHAR(10) AS "Ownership Code"
, 'TBD'::VARCHAR(3) AS "Ownership Description"
, A2."MAPNO"::VARCHAR(14) AS "Position"
, A2."SUBAREA"::VARCHAR(10) AS "Process Code"
, 'TBD'::VARCHAR(3) AS "Process Description"
, A1."SAFETYCRITICAL"::VARCHAR(1) AS "Safety Critical Element"
, A2."SERVSTAT"::VARCHAR(10) AS "Service Status"
, A2."LOC"::VARCHAR(10) AS "Set Code"
, 'TBD'::VARCHAR(3) AS "Set Description"
, A2."SURF"::VARCHAR(10) AS "Surface Cover Code"
, 'TBD'::VARCHAR(3) AS "Surface Cover Description"
, A2."DISTRICT"::VARCHAR(10) AS "System Code"
, 'TBD'::VARCHAR(3) AS "System Description"
, A2."WT"::FLOAT AS "Weight"
, A2."WID"::FLOAT AS "Width"
, ad."NZHOUSENO"::VARCHAR(10) AS "Street Number"
, CONCAT(ad."NZSTNAME",' ',ad."NZSTTYPE")::VARCHAR(33) AS "Street Name"
, ad."NZSUBURB"::VARCHAR(30) AS "City"
, ad."NZPOSTCODE"::VARCHAR(5) AS "Postal Code"
, A1.MAKE::VARCHAR(10) AS "Make"
, A2.SERNO::VARCHAR(20) AS "Serial Number"
, A1.ZONECATCHMENT::VARCHAR(10) AS "Water Zone/Sewer Catchment"
, XWATERMISCELLANEOUS.BEARINGTYPE::VARCHAR(1) AS "Bearing Type"
, XWATERMISCELLANEOUS.BOLTDOWN::VARCHAR(1) AS "Boltdown"
, XWATERMISCELLANEOUS.CAPACITY::FLOAT AS "Capacity (m3)"
, XWATERMISCELLANEOUS.COVERTYPE::VARCHAR(10) AS "Cover Type"
, XWATERMISCELLANEOUS.DESIGNSPEED::FLOAT AS "Design Speed (RPM)"
, XWATERMISCELLANEOUS.DIAMEXT::FLOAT AS "Diameter External (mm)"
, XWATERMISCELLANEOUS.DIAMINT::FLOAT AS "Diameter Internal (mm)"
, XWATERMISCELLANEOUS.ENERGYRATING::NUMBER(38) AS "Energy Rating (Kw)"
, XWATERMISCELLANEOUS.FRAMESIZE::VARCHAR(10) AS "Frame Size"
, XWATERMISCELLANEOUS.FUNCOUPUT::VARCHAR(10) AS "Functional Output Mechanical Rotating"
, XWATERMISCELLANEOUS.HINGED::VARCHAR(1) AS "Hinged"
, XWATERMISCELLANEOUS.IMPELLORDIA::FLOAT AS "Impeller Diameter (mm)"
, XWATERMISCELLANEOUS.IMPELLORTYPE::VARCHAR(10) AS "Impeller Type"
, XWATERMISCELLANEOUS.INHIBITLEVEL::FLOAT AS "Inhibit Level (M)"
, XWATERMISCELLANEOUS.CURRENTIN::FLOAT AS "Input Current (Amps)"
, XWATERMISCELLANEOUS.VOLTAGEIN::FLOAT AS "Input Voltage (Volt)"
, XWATERMISCELLANEOUS.VOLTAGEINTYPE::VARCHAR(2) AS "Input Voltage Type"
, XWATERMISCELLANEOUS.INVLEVEL::FLOAT AS "Invert Level (M)"
, XWATERMISCELLANEOUS.DROPMH::VARCHAR(1) AS "Is Drop Manhole"
, XWATERMISCELLANEOUS.LIDLEVEL::FLOAT AS "Lid Level (M)"
, XWATERMISCELLANEOUS.LOCKABLE::VARCHAR(1) AS "Lockable"
, XWATERMISCELLANEOUS.CURRENTOUT::FLOAT AS "Output Current (Amps)"
, XWATERMISCELLANEOUS.VOLTAGEOUT::FLOAT AS "Output Voltage (Volt)"
, XWATERMISCELLANEOUS.VOLTAGEOUTTYPE::VARCHAR(2) AS "Output Voltage Type"
, XWATERMISCELLANEOUS.OVERFLOWLEVEL::FLOAT AS "Overflow Level (M)"
, XWATERMISCELLANEOUS.OVERFLOWTYPE::VARCHAR(10) AS "Overflow Type"
, XWATERMISCELLANEOUS.PHASES::VARCHAR(10) AS "Phases"
, XWATERMISCELLANEOUS.PRESSURERATING::FLOAT AS "Pressure Rating (kPa)"
, XWATERMISCELLANEOUS.REMOVABLE::VARCHAR(1) AS "Removable"
, XWATERMISCELLANEOUS.STAGES::NUMBER(38) AS "Stages"
, XWATERMISCELLANEOUS.STFCABINET::VARCHAR(1) AS "STF Cabinet"
, XWATERMISCELLANEOUS.STFFAN::VARCHAR(1) AS "STF Fan"
, XWATERMISCELLANEOUS.STFFILTER::VARCHAR(1) AS "STF Filter"
, XWATERMISCELLANEOUS.STFHEATER::VARCHAR(1) AS "STF Heater"
, XWATERMISCELLANEOUS.STFLIGHTARRESTOR::VARCHAR(1) AS "STF Lightening Arrestor"
, XWATERMISCELLANEOUS.STFREDUNDANCY::VARCHAR(1) AS "STF Redundancy Module"
, XWATERMISCELLANEOUS.STFSTANDBYUNIT::VARCHAR(1) AS "STF Standby Unit"
, XWATERMISCELLANEOUS.STFTEMP::VARCHAR(1) AS "STF Temperature Monitor"
, XWATERMISCELLANEOUS.STFTRANSCEIVER::VARCHAR(1) AS "STF Transceiver"
, XWATERMISCELLANEOUS.STFVENT::VARCHAR(1) AS "STF Vent"
, XWATERMISCELLANEOUS.STIFFRATING::FLOAT AS "Stiffness Rating (SN)"
, XWATERMISCELLANEOUS.SUBTYPEFEATURES::VARCHAR(10) AS "SubType Features"
, A1.WARRANTYEND::TIMESTAMP_NTZ(9) AS "Warranty End Date"
, A1.WARRANTYSTART::TIMESTAMP_NTZ(9) AS "Warranty Start Date"
, XWATERMISCELLANEOUS.BODYTYPE::VARCHAR(10) AS "Body Type"
, XWATERMISCELLANEOUS.COMMSPROTOCOL::VARCHAR(10) AS "Communications Protocol"
, XWATERMISCELLANEOUS.CONSTMETHOD::VARCHAR(10) AS "Construction Method"
, XWATERMISCELLANEOUS.COOLING::VARCHAR(1) AS "Cooling"
, XWATERMISCELLANEOUS.DESIGNRESILIENCE::VARCHAR(10) AS "Design Resilience"
, XWATERMISCELLANEOUS.DISCHARGECAP::FLOAT AS "Discharge Capacity (m3 per sec)"
, XWATERMISCELLANEOUS.QUAKEDESIGN::VARCHAR(10) AS "Earthquake Design Level"
, XWATERMISCELLANEOUS.EXTCOAT::VARCHAR(10) AS "External Coating"
, XWATERMISCELLANEOUS.FALLPROTECT::VARCHAR(1) AS "Fall Protection"
, XWATERMISCELLANEOUS.FUELTYPE::VARCHAR(10) AS "Fuel Type"
, XWATERMISCELLANEOUS.FUNCAREA::VARCHAR(10) AS "Functional Area"
, XWATERMISCELLANEOUS.GRDLEVEL::FLOAT AS "Ground Level"
, XWATERMISCELLANEOUS.HAZARDRATING::VARCHAR(10) AS "Hazardous Rating"
, XWATERMISCELLANEOUS.IPRATING::VARCHAR(10) AS "Ingress Protection Rating"
, XWATERMISCELLANEOUS.DIAMINLET::FLOAT AS "Inlet Diameter"
, XWATERMISCELLANEOUS.INSTALLMOUNT::VARCHAR(1) AS "Installation Mounting"
, XWATERMISCELLANEOUS.INSTALLORIENT::VARCHAR(1) AS "Installation Orientation"
, XWATERMISCELLANEOUS.INSTRUMENTRANGE::VARCHAR(30) AS "Instrument Range"
, XWATERMISCELLANEOUS.INSULATIONCLASS::VARCHAR(10) AS "Insulation Class"
, XWATERMISCELLANEOUS.INTLINING::VARCHAR(10) AS "Internal Lining"
, XWATERMISCELLANEOUS.JTTYPE::VARCHAR(10) AS "Joint Method"
, XWATERMISCELLANEOUS.LOADRATING::FLOAT AS "Load Rating (kN)"
, XWATERMISCELLANEOUS.LOCALITY::VARCHAR(10) AS "Locality"
, XWATERMISCELLANEOUS.MAXFLOW::FLOAT AS "Maximum Flow"
, XWATERMISCELLANEOUS.MINFLOW::FLOAT AS "Minimum Flow"
, XWATERMISCELLANEOUS.MEDIATYPE::VARCHAR(10) AS "Media Type"
, XWATERMISCELLANEOUS.DIAMOUTLET::FLOAT AS "Outlet Diameter"
, XWATERMISCELLANEOUS.PHOTO3D::VARCHAR(300) AS "Photo/3D Model"
, XWATERMISCELLANEOUS.SPILLWAYTYPE::VARCHAR(10) AS "Spillway Type"
, XWATERMISCELLANEOUS.AREA::FLOAT AS "Surface Area (m2)"
, XWATERMISCELLANEOUS.TORQUE::FLOAT AS "Torque Input Rating"
, XWATERMISCELLANEOUS.TORQUEOUT::FLOAT AS "Torque Output Rating"
FROM
 "DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_WATER_COMPWMS" AS A2
 INNER JOIN "DATAHUB_TARGET"."IPS_WSLASSETS_XALLASSETSDP02" AS A1 ON A2.COMPKEY = A1.COMPKEY AND A1.BUSINESSAREA = 'TCC'
 LEFT OUTER JOIN "DATAHUB_TARGET"."IPS_PROPERTY_ADDRESS" AS ad ON ad.ADDRKEY = a2.ADDRKEY AND ad.OPTA = 'TCC'
 LEFT OUTER JOIN DATAHUB_TARGET.IPS_WSLASSETSWATER_XWATERMISCELLANEOUS AS XWATERMISCELLANEOUS ON A2.COMPKEY = XWATERMISCELLANEOUS.COMPKEY 
 WHERE A2.BLDGFLOOR = 1002;