create or replace TABLE FACT_ACCOUNT_TRANSACTION (
	ACCOUNT_TRANSACTION_SID NUMBER(38,0) NOT NULL autoincrement,
	ACCOUNT_SID NUMBER(38,0),
	ACCOUNT_SERVICE_SID NUMBER(38,0),
	BILL_SID NUMBER(38,0),
	PAYMENT_SID NUMBER(38,0),
	ADJUSTMENT_SID NUMBER(38,0),
	REFUND_SID NUMBER(38,0),
	TRANSACTION_COMMENTS_SID NUMBER(38,0),
	TRANSACTION_BY_EMPLOYEE_SID NUMBER(38,0),
	TRANSACTION_TYPE_SID NUMBER(38,0),
	TRANSACTION_DATE_SID NUMBER(38,0),
	TRANSACTION_ADDED_DATE_SID NUMBER(38,0),
	TRANSACTION_MODIFIED_DATE_SID NUMBER(38,0),
	BILL_DATE_SID NUMBER(38,0),
	ADJUSTMENT_STATUS_DATE_SID NUMBER(38,0),
	ADJUSTMENT_DATE_SID NUMBER(38,0),
	TRANSACTION_NUMBER NUMBER(38,0),
	TRANSACTION_DATE TIMESTAMP_NTZ(9),
	TRANSACTION_ADDED_DATE TIMESTAMP_NTZ(9),
	TRANSACTION_MODIFIED_DATE TIMESTAMP_NTZ(9),
	BILL_DATE TIMESTAMP_NTZ(9),
	ADJUSTMENT_STATUS_DATE TIMESTAMP_NTZ(9),
	ADJUSTMENT_DATE TIMESTAMP_NTZ(9),
	INTERNAL_FLAG VARCHAR(1),
	TRANSACTION_AMOUNT NUMBER(38,4),
	NEEDS_JOURNAL VARCHAR(1),
	BILL_LINE_ITEM_KEY NUMBER(38,0),
	TRANSACTION_SOURCE_CODE NUMBER(38,0),
	TRANSACTION_SOURCE_TYPE NUMBER(38,0),
	ETL_SOURCE_DATETIME TIMESTAMP_NTZ(9),
	ETL_RECORD_CREATED TIMESTAMP_NTZ(9),
	ETL_RECORD_UPDATED TIMESTAMP_NTZ(9),
	primary key (ACCOUNT_TRANSACTION_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_BILL_SID foreign key (BILL_SID) references DATAHUB_ANALYTICS.DIM_BILL(BILL_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_ACCOUNT_SID foreign key (ACCOUNT_SID) references DATAHUB_ANALYTICS.DIM_CUSTOMER_ACCOUNT(ACCOUNT_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_TRANSACTION_DATE_SID foreign key (TRANSACTION_DATE_SID) references DATAHUB_ANALYTICS.DIM_DATE(DATE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_REFUND_SID foreign key (REFUND_SID) references DATAHUB_ANALYTICS.DIM_REFUND(REFUND_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_TRANSACTION_MODIFIED_DATE_SID foreign key (TRANSACTION_MODIFIED_DATE_SID) references DATAHUB_ANALYTICS.DIM_DATE(DATE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_TRANSACTION_ADDED_DATE_SID foreign key (TRANSACTION_ADDED_DATE_SID) references DATAHUB_ANALYTICS.DIM_DATE(DATE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_PAYMENT_SID foreign key (PAYMENT_SID) references DATAHUB_ANALYTICS.DIM_PAYMENT(PAYMENT_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_ADJUSTMENT_SID foreign key (ADJUSTMENT_SID) references DATAHUB_ANALYTICS.DIM_ADJUSTMENT(ADJUSTMENT_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_TRANSACTION_TYPE_SID foreign key (TRANSACTION_TYPE_SID) references DATAHUB_ANALYTICS.DIM_TRANSACTION_TYPE(TRANSACTION_TYPE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_ACCOUNT_SERVICE_SID foreign key (ACCOUNT_SERVICE_SID) references DATAHUB_ANALYTICS.DIM_ACCOUNT_SERVICE(ACCOUNT_SERVICE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_BY_EMPLOYEE_SID foreign key (TRANSACTION_BY_EMPLOYEE_SID) references DATAHUB_ANALYTICS.DIM_EMPLOYEE(EMPLOYEE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_BILL_DATE_SID foreign key (BILL_DATE_SID) references DATAHUB_ANALYTICS.DIM_DATE(DATE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_ADJUSTMENT_STATUS_DATE_SID foreign key (ADJUSTMENT_STATUS_DATE_SID) references DATAHUB_ANALYTICS.DIM_DATE(DATE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_ADJUSTMENT_DATE_SID foreign key (ADJUSTMENT_DATE_SID) references DATAHUB_ANALYTICS.DIM_DATE(DATE_SID),
	constraint FK_FACT_ACCOUNT_TRANSACTION_TRANSACTION_COMMENTS_SID foreign key (TRANSACTION_COMMENTS_SID) references DATAHUB_ANALYTICS.DIM_TRANSACTION_COMMENTS(TRANSACTION_COMMENTS_SID)
);