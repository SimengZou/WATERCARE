CREATE OR REPLACE VIEW ${buildvar.env}_WBP_SHARE.DATAHUB_SHARED_WBP.VW_WATER_MISC
AS
SELECT 
  A1."ACQTYPE" AS "Acquistion Type"
, A2."ADDRKEY" AS "Address"
, A2."BLDGFLOOR" AS "BLDGFLOOR"
, A1."BUSINESSAREA" AS "BUSINESSAREA"
, A2."UNITID" AS "Asset ID"
, A2."COMPKEY" AS "CompKey"
, A1."COSTCENTRE" AS "Cost Centre Code"
, 'TBD' AS "Cost Centre Description"
, A1."CRITICALITY" AS "Criticality Code"
, 'TBD' AS "Criticality Description"
, A2."DPTH" AS "Depth"
, A2."UNITDESC" AS "Description"
, A2."DIAM" AS "Diameter"
, A1."FORDISPOSAL" AS "Disposal Reason"
, A1."DRAWINGNO" AS "Drawing No"
, A1."DRAWINGNOREF" AS "Drawing No Ref"
, A2."BGTNO" AS "Equipment No"
, A2."EXPDATE" AS "Expire Date"
, A2."AREA" AS "Facility Code"
, 'TBD' AS "Facility Description"
, A2."HT" AS "Height"
, A2."INSTDATE" AS "Installed"
, A2."ASBLT" AS "Legacy Key"
, A2."LEN" AS "Length"
, A2."MATL" AS "Material Code"
, 'TBD' AS "Material Description"
, A2."UNITTYPE" AS "Miscellaneous Type"
, A1."MODELNO" AS "Model #"
, A2."OWN" AS "Ownership Code"
, 'TBD' AS "Ownership Description"
, A2."MAPNO" AS "Position"
, A2."SUBAREA" AS "Process Code"
, 'TBD' AS "Process Description"
, A1."SAFETYCRITICAL" AS "Safety Critical Element"
, A2."SERVSTAT" AS "Service Status"
, A2."LOC" AS "Set Code"
, 'TBD' AS "Set Description"
, A2."SURF" AS "Surface Cover Code"
, 'TBD' AS "Surface Cover Description"
, A2."DISTRICT" AS "System Code"
, 'TBD' AS "System Description"
, A2."WT" AS "Weight"
, A2."WID" AS "Width"
, ad."NZHOUSENO" AS "Street Number"
, CONCAT(ad."NZSTNAME",' ',ad."NZSTTYPE") AS "Street Name"
, ad."NZSUBURB" AS "City"
, ad."NZPOSTCODE" AS "Postal Code"

, A1.MAKE                        					   AS "Make"
, A2.SERNO                                         	   AS "Serial Number"
, A1.ZONECATCHMENT               					   AS "Water Zone/Sewer Catchment"
, XWATERMISCELLANEOUS.BEARINGTYPE                      AS "Bearing Type"
, XWATERMISCELLANEOUS.BOLTDOWN                         AS "Boltdown"
, XWATERMISCELLANEOUS.CAPACITY                         AS "Capacity (m3)"
, XWATERMISCELLANEOUS.COVERTYPE                        AS "Cover Type"
, XWATERMISCELLANEOUS.DESIGNSPEED                      AS "Design Speed (RPM)"
, XWATERMISCELLANEOUS.DIAMEXT                 		   AS "Diameter External (mm)"
, XWATERMISCELLANEOUS.DIAMINT                 		   AS "Diameter Internal (mm)"
, XWATERMISCELLANEOUS.ENERGYRATING                     AS "Energy Rating (Kw)"
, XWATERMISCELLANEOUS.FRAMESIZE                        AS "Frame Size"
, XWATERMISCELLANEOUS.FUNCOUPUT                 	   AS "Functional Output Mechanical Rotating"
, XWATERMISCELLANEOUS.HINGED                           AS "Hinged"
, XWATERMISCELLANEOUS.IMPELLORDIA                      AS "Impeller Diameter (mm)"
, XWATERMISCELLANEOUS.IMPELLORTYPE                     AS "Impeller Type"
, XWATERMISCELLANEOUS.INHIBITLEVEL                     AS "Inhibit Level (M)"
, XWATERMISCELLANEOUS.CURRENTIN                        AS "Input Current (Amps)"
, XWATERMISCELLANEOUS.VOLTAGEIN                        AS "Input Voltage (Volt)"
, XWATERMISCELLANEOUS.VOLTAGEINTYPE                    AS "Input Voltage Type"
, XWATERMISCELLANEOUS.INVLEVEL                         AS "Invert Level (M)"
, XWATERMISCELLANEOUS.DROPMH                           AS "Is Drop Manhole"
, XWATERMISCELLANEOUS.LIDLEVEL                         AS "Lid Level (M)"
, XWATERMISCELLANEOUS.LOCKABLE                         AS "Lockable"
, XWATERMISCELLANEOUS.CURRENTOUT                       AS "Output Current (Amps)"
, XWATERMISCELLANEOUS.VOLTAGEOUT                       AS "Output Voltage (Volt)"
, XWATERMISCELLANEOUS.VOLTAGEOUTTYPE                   AS "Output Voltage Type"
, XWATERMISCELLANEOUS.OVERFLOWLEVEL                    AS "Overflow Level (M)"
, XWATERMISCELLANEOUS.OVERFLOWTYPE                     AS "Overflow Type"
, XWATERMISCELLANEOUS.PHASES                           AS "Phases"
, XWATERMISCELLANEOUS.PRESSURERATING                   AS "Pressure Rating (kPa)"
, XWATERMISCELLANEOUS.REMOVABLE                        AS "Removable"
, XWATERMISCELLANEOUS.STAGES                           AS "Stages"
, XWATERMISCELLANEOUS.STFCABINET                       AS "STF Cabinet"
, XWATERMISCELLANEOUS.STFFAN                           AS "STF Fan"
, XWATERMISCELLANEOUS.STFFILTER                        AS "STF Filter"
, XWATERMISCELLANEOUS.STFHEATER                        AS "STF Heater"
, XWATERMISCELLANEOUS.STFLIGHTARRESTOR                 AS "STF Lightening Arrestor"
, XWATERMISCELLANEOUS.STFREDUNDANCY                    AS "STF Redundancy Module"
, XWATERMISCELLANEOUS.STFSTANDBYUNIT                   AS "STF Standby Unit"
, XWATERMISCELLANEOUS.STFTEMP                          AS "STF Temperature Monitor"
, XWATERMISCELLANEOUS.STFTRANSCEIVER                   AS "STF Transceiver"
, XWATERMISCELLANEOUS.STFVENT                          AS "STF Vent"
, XWATERMISCELLANEOUS.STIFFRATING                      AS "Stiffness Rating (SN)"
, XWATERMISCELLANEOUS.SUBTYPEFEATURES                  AS "SubType Features"
, A1.WARRANTYEND                 					   AS "Warranty End Date"
, A1.WARRANTYSTART               					   AS "Warranty Start Date"
, XWATERMISCELLANEOUS.BODYTYPE                         AS "Body Type"
, XWATERMISCELLANEOUS.COMMSPROTOCOL                    AS "Communications Protocol"
, XWATERMISCELLANEOUS.CONSTMETHOD                      AS "Construction Method"
, XWATERMISCELLANEOUS.COOLING                          AS "Cooling"
, XWATERMISCELLANEOUS.DESIGNRESILIENCE                 AS "Design Resilience"
, XWATERMISCELLANEOUS.DISCHARGECAP                	   AS "Discharge Capacity (m3 per sec)"
, XWATERMISCELLANEOUS.QUAKEDESIGN                      AS "Earthquake Design Level"
, XWATERMISCELLANEOUS.EXTCOAT                  		   AS "External Coating"
, XWATERMISCELLANEOUS.FALLPROTECT                      AS "Fall Protection"
, XWATERMISCELLANEOUS.FUELTYPE                         AS "Fuel Type"
, XWATERMISCELLANEOUS.FUNCAREA                   	   AS "Functional Area"
, XWATERMISCELLANEOUS.GRDLEVEL                         AS "Ground Level"
, XWATERMISCELLANEOUS.HAZARDRATING                     AS "Hazardous Rating"
, XWATERMISCELLANEOUS.IPRATING                         AS "Ingress Protection Rating"
, XWATERMISCELLANEOUS.DIAMINLET                    	   AS "Inlet Diameter"
, XWATERMISCELLANEOUS.INSTALLMOUNT                	   AS "Installation Mounting"
, XWATERMISCELLANEOUS.INSTALLORIENT          		   AS "Installation Orientation"
, XWATERMISCELLANEOUS.INSTRUMENTRANGE                  AS "Instrument Range"
, XWATERMISCELLANEOUS.INSULATIONCLASS                  AS "Insulation Class"
, XWATERMISCELLANEOUS.INTLINING                   	   AS "Internal Lining"
, XWATERMISCELLANEOUS.JTTYPE                           AS "Joint Method"
, XWATERMISCELLANEOUS.LOADRATING                       AS "Load Rating (kN)"
, XWATERMISCELLANEOUS.LOCALITY                         AS "Locality"
, XWATERMISCELLANEOUS.MAXFLOW                          AS "Maximum Flow"
, XWATERMISCELLANEOUS.MINFLOW                          AS "Minimum Flow"
, XWATERMISCELLANEOUS.MEDIATYPE                        AS "Media Type"
, XWATERMISCELLANEOUS.DIAMOUTLET                   	   AS "Outlet Diameter"
, XWATERMISCELLANEOUS.PHOTO3D                          AS "Photo/3D Model"
, XWATERMISCELLANEOUS.SPILLWAYTYPE                     AS "Spillway Type"
, XWATERMISCELLANEOUS.AREA                             AS "Surface Area (m2)"
, XWATERMISCELLANEOUS.TORQUE                           AS "Torque Input Rating"
, XWATERMISCELLANEOUS.TORQUEOUT                        AS "Torque Output Rating"

FROM
  "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_WATER_COMPWMS" as A2
  INNER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_WSLASSETS_XALLASSETSDP02" as A1 ON A2.COMPKEY = A1.COMPKEY AND A1.BUSINESSAREA IN ('WBC','WBE','WBW')
  LEFT OUTER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_PROPERTY_ADDRESS" as ad ON ad.ADDRKEY = a2.ADDRKEY AND ad.OPTA = 'WBP'
  LEFT OUTER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET".IPS_WSLASSETSWATER_XWATERMISCELLANEOUS AS XWATERMISCELLANEOUS ON A2.COMPKEY = XWATERMISCELLANEOUS.COMPKEY 
  WHERE A2.BLDGFLOOR = 1003;