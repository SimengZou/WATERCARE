CREATE OR REPLACE VIEW DATAHUB_INTEGRATION.VW_STREAM_EAM_R5ORDERLINES
            AS
            SELECT
                src:"ORL_ACD"::numeric(38, 10) AS ORL_ACD, 
                src:"ORL_ACT"::numeric(38, 10) AS ORL_ACT, 
                src:"ORL_ACTIVE"::varchar AS ORL_ACTIVE, 
                src:"ORL_ALLOWPREPAYMENT"::varchar AS ORL_ALLOWPREPAYMENT, 
                src:"ORL_ATTENTIONTO"::varchar AS ORL_ATTENTIONTO, 
                src:"ORL_BLANKETLINE"::numeric(38, 10) AS ORL_BLANKETLINE, 
                src:"ORL_BLANKETORDER"::varchar AS ORL_BLANKETORDER, 
                src:"ORL_CONTRACT"::varchar AS ORL_CONTRACT, 
                src:"ORL_COSTCODE"::varchar AS ORL_COSTCODE, 
                src:"ORL_CURR"::varchar AS ORL_CURR, 
                src:"ORL_DCKRECVQTY"::numeric(38, 10) AS ORL_DCKRECVQTY, 
                src:"ORL_DELADDRESS"::varchar AS ORL_DELADDRESS, 
                src:"ORL_DISCPERC"::numeric(38, 10) AS ORL_DISCPERC, 
                src:"ORL_DUE"::datetime AS ORL_DUE, 
                src:"ORL_EVENT"::varchar AS ORL_EVENT, 
                src:"ORL_EXCH"::numeric(38, 10) AS ORL_EXCH, 
                src:"ORL_EXCHFIX"::varchar AS ORL_EXCHFIX, 
                src:"ORL_EXCHFROMDUAL"::numeric(38, 10) AS ORL_EXCHFROMDUAL, 
                src:"ORL_EXCHTODUAL"::numeric(38, 10) AS ORL_EXCHTODUAL, 
                src:"ORL_GLTRANSFER"::datetime AS ORL_GLTRANSFER, 
                src:"ORL_GLTRANSFERFLAG"::varchar AS ORL_GLTRANSFERFLAG, 
                src:"ORL_INSPECT"::varchar AS ORL_INSPECT, 
                src:"ORL_INTERFACE"::datetime AS ORL_INTERFACE, 
                src:"ORL_INVCALCTAXAMOUNT"::numeric(38, 10) AS ORL_INVCALCTAXAMOUNT, 
                src:"ORL_INVQTY"::numeric(38, 10) AS ORL_INVQTY, 
                src:"ORL_INVVALUE"::numeric(38, 10) AS ORL_INVVALUE, 
                src:"ORL_IPCURRPRICE"::varchar AS ORL_IPCURRPRICE, 
                src:"ORL_IPERROR"::numeric(38, 10) AS ORL_IPERROR, 
                src:"ORL_IPERRORMESSAGE"::varchar AS ORL_IPERRORMESSAGE, 
                src:"ORL_IPLASTUPDATE"::datetime AS ORL_IPLASTUPDATE, 
                src:"ORL_IPTRANSMITTED"::varchar AS ORL_IPTRANSMITTED, 
                src:"ORL_IPUPDATESTATUS"::varchar AS ORL_IPUPDATESTATUS, 
                src:"ORL_JECATEGORY"::varchar AS ORL_JECATEGORY, 
                src:"ORL_JESOURCE"::varchar AS ORL_JESOURCE, 
                src:"ORL_LASTSAVED"::datetime AS ORL_LASTSAVED,  
                src:"ORL_LASTSAVED"::datetime as ETL_LASTSAVED,
                src:"ORL_LONGDESCRIPTION"::varchar AS ORL_LONGDESCRIPTION, 
                src:"ORL_MANUFACTPART"::varchar AS ORL_MANUFACTPART, 
                src:"ORL_MANUFACTURER"::varchar AS ORL_MANUFACTURER, 
                src:"ORL_MULTIPLY"::numeric(38, 10) AS ORL_MULTIPLY, 
                src:"ORL_NOTE"::varchar AS ORL_NOTE, 
                src:"ORL_ORDER"::varchar AS ORL_ORDER, 
                src:"ORL_ORDER_ORG"::varchar AS ORL_ORDER_ORG, 
                src:"ORL_ORDLINE"::numeric(38, 10) AS ORL_ORDLINE, 
                src:"ORL_ORDQTY"::numeric(38, 10) AS ORL_ORDQTY, 
                src:"ORL_PACKAGETRACKINGNUMBER"::varchar AS ORL_PACKAGETRACKINGNUMBER, 
                src:"ORL_PART"::varchar AS ORL_PART, 
                src:"ORL_PART_ORG"::varchar AS ORL_PART_ORG, 
                src:"ORL_PAYMENTNUMBER"::numeric(38, 10) AS ORL_PAYMENTNUMBER, 
                src:"ORL_PRICE"::numeric(38, 10) AS ORL_PRICE, 
                src:"ORL_PROJBUD"::varchar AS ORL_PROJBUD, 
                src:"ORL_PROJECT"::varchar AS ORL_PROJECT, 
                src:"ORL_PURUOM"::varchar AS ORL_PURUOM, 
                src:"ORL_QUOTID"::varchar AS ORL_QUOTID, 
                src:"ORL_QUOTLINE"::numeric(38, 10) AS ORL_QUOTLINE, 
                src:"ORL_RECVQTY"::numeric(38, 10) AS ORL_RECVQTY, 
                src:"ORL_RECVTASKQTY"::numeric(38, 10) AS ORL_RECVTASKQTY, 
                src:"ORL_RECVVALUE"::numeric(38, 10) AS ORL_RECVVALUE, 
                src:"ORL_REF"::varchar AS ORL_REF, 
                src:"ORL_RELATEDWO"::varchar AS ORL_RELATEDWO, 
                src:"ORL_REQ"::varchar AS ORL_REQ, 
                src:"ORL_REQLINE"::numeric(38, 10) AS ORL_REQLINE, 
                src:"ORL_REVISED"::datetime AS ORL_REVISED, 
                src:"ORL_REVISION"::numeric(38, 10) AS ORL_REVISION, 
                src:"ORL_RSTATUS"::varchar AS ORL_RSTATUS, 
                src:"ORL_RTYPE"::varchar AS ORL_RTYPE, 
                src:"ORL_SCRAPQTY"::numeric(38, 10) AS ORL_SCRAPQTY, 
                src:"ORL_SOURCECODE"::varchar AS ORL_SOURCECODE, 
                src:"ORL_SOURCESYSTEM"::varchar AS ORL_SOURCESYSTEM, 
                src:"ORL_STATUS"::varchar AS ORL_STATUS, 
                src:"ORL_STORE"::varchar AS ORL_STORE, 
                src:"ORL_SUPPLIER"::varchar AS ORL_SUPPLIER, 
                src:"ORL_SUPPLIER_ORG"::varchar AS ORL_SUPPLIER_ORG, 
                src:"ORL_TASK"::varchar AS ORL_TASK, 
                src:"ORL_TASKQTY"::numeric(38, 10) AS ORL_TASKQTY, 
                src:"ORL_TASKREV"::numeric(38, 10) AS ORL_TASKREV, 
                src:"ORL_TAX"::varchar AS ORL_TAX, 
                src:"ORL_TAX2"::varchar AS ORL_TAX2, 
                src:"ORL_TOTEXTRA"::numeric(38, 10) AS ORL_TOTEXTRA, 
                src:"ORL_TOTTAXAMOUNT"::numeric(38, 10) AS ORL_TOTTAXAMOUNT, 
                src:"ORL_TRADE"::varchar AS ORL_TRADE, 
                src:"ORL_TYPE"::varchar AS ORL_TYPE, 
                src:"ORL_UDFCHAR01"::varchar AS ORL_UDFCHAR01, 
                src:"ORL_UDFCHAR02"::varchar AS ORL_UDFCHAR02, 
                src:"ORL_UDFCHAR03"::varchar AS ORL_UDFCHAR03, 
                src:"ORL_UDFCHAR04"::varchar AS ORL_UDFCHAR04, 
                src:"ORL_UDFCHAR05"::varchar AS ORL_UDFCHAR05, 
                src:"ORL_UDFCHAR06"::varchar AS ORL_UDFCHAR06, 
                src:"ORL_UDFCHAR07"::varchar AS ORL_UDFCHAR07, 
                src:"ORL_UDFCHAR08"::varchar AS ORL_UDFCHAR08, 
                src:"ORL_UDFCHAR09"::varchar AS ORL_UDFCHAR09, 
                src:"ORL_UDFCHAR10"::varchar AS ORL_UDFCHAR10, 
                src:"ORL_UDFCHAR11"::varchar AS ORL_UDFCHAR11, 
                src:"ORL_UDFCHAR12"::varchar AS ORL_UDFCHAR12, 
                src:"ORL_UDFCHAR13"::varchar AS ORL_UDFCHAR13, 
                src:"ORL_UDFCHAR14"::varchar AS ORL_UDFCHAR14, 
                src:"ORL_UDFCHAR15"::varchar AS ORL_UDFCHAR15, 
                src:"ORL_UDFCHAR16"::varchar AS ORL_UDFCHAR16, 
                src:"ORL_UDFCHAR17"::varchar AS ORL_UDFCHAR17, 
                src:"ORL_UDFCHAR18"::varchar AS ORL_UDFCHAR18, 
                src:"ORL_UDFCHAR19"::varchar AS ORL_UDFCHAR19, 
                src:"ORL_UDFCHAR20"::varchar AS ORL_UDFCHAR20, 
                src:"ORL_UDFCHAR21"::varchar AS ORL_UDFCHAR21, 
                src:"ORL_UDFCHAR22"::varchar AS ORL_UDFCHAR22, 
                src:"ORL_UDFCHAR23"::varchar AS ORL_UDFCHAR23, 
                src:"ORL_UDFCHAR24"::varchar AS ORL_UDFCHAR24, 
                src:"ORL_UDFCHAR25"::varchar AS ORL_UDFCHAR25, 
                src:"ORL_UDFCHAR26"::varchar AS ORL_UDFCHAR26, 
                src:"ORL_UDFCHAR27"::varchar AS ORL_UDFCHAR27, 
                src:"ORL_UDFCHAR28"::varchar AS ORL_UDFCHAR28, 
                src:"ORL_UDFCHAR29"::varchar AS ORL_UDFCHAR29, 
                src:"ORL_UDFCHAR30"::varchar AS ORL_UDFCHAR30, 
                src:"ORL_UDFCHKBOX01"::varchar AS ORL_UDFCHKBOX01, 
                src:"ORL_UDFCHKBOX02"::varchar AS ORL_UDFCHKBOX02, 
                src:"ORL_UDFCHKBOX03"::varchar AS ORL_UDFCHKBOX03, 
                src:"ORL_UDFCHKBOX04"::varchar AS ORL_UDFCHKBOX04, 
                src:"ORL_UDFCHKBOX05"::varchar AS ORL_UDFCHKBOX05, 
                src:"ORL_UDFDATE01"::datetime AS ORL_UDFDATE01, 
                src:"ORL_UDFDATE02"::datetime AS ORL_UDFDATE02, 
                src:"ORL_UDFDATE03"::datetime AS ORL_UDFDATE03, 
                src:"ORL_UDFDATE04"::datetime AS ORL_UDFDATE04, 
                src:"ORL_UDFDATE05"::datetime AS ORL_UDFDATE05, 
                src:"ORL_UDFNUM01"::numeric(38, 10) AS ORL_UDFNUM01, 
                src:"ORL_UDFNUM02"::numeric(38, 10) AS ORL_UDFNUM02, 
                src:"ORL_UDFNUM03"::numeric(38, 10) AS ORL_UDFNUM03, 
                src:"ORL_UDFNUM04"::numeric(38, 10) AS ORL_UDFNUM04, 
                src:"ORL_UDFNUM05"::numeric(38, 10) AS ORL_UDFNUM05, 
                src:"ORL_UNSPSCCODE"::varchar AS ORL_UNSPSCCODE, 
                src:"ORL_UPDATECOUNT"::numeric(38, 10) AS ORL_UPDATECOUNT, 
                src:"_DELETED"::boolean AS _DELETED, 
                src:"_DELETED"::BOOLEAN as ETL_DELETED, 
                etl_load_datetime,
                etl_load_metadatafilename
                FROM 
                (
                select 
                    src,
                    etl_load_datetime,
                    etl_load_metadatafilename
                    from
                    (
                        SELECT
     
                            
                src:"ORL_ORDER"::varchar,
                src:"ORL_ORDER_ORG"::varchar,
                src:"ORL_ORDLINE"::numeric(38, 10),
                src:"ORL_LASTSAVED"::datetime
                ,src,
                etl_load_datetime,
                etl_load_metadatafilename,
                ROW_NUMBER() OVER (PARTITION BY 
                                        
                src:"ORL_ORDER"::varchar,
                src:"ORL_ORDER_ORG"::varchar,
                src:"ORL_ORDLINE"::numeric(38, 10)  ORDER BY 
                src:"ORL_LASTSAVED"::datetime desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
                FROM DATAHUB_INTEGRATION.STREAM_EAM_R5ORDERLINES as strm

)
    WHERE
    ROWNUMBER=1)
                ; 