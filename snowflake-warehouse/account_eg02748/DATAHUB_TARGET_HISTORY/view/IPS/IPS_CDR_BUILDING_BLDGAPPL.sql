CREATE OR REPLACE VIEW DATAHUB_TARGET_HISTORY.IPS_CDR_BUILDING_BLDGAPPL AS 
    SELECT 
        ACTLVLTN, 
        ADDBY, 
        ADDDTTM, 
        ADDRKEY, 
        APBLDGBATCHKEY, 
        APBLDGDEFNKEY, 
        APBLDGKEY, 
        APBLDGPROCESSSTATEKEY, 
        APBY, 
        APDTTM, 
        APKEY, 
        APMODELPROJKEY, 
        APNAME, 
        APNO, 
        BLDGAPPLSTATUS, 
        BLDGAREA, 
        BLDGFLOOR, 
        BLDGROOM, 
        CALCVLTN, 
        CAPACITY, 
        COMPKEY, 
        COOBY, 
        COODTTM, 
        DATALAKE_DELETED, 
        DECLVLTN, 
        EXPDTTM, 
        FINBY, 
        FINDTTM, 
        GROUPKEY, 
        ISSBY, 
        ISSDTTM, 
        LINEARFROMFT, 
        LINEARFROMM, 
        LINEARTOFT, 
        LINEARTOM, 
        LOC, 
        LOCNOTES, 
        LSTACTDTTM, 
        MODBY, 
        MODDTTM, 
        NOPAGES, 
        NOPLANS, 
        OCCUPANCYTYPE, 
        PLANREV, 
        PRCLKEY, 
        PRI, 
        PROPERTYCONVEYANCE, 
        PROPERTYCRANEDERRICK, 
        PROPERTYEQUIPMENT, 
        PROPERTYFACADE, 
        PROPERTYMATERIAL, 
        PROPERTYVESSEL, 
        PROPKEY, 
        PROPOCCUPKEY, 
        STAT, 
        TMPCOOBY, 
        TMPCOODTTM, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        WORKTYPE, 
        XCOORDINATE, 
        YCOORDINATE, 
        ZCOORDINATE, 
        ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET_HISTORY.IPS_DELETED_CDR_BUILDING_BLDGAPPL
    UNION ALL 
    SELECT 
        ACTLVLTN, 
        ADDBY, 
        ADDDTTM, 
        ADDRKEY, 
        APBLDGBATCHKEY, 
        APBLDGDEFNKEY, 
        APBLDGKEY, 
        APBLDGPROCESSSTATEKEY, 
        APBY, 
        APDTTM, 
        APKEY, 
        APMODELPROJKEY, 
        APNAME, 
        APNO, 
        BLDGAPPLSTATUS, 
        BLDGAREA, 
        BLDGFLOOR, 
        BLDGROOM, 
        CALCVLTN, 
        CAPACITY, 
        COMPKEY, 
        COOBY, 
        COODTTM, 
        DATALAKE_DELETED, 
        DECLVLTN, 
        EXPDTTM, 
        FINBY, 
        FINDTTM, 
        GROUPKEY, 
        ISSBY, 
        ISSDTTM, 
        LINEARFROMFT, 
        LINEARFROMM, 
        LINEARTOFT, 
        LINEARTOM, 
        LOC, 
        LOCNOTES, 
        LSTACTDTTM, 
        MODBY, 
        MODDTTM, 
        NOPAGES, 
        NOPLANS, 
        OCCUPANCYTYPE, 
        PLANREV, 
        PRCLKEY, 
        PRI, 
        PROPERTYCONVEYANCE, 
        PROPERTYCRANEDERRICK, 
        PROPERTYEQUIPMENT, 
        PROPERTYFACADE, 
        PROPERTYMATERIAL, 
        PROPERTYVESSEL, 
        PROPKEY, 
        PROPOCCUPKEY, 
        STAT, 
        TMPCOOBY, 
        TMPCOODTTM, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        WORKTYPE, 
        XCOORDINATE, 
        YCOORDINATE, 
        ZCOORDINATE, 
        FALSE AS ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET.IPS_CDR_BUILDING_BLDGAPPL;