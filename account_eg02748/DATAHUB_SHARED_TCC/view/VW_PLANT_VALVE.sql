CREATE OR REPLACE VIEW DATAHUB_SHARED_TCC.VW_PLANT_VALVE
AS
SELECT 
 A1."ACQTYPE"::VARCHAR(10) AS "Acquistion Type"
, A3."ADDRKEY"::NUMBER(38) AS "Address"
, A2."UNITID"::VARCHAR(50) AS "Asset ID"
, A2."COMPKEY"::NUMBER(38) AS "CompKey"
, A1."COSTCENTRE"::VARCHAR(10) AS "Cost Centre Code"
, 'TBD'::VARCHAR(3) AS "Cost Centre Description"
, A1."CRITICALITY"::VARCHAR(10) AS "Criticality Code"
, 'TBD'::VARCHAR(3) AS "Criticality Description"
, A2."DPTH"::FLOAT AS "Depth"
, A2."UNITDESC"::VARCHAR(300) AS "Description"
, A2."DIAM"::FLOAT AS "Diameter"
, A1."FORDISPOSAL"::VARCHAR(10) AS "Disposal Reason"
, A1."DRAWINGNO"::VARCHAR(30) AS "Drawing No"
, A1."DRAWINGNOREF"::VARCHAR(30) AS "Drawing No Ref"
, A2."AGENCYCHARACTER1"::VARCHAR(50) AS "Equipment No"
, A3."EXPDATE"::TIMESTAMP_NTZ(9) AS "Expire Date"
, A2."AREA"::VARCHAR(10) AS "Facility Code"
, 'TBD'::VARCHAR(3) AS "Facility Description"
, A2."HT"::FLOAT AS "Height"
, A2."INSTDATE"::TIMESTAMP_NTZ(9) AS "Installed"
, A2."ASBLT"::VARCHAR(10) AS "Legacy Key"
, A2."LEN"::FLOAT AS "Length"
, A2."MATL"::VARCHAR(10) AS "Material Code"
, 'TBD'::VARCHAR(3) AS "Material Description"
, A1."MODELNO"::VARCHAR(30) AS "Model #"
, 'TBD'::VARCHAR(3) AS "Operations Area"
, A2."OWN"::VARCHAR(10) AS "Ownership Code"
, 'TBD'::VARCHAR(3) AS "Ownership Description"
, A3."MAPNO"::VARCHAR(14) AS "Position"
, A2."SUBAREA"::VARCHAR(10) AS "Process Code"
, 'TBD'::VARCHAR(3) AS "Process Description"
, 'TBD'::VARCHAR(3) AS "Process Type"
, A1."SAFETYCRITICAL"::VARCHAR(1) AS "Safety Critical Element"
, A2."SERVSTAT"::VARCHAR(10) AS "Service Status"
, A2."LOC"::VARCHAR(10) AS "Set Code"
, 'TBD'::VARCHAR(3) AS "Set Description"
, A2."DISTRICT"::VARCHAR(10) AS "System Code"
, 'TBD'::VARCHAR(3) AS "System Description"
, A2."UNITTYPE"::VARCHAR(10) AS "Unit Type Code"
, 'TBD'::VARCHAR(3) AS "Unit Type Description"
, A2."WT"::FLOAT AS "Weight"
, A2."WID"::FLOAT AS "Width"
, ad."NZHOUSENO"::VARCHAR(10) AS "Street Number"
, CONCAT(ad."NZSTNAME",' ',ad."NZSTTYPE")::VARCHAR(33) AS "Street Name"
, ad."NZSUBURB"::VARCHAR(30) AS "City"
, ad."NZPOSTCODE"::VARCHAR(5) AS "Postal Code"
, A1.MAKE::VARCHAR(10) AS "Make"
, A2.SERNO::VARCHAR(20) AS "Serial Number"
, A1.ZONECATCHMENT::VARCHAR(10) AS "Water Zone/Sewer Catchment"
, XVALVE.FOBFP::VARCHAR(1) AS "Functional Output Backflow Preventer"
, XVALVE.FOBURSTCONTROL::VARCHAR(1) AS "Functional Output Burst Control"
, XVALVE.FOBYPASS::VARCHAR(1) AS "Functional Output Bypass"
, XVALVE.FODISCHARGE::VARCHAR(1) AS "Functional Output Draindown Discharge"
, XVALVE.FOFIREFIGHTING::VARCHAR(1) AS "Functional Output Firefighting"
, XVALVE.FOFLOWCONTROL::VARCHAR(1) AS "Functional Output Flow Control"
, XVALVE.FOFLOWDIRECTION::VARCHAR(1) AS "Functional Output Flow Direction"
, XVALVE.FOISOLATION::VARCHAR(1) AS "Functional Output Isolation"
, XVALVE.FOLEVELCONTROL::VARCHAR(1) AS "Functional Output Level Control"
, XVALVE.FOPRESSRED::VARCHAR(1) AS "Functional Output Pressure Reducing"
, XVALVE.FOPRESSRLF::VARCHAR(1) AS "Functional Output Pressure Relief"
, XVALVE.FOPRESSSSTN::VARCHAR(1) AS "Functional Output Pressure Sustaining"
, XVALVE.FOREGULATING::VARCHAR(1) AS "Functional Output Regulating"
, XVALVE.FOSCOUR::VARCHAR(1) AS "Functional Output Scour"
, XVALVE.FOSURGE::VARCHAR(1) AS "Functional Output Surge Protection"
, XVALVE.FOVACB::VARCHAR(1) AS "Functional Output Vacuum Break"
, XVALVE.PRESSURERATING::FLOAT AS "Pressure Rating (kPa)"
, XVALVE.SUBTYPEFEATURES::VARCHAR(10) AS "SubType Features"
, A1.WARRANTYEND::TIMESTAMP_NTZ(9) AS "Warranty End Date"
, A1.WARRANTYSTART::TIMESTAMP_NTZ(9) AS "Warranty Start Date"
, XVALVE.EXTCOAT::VARCHAR(10) AS "External Coating"
, XVALVE.FUNCAREA::VARCHAR(10) AS "Functional Area"
, XVALVE.HAZARDRATING::VARCHAR(10) AS "Hazardous Rating"
, XVALVE.IPRATING::VARCHAR(10) AS "Ingress Protection Rating"
, XVALVE.INSTALLMOUNT::VARCHAR(1) AS "Installation Mounting"
, XVALVE.INTLINING::VARCHAR(10) AS "Internal Lining"
, XVALVE.JTTYPE::VARCHAR(10) AS "Joint Method"
, XVALVE.LOCALITY::VARCHAR(10) AS "Locality"
, XVALVE.MAXFLOW::FLOAT AS "Maximum Flow"
, XVALVE.MINFLOW::FLOAT AS "Minimum Flow"
, XVALVE.MEDIATYPE::VARCHAR(10) AS "Media Type"
, XVALVE.PHOTO3D::VARCHAR(300) AS "Photo/3D Model"
, XVALVE.RESIDUALPRESSURE::FLOAT AS "Residual Pressure (kPa)"
, XVALVE.TORQUE::FLOAT AS "Torque Input Rating"
FROM
 "DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_AGENCYDEFINED_COMPAGENCYSIMPLE" AS A2
 INNER JOIN "DATAHUB_TARGET"."IPS_WSLASSETS_XALLASSETSDP01" AS A1 ON A2.COMPKEY = A1.COMPKEY AND A1.BUSINESSAREA = 'TCC'
 INNER JOIN "DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_COMP" AS A3 on A3.COMPKEY = A1.COMPKEY
 INNER JOIN "DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_COMPTYPE" AS A4 on A4.COMPTYPE = A3.COMPTYPE
 LEFT OUTER JOIN "DATAHUB_TARGET"."IPS_PROPERTY_ADDRESS" AS ad ON ad.ADDRKEY = A3.ADDRKEY AND ad.OPTA = 'TCC'
 LEFT OUTER JOIN DATAHUB_TARGET.IPS_WSLASSETSCONFIGURED_XVALVE AS XVALVE ON A2.COMPKEY = XVALVE.COMPKEY 
 WHERE A4.COMPCODE = 'VALV';