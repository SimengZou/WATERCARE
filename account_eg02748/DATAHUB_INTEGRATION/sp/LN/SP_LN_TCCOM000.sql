create or replace procedure DATAHUB_INTEGRATION.SP_LN_TCCOM000()
    returns varchar not null
                language javascript
                as
                $$

//  Variables

var result = "";                                    // return status of this proc call
const process_name = Object.keys(this)[0];          // name of currently executing process
var number_of_rows_inserted = 0;                             // track number of rows we have inserted
var number_of_rows_updated = 0;                             // track number of rows we have updated


//  Step 1.

//  Start execution - log start

log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('Insert','" + process_name + "','Running','Started process execution.', 0,0,0);";
snowflake.execute({sqlText: log_sql_command});

snowflake.execute( {sqlText: "begin transaction;"} );
try
    {
        var sql_command = `
                            INSERT INTO LANDING_ERROR.LN_RAW_ERROR
                            SELECT * FROM LANDING_ERROR.VW_STREAM_LN_TCCOM000_ERROR`;
    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();
        
        var sql_command = ` 
                            merge into  TARGET_LN.LN_TCCOM000 as target using (SELECT * FROM (SELECT 
            strm.acfg, 
            strm.acfg_kw, 
            strm.adcc, 
            strm.adcc_kw, 
            strm.alhp, 
            strm.alhp_kw, 
            strm.altm, 
            strm.altm_kw, 
            strm.arcc, 
            strm.arcc_kw, 
            strm.ardc, 
            strm.asci, 
            strm.asci_kw, 
            strm.asec, 
            strm.asec_kw, 
            strm.bape, 
            strm.bape_kw, 
            strm.bcmi, 
            strm.bcmi_kw, 
            strm.beid, 
            strm.bgci, 
            strm.bgci_kw, 
            strm.bulg, 
            strm.bulg_kw, 
            strm.cadr, 
            strm.cadr_ref_compnr, 
            strm.capp, 
            strm.capp_kw, 
            strm.cbrk, 
            strm.cbrk_kw, 
            strm.cbrn, 
            strm.cbtp, 
            strm.ccty, 
            strm.ccty_ref_compnr, 
            strm.cfbs, 
            strm.cfbs_kw, 
            strm.cfri, 
            strm.cfri_kw, 
            strm.cinv, 
            strm.cinv_kw, 
            strm.clan, 
            strm.clan_ref_compnr, 
            strm.clbi, 
            strm.clbi_kw, 
            strm.cmai, 
            strm.compnr, 
            strm.corg, 
            strm.corg_kw, 
            strm.cpli, 
            strm.cpli_kw, 
            strm.crid, 
            strm.csli, 
            strm.csli_kw, 
            strm.darc, 
            strm.dasr, 
            strm.dasr_kw, 
            strm.deleted, 
            strm.deln, 
            strm.deln_kw, 
            strm.dsca, 
            strm.dsri, 
            strm.dsri_kw, 
            strm.duns, 
            strm.eaas, 
            strm.eaas_kw, 
            strm.ecmi, 
            strm.ecmi_kw, 
            strm.erac, 
            strm.erac_kw, 
            strm.eupl, 
            strm.eupl_kw, 
            strm.eusl, 
            strm.eusl_kw, 
            strm.eust, 
            strm.eust_kw, 
            strm.ffpl, 
            strm.ffpl_kw, 
            strm.fidn, 
            strm.fini, 
            strm.fini_kw, 
            strm.fovn, 
            strm.frmi, 
            strm.frmi_kw, 
            strm.fstk, 
            strm.fstk_kw, 
            strm.grpl, 
            strm.grpl_kw, 
            strm.gtci, 
            strm.gtci_kw, 
            strm.gtro, 
            strm.gtro_kw, 
            strm.hcst, 
            strm.hcst_kw, 
            strm.ilwh, 
            strm.ilwh_kw, 
            strm.indt, 
            strm.inf1, 
            strm.inf2, 
            strm.inf3, 
            strm.inf4, 
            strm.inpr, 
            strm.inpr_kw, 
            strm.intr, 
            strm.intr_kw, 
            strm.itpd, 
            strm.itpd_kw, 
            strm.itri, 
            strm.itri_kw, 
            strm.jspm, 
            strm.jspm_kw, 
            strm.lago, 
            strm.lago_kw, 
            strm.larg, 
            strm.larg_kw, 
            strm.lbra, 
            strm.lbra_kw, 
            strm.lche, 
            strm.lche_kw, 
            strm.lchl, 
            strm.lchl_kw, 
            strm.lchn, 
            strm.lchn_kw, 
            strm.lcol, 
            strm.lcol_kw, 
            strm.lcsi, 
            strm.lcsi_kw, 
            strm.lcze, 
            strm.lcze_kw, 
            strm.ldeu, 
            strm.ldeu_kw, 
            strm.lesp, 
            strm.lesp_kw, 
            strm.lgbr, 
            strm.lgbr_kw, 
            strm.lgid, 
            strm.lhrv, 
            strm.lhrv_kw, 
            strm.lhun, 
            strm.lhun_kw, 
            strm.lidn, 
            strm.lidn_kw, 
            strm.lind, 
            strm.lind_kw, 
            strm.lisr, 
            strm.lisr_kw, 
            strm.lita, 
            strm.lita_kw, 
            strm.lmex, 
            strm.lmex_kw, 
            strm.lmys, 
            strm.lmys_kw, 
            strm.lnor, 
            strm.lnor_kw, 
            strm.lnwi, 
            strm.lnwi_kw, 
            strm.lper, 
            strm.lper_kw, 
            strm.lphl, 
            strm.lphl_kw, 
            strm.lpol, 
            strm.lpol_kw, 
            strm.lpor, 
            strm.lpor_kw, 
            strm.lrom, 
            strm.lrom_kw, 
            strm.lrus, 
            strm.lrus_kw, 
            strm.lsau, 
            strm.lsau_kw, 
            strm.lsrb, 
            strm.lsrb_kw, 
            strm.lsvk, 
            strm.lsvk_kw, 
            strm.lsvn, 
            strm.lsvn_kw, 
            strm.ltha, 
            strm.ltha_kw, 
            strm.ltur, 
            strm.ltur_kw, 
            strm.lvnm, 
            strm.lvnm_kw, 
            strm.mejs, 
            strm.mejs_kw, 
            strm.mesa, 
            strm.mesa_kw, 
            strm.mfsi, 
            strm.mfsi_kw, 
            strm.mnfc, 
            strm.mnfc_kw, 
            strm.mpni, 
            strm.mpni_kw, 
            strm.mprs, 
            strm.mprs_kw, 
            strm.mstc, 
            strm.mstc_kw, 
            strm.nama, 
            strm.ncmp, 
            strm.odmu, 
            strm.odmu_kw, 
            strm.opsi, 
            strm.opsi_kw, 
            strm.owne, 
            strm.owne_kw, 
            strm.owni, 
            strm.owni_kw, 
            strm.pcfi, 
            strm.pcfi_kw, 
            strm.pcmd, 
            strm.pcmd_kw, 
            strm.pcsi, 
            strm.pcsi_kw, 
            strm.pdim, 
            strm.pdim_kw, 
            strm.pedi, 
            strm.pedi_kw, 
            strm.plai, 
            strm.plai_kw, 
            strm.plma, 
            strm.plma_kw, 
            strm.plnp, 
            strm.plnp_kw, 
            strm.ppeg, 
            strm.ppeg_kw, 
            strm.prci, 
            strm.prci_kw, 
            strm.prji, 
            strm.prji_kw, 
            strm.psch, 
            strm.psch_kw, 
            strm.ptri, 
            strm.ptri_kw, 
            strm.qumi, 
            strm.qumi_kw, 
            strm.rdes, 
            strm.rdes_kw, 
            strm.repr, 
            strm.rpti, 
            strm.rpti_kw, 
            strm.rsbs, 
            strm.rsbs_kw, 
            strm.scbs, 
            strm.scbs_kw, 
            strm.schi, 
            strm.schi_kw, 
            strm.sequencenumber, 
            strm.siac, 
            strm.simd, 
            strm.simd_kw, 
            strm.slbp, 
            strm.slbp_kw, 
            strm.slbs, 
            strm.slbs_kw, 
            strm.smfm, 
            strm.smfm_kw, 
            strm.smfs, 
            strm.smfs_kw, 
            strm.smii, 
            strm.smii_kw, 
            strm.spri, 
            strm.spri_kw, 
            strm.spsp, 
            strm.spsp_kw, 
            strm.srvi, 
            strm.srvi_kw, 
            strm.ssmf, 
            strm.ssmf_kw, 
            strm.stat, 
            strm.stat_kw, 
            strm.stbi, 
            strm.stbi_kw, 
            strm.tati, 
            strm.tati_kw, 
            strm.taxd, 
            strm.taxd_kw, 
            strm.timestamp, 
            strm.tlgi, 
            strm.tlgi_kw, 
            strm.trcn, 
            strm.trcn_kw, 
            strm.ucpu, 
            strm.ucpu_kw, 
            strm.ucsl, 
            strm.ucsl_kw, 
            strm.unef, 
            strm.unef_kw, 
            strm.username, 
            strm.usup, 
            strm.usup_kw, 
            strm.uwht, 
            strm.uwht_kw, 
            strm.vmic, 
            strm.vmic_kw, 
            strm.vmis, 
            strm.vmis_kw, 
            strm.wmbi, 
            strm.wmbi_kw, 
            strm.wrhi, 
            strm.wrhi_kw, 
            strm.xtmm, 
            strm.xtmm_kw, 
            strm.ETL_SEQUENCE_NUMBER,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.compnr,
            strm.indt,
            strm.ncmp ORDER BY strm.ETL_SEQUENCE_NUMBER desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_LN_TCCOM000 as  strm
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.compnr=src.compnr) OR (target.compnr IS NULL AND src.compnr IS NULL)) AND
            ((target.indt=src.indt) OR (target.indt IS NULL AND src.indt IS NULL)) AND
            ((target.ncmp=src.ncmp) OR (target.ncmp IS NULL AND src.ncmp IS NULL)) 
                when matched and src.ETL_DELETED=TRUE THEN DELETE
                when matched then update set
                    target.acfg=src.acfg, 
                    target.acfg_kw=src.acfg_kw, 
                    target.adcc=src.adcc, 
                    target.adcc_kw=src.adcc_kw, 
                    target.alhp=src.alhp, 
                    target.alhp_kw=src.alhp_kw, 
                    target.altm=src.altm, 
                    target.altm_kw=src.altm_kw, 
                    target.arcc=src.arcc, 
                    target.arcc_kw=src.arcc_kw, 
                    target.ardc=src.ardc, 
                    target.asci=src.asci, 
                    target.asci_kw=src.asci_kw, 
                    target.asec=src.asec, 
                    target.asec_kw=src.asec_kw, 
                    target.bape=src.bape, 
                    target.bape_kw=src.bape_kw, 
                    target.bcmi=src.bcmi, 
                    target.bcmi_kw=src.bcmi_kw, 
                    target.beid=src.beid, 
                    target.bgci=src.bgci, 
                    target.bgci_kw=src.bgci_kw, 
                    target.bulg=src.bulg, 
                    target.bulg_kw=src.bulg_kw, 
                    target.cadr=src.cadr, 
                    target.cadr_ref_compnr=src.cadr_ref_compnr, 
                    target.capp=src.capp, 
                    target.capp_kw=src.capp_kw, 
                    target.cbrk=src.cbrk, 
                    target.cbrk_kw=src.cbrk_kw, 
                    target.cbrn=src.cbrn, 
                    target.cbtp=src.cbtp, 
                    target.ccty=src.ccty, 
                    target.ccty_ref_compnr=src.ccty_ref_compnr, 
                    target.cfbs=src.cfbs, 
                    target.cfbs_kw=src.cfbs_kw, 
                    target.cfri=src.cfri, 
                    target.cfri_kw=src.cfri_kw, 
                    target.cinv=src.cinv, 
                    target.cinv_kw=src.cinv_kw, 
                    target.clan=src.clan, 
                    target.clan_ref_compnr=src.clan_ref_compnr, 
                    target.clbi=src.clbi, 
                    target.clbi_kw=src.clbi_kw, 
                    target.cmai=src.cmai, 
                    target.compnr=src.compnr, 
                    target.corg=src.corg, 
                    target.corg_kw=src.corg_kw, 
                    target.cpli=src.cpli, 
                    target.cpli_kw=src.cpli_kw, 
                    target.crid=src.crid, 
                    target.csli=src.csli, 
                    target.csli_kw=src.csli_kw, 
                    target.darc=src.darc, 
                    target.dasr=src.dasr, 
                    target.dasr_kw=src.dasr_kw, 
                    target.deleted=src.deleted, 
                    target.deln=src.deln, 
                    target.deln_kw=src.deln_kw, 
                    target.dsca=src.dsca, 
                    target.dsri=src.dsri, 
                    target.dsri_kw=src.dsri_kw, 
                    target.duns=src.duns, 
                    target.eaas=src.eaas, 
                    target.eaas_kw=src.eaas_kw, 
                    target.ecmi=src.ecmi, 
                    target.ecmi_kw=src.ecmi_kw, 
                    target.erac=src.erac, 
                    target.erac_kw=src.erac_kw, 
                    target.eupl=src.eupl, 
                    target.eupl_kw=src.eupl_kw, 
                    target.eusl=src.eusl, 
                    target.eusl_kw=src.eusl_kw, 
                    target.eust=src.eust, 
                    target.eust_kw=src.eust_kw, 
                    target.ffpl=src.ffpl, 
                    target.ffpl_kw=src.ffpl_kw, 
                    target.fidn=src.fidn, 
                    target.fini=src.fini, 
                    target.fini_kw=src.fini_kw, 
                    target.fovn=src.fovn, 
                    target.frmi=src.frmi, 
                    target.frmi_kw=src.frmi_kw, 
                    target.fstk=src.fstk, 
                    target.fstk_kw=src.fstk_kw, 
                    target.grpl=src.grpl, 
                    target.grpl_kw=src.grpl_kw, 
                    target.gtci=src.gtci, 
                    target.gtci_kw=src.gtci_kw, 
                    target.gtro=src.gtro, 
                    target.gtro_kw=src.gtro_kw, 
                    target.hcst=src.hcst, 
                    target.hcst_kw=src.hcst_kw, 
                    target.ilwh=src.ilwh, 
                    target.ilwh_kw=src.ilwh_kw, 
                    target.indt=src.indt, 
                    target.inf1=src.inf1, 
                    target.inf2=src.inf2, 
                    target.inf3=src.inf3, 
                    target.inf4=src.inf4, 
                    target.inpr=src.inpr, 
                    target.inpr_kw=src.inpr_kw, 
                    target.intr=src.intr, 
                    target.intr_kw=src.intr_kw, 
                    target.itpd=src.itpd, 
                    target.itpd_kw=src.itpd_kw, 
                    target.itri=src.itri, 
                    target.itri_kw=src.itri_kw, 
                    target.jspm=src.jspm, 
                    target.jspm_kw=src.jspm_kw, 
                    target.lago=src.lago, 
                    target.lago_kw=src.lago_kw, 
                    target.larg=src.larg, 
                    target.larg_kw=src.larg_kw, 
                    target.lbra=src.lbra, 
                    target.lbra_kw=src.lbra_kw, 
                    target.lche=src.lche, 
                    target.lche_kw=src.lche_kw, 
                    target.lchl=src.lchl, 
                    target.lchl_kw=src.lchl_kw, 
                    target.lchn=src.lchn, 
                    target.lchn_kw=src.lchn_kw, 
                    target.lcol=src.lcol, 
                    target.lcol_kw=src.lcol_kw, 
                    target.lcsi=src.lcsi, 
                    target.lcsi_kw=src.lcsi_kw, 
                    target.lcze=src.lcze, 
                    target.lcze_kw=src.lcze_kw, 
                    target.ldeu=src.ldeu, 
                    target.ldeu_kw=src.ldeu_kw, 
                    target.lesp=src.lesp, 
                    target.lesp_kw=src.lesp_kw, 
                    target.lgbr=src.lgbr, 
                    target.lgbr_kw=src.lgbr_kw, 
                    target.lgid=src.lgid, 
                    target.lhrv=src.lhrv, 
                    target.lhrv_kw=src.lhrv_kw, 
                    target.lhun=src.lhun, 
                    target.lhun_kw=src.lhun_kw, 
                    target.lidn=src.lidn, 
                    target.lidn_kw=src.lidn_kw, 
                    target.lind=src.lind, 
                    target.lind_kw=src.lind_kw, 
                    target.lisr=src.lisr, 
                    target.lisr_kw=src.lisr_kw, 
                    target.lita=src.lita, 
                    target.lita_kw=src.lita_kw, 
                    target.lmex=src.lmex, 
                    target.lmex_kw=src.lmex_kw, 
                    target.lmys=src.lmys, 
                    target.lmys_kw=src.lmys_kw, 
                    target.lnor=src.lnor, 
                    target.lnor_kw=src.lnor_kw, 
                    target.lnwi=src.lnwi, 
                    target.lnwi_kw=src.lnwi_kw, 
                    target.lper=src.lper, 
                    target.lper_kw=src.lper_kw, 
                    target.lphl=src.lphl, 
                    target.lphl_kw=src.lphl_kw, 
                    target.lpol=src.lpol, 
                    target.lpol_kw=src.lpol_kw, 
                    target.lpor=src.lpor, 
                    target.lpor_kw=src.lpor_kw, 
                    target.lrom=src.lrom, 
                    target.lrom_kw=src.lrom_kw, 
                    target.lrus=src.lrus, 
                    target.lrus_kw=src.lrus_kw, 
                    target.lsau=src.lsau, 
                    target.lsau_kw=src.lsau_kw, 
                    target.lsrb=src.lsrb, 
                    target.lsrb_kw=src.lsrb_kw, 
                    target.lsvk=src.lsvk, 
                    target.lsvk_kw=src.lsvk_kw, 
                    target.lsvn=src.lsvn, 
                    target.lsvn_kw=src.lsvn_kw, 
                    target.ltha=src.ltha, 
                    target.ltha_kw=src.ltha_kw, 
                    target.ltur=src.ltur, 
                    target.ltur_kw=src.ltur_kw, 
                    target.lvnm=src.lvnm, 
                    target.lvnm_kw=src.lvnm_kw, 
                    target.mejs=src.mejs, 
                    target.mejs_kw=src.mejs_kw, 
                    target.mesa=src.mesa, 
                    target.mesa_kw=src.mesa_kw, 
                    target.mfsi=src.mfsi, 
                    target.mfsi_kw=src.mfsi_kw, 
                    target.mnfc=src.mnfc, 
                    target.mnfc_kw=src.mnfc_kw, 
                    target.mpni=src.mpni, 
                    target.mpni_kw=src.mpni_kw, 
                    target.mprs=src.mprs, 
                    target.mprs_kw=src.mprs_kw, 
                    target.mstc=src.mstc, 
                    target.mstc_kw=src.mstc_kw, 
                    target.nama=src.nama, 
                    target.ncmp=src.ncmp, 
                    target.odmu=src.odmu, 
                    target.odmu_kw=src.odmu_kw, 
                    target.opsi=src.opsi, 
                    target.opsi_kw=src.opsi_kw, 
                    target.owne=src.owne, 
                    target.owne_kw=src.owne_kw, 
                    target.owni=src.owni, 
                    target.owni_kw=src.owni_kw, 
                    target.pcfi=src.pcfi, 
                    target.pcfi_kw=src.pcfi_kw, 
                    target.pcmd=src.pcmd, 
                    target.pcmd_kw=src.pcmd_kw, 
                    target.pcsi=src.pcsi, 
                    target.pcsi_kw=src.pcsi_kw, 
                    target.pdim=src.pdim, 
                    target.pdim_kw=src.pdim_kw, 
                    target.pedi=src.pedi, 
                    target.pedi_kw=src.pedi_kw, 
                    target.plai=src.plai, 
                    target.plai_kw=src.plai_kw, 
                    target.plma=src.plma, 
                    target.plma_kw=src.plma_kw, 
                    target.plnp=src.plnp, 
                    target.plnp_kw=src.plnp_kw, 
                    target.ppeg=src.ppeg, 
                    target.ppeg_kw=src.ppeg_kw, 
                    target.prci=src.prci, 
                    target.prci_kw=src.prci_kw, 
                    target.prji=src.prji, 
                    target.prji_kw=src.prji_kw, 
                    target.psch=src.psch, 
                    target.psch_kw=src.psch_kw, 
                    target.ptri=src.ptri, 
                    target.ptri_kw=src.ptri_kw, 
                    target.qumi=src.qumi, 
                    target.qumi_kw=src.qumi_kw, 
                    target.rdes=src.rdes, 
                    target.rdes_kw=src.rdes_kw, 
                    target.repr=src.repr, 
                    target.rpti=src.rpti, 
                    target.rpti_kw=src.rpti_kw, 
                    target.rsbs=src.rsbs, 
                    target.rsbs_kw=src.rsbs_kw, 
                    target.scbs=src.scbs, 
                    target.scbs_kw=src.scbs_kw, 
                    target.schi=src.schi, 
                    target.schi_kw=src.schi_kw, 
                    target.sequencenumber=src.sequencenumber, 
                    target.siac=src.siac, 
                    target.simd=src.simd, 
                    target.simd_kw=src.simd_kw, 
                    target.slbp=src.slbp, 
                    target.slbp_kw=src.slbp_kw, 
                    target.slbs=src.slbs, 
                    target.slbs_kw=src.slbs_kw, 
                    target.smfm=src.smfm, 
                    target.smfm_kw=src.smfm_kw, 
                    target.smfs=src.smfs, 
                    target.smfs_kw=src.smfs_kw, 
                    target.smii=src.smii, 
                    target.smii_kw=src.smii_kw, 
                    target.spri=src.spri, 
                    target.spri_kw=src.spri_kw, 
                    target.spsp=src.spsp, 
                    target.spsp_kw=src.spsp_kw, 
                    target.srvi=src.srvi, 
                    target.srvi_kw=src.srvi_kw, 
                    target.ssmf=src.ssmf, 
                    target.ssmf_kw=src.ssmf_kw, 
                    target.stat=src.stat, 
                    target.stat_kw=src.stat_kw, 
                    target.stbi=src.stbi, 
                    target.stbi_kw=src.stbi_kw, 
                    target.tati=src.tati, 
                    target.tati_kw=src.tati_kw, 
                    target.taxd=src.taxd, 
                    target.taxd_kw=src.taxd_kw, 
                    target.timestamp=src.timestamp, 
                    target.tlgi=src.tlgi, 
                    target.tlgi_kw=src.tlgi_kw, 
                    target.trcn=src.trcn, 
                    target.trcn_kw=src.trcn_kw, 
                    target.ucpu=src.ucpu, 
                    target.ucpu_kw=src.ucpu_kw, 
                    target.ucsl=src.ucsl, 
                    target.ucsl_kw=src.ucsl_kw, 
                    target.unef=src.unef, 
                    target.unef_kw=src.unef_kw, 
                    target.username=src.username, 
                    target.usup=src.usup, 
                    target.usup_kw=src.usup_kw, 
                    target.uwht=src.uwht, 
                    target.uwht_kw=src.uwht_kw, 
                    target.vmic=src.vmic, 
                    target.vmic_kw=src.vmic_kw, 
                    target.vmis=src.vmis, 
                    target.vmis_kw=src.vmis_kw, 
                    target.wmbi=src.wmbi, 
                    target.wmbi_kw=src.wmbi_kw, 
                    target.wrhi=src.wrhi, 
                    target.wrhi_kw=src.wrhi_kw, 
                    target.xtmm=src.xtmm, 
                    target.xtmm_kw=src.xtmm_kw, 
                    target.ETL_SEQUENCE_NUMBER=src.ETL_SEQUENCE_NUMBER,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename
        when not matched and (src.ETL_DELETED=FALSE OR src.ETL_DELETED IS NULL)  then insert ( 
                    acfg, 
                    acfg_kw, 
                    adcc, 
                    adcc_kw, 
                    alhp, 
                    alhp_kw, 
                    altm, 
                    altm_kw, 
                    arcc, 
                    arcc_kw, 
                    ardc, 
                    asci, 
                    asci_kw, 
                    asec, 
                    asec_kw, 
                    bape, 
                    bape_kw, 
                    bcmi, 
                    bcmi_kw, 
                    beid, 
                    bgci, 
                    bgci_kw, 
                    bulg, 
                    bulg_kw, 
                    cadr, 
                    cadr_ref_compnr, 
                    capp, 
                    capp_kw, 
                    cbrk, 
                    cbrk_kw, 
                    cbrn, 
                    cbtp, 
                    ccty, 
                    ccty_ref_compnr, 
                    cfbs, 
                    cfbs_kw, 
                    cfri, 
                    cfri_kw, 
                    cinv, 
                    cinv_kw, 
                    clan, 
                    clan_ref_compnr, 
                    clbi, 
                    clbi_kw, 
                    cmai, 
                    compnr, 
                    corg, 
                    corg_kw, 
                    cpli, 
                    cpli_kw, 
                    crid, 
                    csli, 
                    csli_kw, 
                    darc, 
                    dasr, 
                    dasr_kw, 
                    deleted, 
                    deln, 
                    deln_kw, 
                    dsca, 
                    dsri, 
                    dsri_kw, 
                    duns, 
                    eaas, 
                    eaas_kw, 
                    ecmi, 
                    ecmi_kw, 
                    erac, 
                    erac_kw, 
                    eupl, 
                    eupl_kw, 
                    eusl, 
                    eusl_kw, 
                    eust, 
                    eust_kw, 
                    ffpl, 
                    ffpl_kw, 
                    fidn, 
                    fini, 
                    fini_kw, 
                    fovn, 
                    frmi, 
                    frmi_kw, 
                    fstk, 
                    fstk_kw, 
                    grpl, 
                    grpl_kw, 
                    gtci, 
                    gtci_kw, 
                    gtro, 
                    gtro_kw, 
                    hcst, 
                    hcst_kw, 
                    ilwh, 
                    ilwh_kw, 
                    indt, 
                    inf1, 
                    inf2, 
                    inf3, 
                    inf4, 
                    inpr, 
                    inpr_kw, 
                    intr, 
                    intr_kw, 
                    itpd, 
                    itpd_kw, 
                    itri, 
                    itri_kw, 
                    jspm, 
                    jspm_kw, 
                    lago, 
                    lago_kw, 
                    larg, 
                    larg_kw, 
                    lbra, 
                    lbra_kw, 
                    lche, 
                    lche_kw, 
                    lchl, 
                    lchl_kw, 
                    lchn, 
                    lchn_kw, 
                    lcol, 
                    lcol_kw, 
                    lcsi, 
                    lcsi_kw, 
                    lcze, 
                    lcze_kw, 
                    ldeu, 
                    ldeu_kw, 
                    lesp, 
                    lesp_kw, 
                    lgbr, 
                    lgbr_kw, 
                    lgid, 
                    lhrv, 
                    lhrv_kw, 
                    lhun, 
                    lhun_kw, 
                    lidn, 
                    lidn_kw, 
                    lind, 
                    lind_kw, 
                    lisr, 
                    lisr_kw, 
                    lita, 
                    lita_kw, 
                    lmex, 
                    lmex_kw, 
                    lmys, 
                    lmys_kw, 
                    lnor, 
                    lnor_kw, 
                    lnwi, 
                    lnwi_kw, 
                    lper, 
                    lper_kw, 
                    lphl, 
                    lphl_kw, 
                    lpol, 
                    lpol_kw, 
                    lpor, 
                    lpor_kw, 
                    lrom, 
                    lrom_kw, 
                    lrus, 
                    lrus_kw, 
                    lsau, 
                    lsau_kw, 
                    lsrb, 
                    lsrb_kw, 
                    lsvk, 
                    lsvk_kw, 
                    lsvn, 
                    lsvn_kw, 
                    ltha, 
                    ltha_kw, 
                    ltur, 
                    ltur_kw, 
                    lvnm, 
                    lvnm_kw, 
                    mejs, 
                    mejs_kw, 
                    mesa, 
                    mesa_kw, 
                    mfsi, 
                    mfsi_kw, 
                    mnfc, 
                    mnfc_kw, 
                    mpni, 
                    mpni_kw, 
                    mprs, 
                    mprs_kw, 
                    mstc, 
                    mstc_kw, 
                    nama, 
                    ncmp, 
                    odmu, 
                    odmu_kw, 
                    opsi, 
                    opsi_kw, 
                    owne, 
                    owne_kw, 
                    owni, 
                    owni_kw, 
                    pcfi, 
                    pcfi_kw, 
                    pcmd, 
                    pcmd_kw, 
                    pcsi, 
                    pcsi_kw, 
                    pdim, 
                    pdim_kw, 
                    pedi, 
                    pedi_kw, 
                    plai, 
                    plai_kw, 
                    plma, 
                    plma_kw, 
                    plnp, 
                    plnp_kw, 
                    ppeg, 
                    ppeg_kw, 
                    prci, 
                    prci_kw, 
                    prji, 
                    prji_kw, 
                    psch, 
                    psch_kw, 
                    ptri, 
                    ptri_kw, 
                    qumi, 
                    qumi_kw, 
                    rdes, 
                    rdes_kw, 
                    repr, 
                    rpti, 
                    rpti_kw, 
                    rsbs, 
                    rsbs_kw, 
                    scbs, 
                    scbs_kw, 
                    schi, 
                    schi_kw, 
                    sequencenumber, 
                    siac, 
                    simd, 
                    simd_kw, 
                    slbp, 
                    slbp_kw, 
                    slbs, 
                    slbs_kw, 
                    smfm, 
                    smfm_kw, 
                    smfs, 
                    smfs_kw, 
                    smii, 
                    smii_kw, 
                    spri, 
                    spri_kw, 
                    spsp, 
                    spsp_kw, 
                    srvi, 
                    srvi_kw, 
                    ssmf, 
                    ssmf_kw, 
                    stat, 
                    stat_kw, 
                    stbi, 
                    stbi_kw, 
                    tati, 
                    tati_kw, 
                    taxd, 
                    taxd_kw, 
                    timestamp, 
                    tlgi, 
                    tlgi_kw, 
                    trcn, 
                    trcn_kw, 
                    ucpu, 
                    ucpu_kw, 
                    ucsl, 
                    ucsl_kw, 
                    unef, 
                    unef_kw, 
                    username, 
                    usup, 
                    usup_kw, 
                    uwht, 
                    uwht_kw, 
                    vmic, 
                    vmic_kw, 
                    vmis, 
                    vmis_kw, 
                    wmbi, 
                    wmbi_kw, 
                    wrhi, 
                    wrhi_kw, 
                    xtmm, 
                    xtmm_kw, 
                    ETL_SEQUENCE_NUMBER,                       
                    etl_load_datetime,
                    etl_load_metadatafilename) 
            values (
                    src.acfg, 
                    src.acfg_kw, 
                    src.adcc, 
                    src.adcc_kw, 
                    src.alhp, 
                    src.alhp_kw, 
                    src.altm, 
                    src.altm_kw, 
                    src.arcc, 
                    src.arcc_kw, 
                    src.ardc, 
                    src.asci, 
                    src.asci_kw, 
                    src.asec, 
                    src.asec_kw, 
                    src.bape, 
                    src.bape_kw, 
                    src.bcmi, 
                    src.bcmi_kw, 
                    src.beid, 
                    src.bgci, 
                    src.bgci_kw, 
                    src.bulg, 
                    src.bulg_kw, 
                    src.cadr, 
                    src.cadr_ref_compnr, 
                    src.capp, 
                    src.capp_kw, 
                    src.cbrk, 
                    src.cbrk_kw, 
                    src.cbrn, 
                    src.cbtp, 
                    src.ccty, 
                    src.ccty_ref_compnr, 
                    src.cfbs, 
                    src.cfbs_kw, 
                    src.cfri, 
                    src.cfri_kw, 
                    src.cinv, 
                    src.cinv_kw, 
                    src.clan, 
                    src.clan_ref_compnr, 
                    src.clbi, 
                    src.clbi_kw, 
                    src.cmai, 
                    src.compnr, 
                    src.corg, 
                    src.corg_kw, 
                    src.cpli, 
                    src.cpli_kw, 
                    src.crid, 
                    src.csli, 
                    src.csli_kw, 
                    src.darc, 
                    src.dasr, 
                    src.dasr_kw, 
                    src.deleted, 
                    src.deln, 
                    src.deln_kw, 
                    src.dsca, 
                    src.dsri, 
                    src.dsri_kw, 
                    src.duns, 
                    src.eaas, 
                    src.eaas_kw, 
                    src.ecmi, 
                    src.ecmi_kw, 
                    src.erac, 
                    src.erac_kw, 
                    src.eupl, 
                    src.eupl_kw, 
                    src.eusl, 
                    src.eusl_kw, 
                    src.eust, 
                    src.eust_kw, 
                    src.ffpl, 
                    src.ffpl_kw, 
                    src.fidn, 
                    src.fini, 
                    src.fini_kw, 
                    src.fovn, 
                    src.frmi, 
                    src.frmi_kw, 
                    src.fstk, 
                    src.fstk_kw, 
                    src.grpl, 
                    src.grpl_kw, 
                    src.gtci, 
                    src.gtci_kw, 
                    src.gtro, 
                    src.gtro_kw, 
                    src.hcst, 
                    src.hcst_kw, 
                    src.ilwh, 
                    src.ilwh_kw, 
                    src.indt, 
                    src.inf1, 
                    src.inf2, 
                    src.inf3, 
                    src.inf4, 
                    src.inpr, 
                    src.inpr_kw, 
                    src.intr, 
                    src.intr_kw, 
                    src.itpd, 
                    src.itpd_kw, 
                    src.itri, 
                    src.itri_kw, 
                    src.jspm, 
                    src.jspm_kw, 
                    src.lago, 
                    src.lago_kw, 
                    src.larg, 
                    src.larg_kw, 
                    src.lbra, 
                    src.lbra_kw, 
                    src.lche, 
                    src.lche_kw, 
                    src.lchl, 
                    src.lchl_kw, 
                    src.lchn, 
                    src.lchn_kw, 
                    src.lcol, 
                    src.lcol_kw, 
                    src.lcsi, 
                    src.lcsi_kw, 
                    src.lcze, 
                    src.lcze_kw, 
                    src.ldeu, 
                    src.ldeu_kw, 
                    src.lesp, 
                    src.lesp_kw, 
                    src.lgbr, 
                    src.lgbr_kw, 
                    src.lgid, 
                    src.lhrv, 
                    src.lhrv_kw, 
                    src.lhun, 
                    src.lhun_kw, 
                    src.lidn, 
                    src.lidn_kw, 
                    src.lind, 
                    src.lind_kw, 
                    src.lisr, 
                    src.lisr_kw, 
                    src.lita, 
                    src.lita_kw, 
                    src.lmex, 
                    src.lmex_kw, 
                    src.lmys, 
                    src.lmys_kw, 
                    src.lnor, 
                    src.lnor_kw, 
                    src.lnwi, 
                    src.lnwi_kw, 
                    src.lper, 
                    src.lper_kw, 
                    src.lphl, 
                    src.lphl_kw, 
                    src.lpol, 
                    src.lpol_kw, 
                    src.lpor, 
                    src.lpor_kw, 
                    src.lrom, 
                    src.lrom_kw, 
                    src.lrus, 
                    src.lrus_kw, 
                    src.lsau, 
                    src.lsau_kw, 
                    src.lsrb, 
                    src.lsrb_kw, 
                    src.lsvk, 
                    src.lsvk_kw, 
                    src.lsvn, 
                    src.lsvn_kw, 
                    src.ltha, 
                    src.ltha_kw, 
                    src.ltur, 
                    src.ltur_kw, 
                    src.lvnm, 
                    src.lvnm_kw, 
                    src.mejs, 
                    src.mejs_kw, 
                    src.mesa, 
                    src.mesa_kw, 
                    src.mfsi, 
                    src.mfsi_kw, 
                    src.mnfc, 
                    src.mnfc_kw, 
                    src.mpni, 
                    src.mpni_kw, 
                    src.mprs, 
                    src.mprs_kw, 
                    src.mstc, 
                    src.mstc_kw, 
                    src.nama, 
                    src.ncmp, 
                    src.odmu, 
                    src.odmu_kw, 
                    src.opsi, 
                    src.opsi_kw, 
                    src.owne, 
                    src.owne_kw, 
                    src.owni, 
                    src.owni_kw, 
                    src.pcfi, 
                    src.pcfi_kw, 
                    src.pcmd, 
                    src.pcmd_kw, 
                    src.pcsi, 
                    src.pcsi_kw, 
                    src.pdim, 
                    src.pdim_kw, 
                    src.pedi, 
                    src.pedi_kw, 
                    src.plai, 
                    src.plai_kw, 
                    src.plma, 
                    src.plma_kw, 
                    src.plnp, 
                    src.plnp_kw, 
                    src.ppeg, 
                    src.ppeg_kw, 
                    src.prci, 
                    src.prci_kw, 
                    src.prji, 
                    src.prji_kw, 
                    src.psch, 
                    src.psch_kw, 
                    src.ptri, 
                    src.ptri_kw, 
                    src.qumi, 
                    src.qumi_kw, 
                    src.rdes, 
                    src.rdes_kw, 
                    src.repr, 
                    src.rpti, 
                    src.rpti_kw, 
                    src.rsbs, 
                    src.rsbs_kw, 
                    src.scbs, 
                    src.scbs_kw, 
                    src.schi, 
                    src.schi_kw, 
                    src.sequencenumber, 
                    src.siac, 
                    src.simd, 
                    src.simd_kw, 
                    src.slbp, 
                    src.slbp_kw, 
                    src.slbs, 
                    src.slbs_kw, 
                    src.smfm, 
                    src.smfm_kw, 
                    src.smfs, 
                    src.smfs_kw, 
                    src.smii, 
                    src.smii_kw, 
                    src.spri, 
                    src.spri_kw, 
                    src.spsp, 
                    src.spsp_kw, 
                    src.srvi, 
                    src.srvi_kw, 
                    src.ssmf, 
                    src.ssmf_kw, 
                    src.stat, 
                    src.stat_kw, 
                    src.stbi, 
                    src.stbi_kw, 
                    src.tati, 
                    src.tati_kw, 
                    src.taxd, 
                    src.taxd_kw, 
                    src.timestamp, 
                    src.tlgi, 
                    src.tlgi_kw, 
                    src.trcn, 
                    src.trcn_kw, 
                    src.ucpu, 
                    src.ucpu_kw, 
                    src.ucsl, 
                    src.ucsl_kw, 
                    src.unef, 
                    src.unef_kw, 
                    src.username, 
                    src.usup, 
                    src.usup_kw, 
                    src.uwht, 
                    src.uwht_kw, 
                    src.vmic, 
                    src.vmic_kw, 
                    src.vmis, 
                    src.vmis_kw, 
                    src.wmbi, 
                    src.wmbi_kw, 
                    src.wrhi, 
                    src.wrhi_kw, 
                    src.xtmm, 
                    src.xtmm_kw,     
                    src.ETL_SEQUENCE_NUMBER,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename);`;

    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();

    snowflake.execute( {sqlText: `merge into TARGET_HISTORY_LN.LN_TCCOM000_DELETED as target using (
                SELECT * FROM (SELECT 
            strm.acfg, 
            strm.acfg_kw, 
            strm.adcc, 
            strm.adcc_kw, 
            strm.alhp, 
            strm.alhp_kw, 
            strm.altm, 
            strm.altm_kw, 
            strm.arcc, 
            strm.arcc_kw, 
            strm.ardc, 
            strm.asci, 
            strm.asci_kw, 
            strm.asec, 
            strm.asec_kw, 
            strm.bape, 
            strm.bape_kw, 
            strm.bcmi, 
            strm.bcmi_kw, 
            strm.beid, 
            strm.bgci, 
            strm.bgci_kw, 
            strm.bulg, 
            strm.bulg_kw, 
            strm.cadr, 
            strm.cadr_ref_compnr, 
            strm.capp, 
            strm.capp_kw, 
            strm.cbrk, 
            strm.cbrk_kw, 
            strm.cbrn, 
            strm.cbtp, 
            strm.ccty, 
            strm.ccty_ref_compnr, 
            strm.cfbs, 
            strm.cfbs_kw, 
            strm.cfri, 
            strm.cfri_kw, 
            strm.cinv, 
            strm.cinv_kw, 
            strm.clan, 
            strm.clan_ref_compnr, 
            strm.clbi, 
            strm.clbi_kw, 
            strm.cmai, 
            strm.compnr, 
            strm.corg, 
            strm.corg_kw, 
            strm.cpli, 
            strm.cpli_kw, 
            strm.crid, 
            strm.csli, 
            strm.csli_kw, 
            strm.darc, 
            strm.dasr, 
            strm.dasr_kw, 
            strm.deleted, 
            strm.deln, 
            strm.deln_kw, 
            strm.dsca, 
            strm.dsri, 
            strm.dsri_kw, 
            strm.duns, 
            strm.eaas, 
            strm.eaas_kw, 
            strm.ecmi, 
            strm.ecmi_kw, 
            strm.erac, 
            strm.erac_kw, 
            strm.eupl, 
            strm.eupl_kw, 
            strm.eusl, 
            strm.eusl_kw, 
            strm.eust, 
            strm.eust_kw, 
            strm.ffpl, 
            strm.ffpl_kw, 
            strm.fidn, 
            strm.fini, 
            strm.fini_kw, 
            strm.fovn, 
            strm.frmi, 
            strm.frmi_kw, 
            strm.fstk, 
            strm.fstk_kw, 
            strm.grpl, 
            strm.grpl_kw, 
            strm.gtci, 
            strm.gtci_kw, 
            strm.gtro, 
            strm.gtro_kw, 
            strm.hcst, 
            strm.hcst_kw, 
            strm.ilwh, 
            strm.ilwh_kw, 
            strm.indt, 
            strm.inf1, 
            strm.inf2, 
            strm.inf3, 
            strm.inf4, 
            strm.inpr, 
            strm.inpr_kw, 
            strm.intr, 
            strm.intr_kw, 
            strm.itpd, 
            strm.itpd_kw, 
            strm.itri, 
            strm.itri_kw, 
            strm.jspm, 
            strm.jspm_kw, 
            strm.lago, 
            strm.lago_kw, 
            strm.larg, 
            strm.larg_kw, 
            strm.lbra, 
            strm.lbra_kw, 
            strm.lche, 
            strm.lche_kw, 
            strm.lchl, 
            strm.lchl_kw, 
            strm.lchn, 
            strm.lchn_kw, 
            strm.lcol, 
            strm.lcol_kw, 
            strm.lcsi, 
            strm.lcsi_kw, 
            strm.lcze, 
            strm.lcze_kw, 
            strm.ldeu, 
            strm.ldeu_kw, 
            strm.lesp, 
            strm.lesp_kw, 
            strm.lgbr, 
            strm.lgbr_kw, 
            strm.lgid, 
            strm.lhrv, 
            strm.lhrv_kw, 
            strm.lhun, 
            strm.lhun_kw, 
            strm.lidn, 
            strm.lidn_kw, 
            strm.lind, 
            strm.lind_kw, 
            strm.lisr, 
            strm.lisr_kw, 
            strm.lita, 
            strm.lita_kw, 
            strm.lmex, 
            strm.lmex_kw, 
            strm.lmys, 
            strm.lmys_kw, 
            strm.lnor, 
            strm.lnor_kw, 
            strm.lnwi, 
            strm.lnwi_kw, 
            strm.lper, 
            strm.lper_kw, 
            strm.lphl, 
            strm.lphl_kw, 
            strm.lpol, 
            strm.lpol_kw, 
            strm.lpor, 
            strm.lpor_kw, 
            strm.lrom, 
            strm.lrom_kw, 
            strm.lrus, 
            strm.lrus_kw, 
            strm.lsau, 
            strm.lsau_kw, 
            strm.lsrb, 
            strm.lsrb_kw, 
            strm.lsvk, 
            strm.lsvk_kw, 
            strm.lsvn, 
            strm.lsvn_kw, 
            strm.ltha, 
            strm.ltha_kw, 
            strm.ltur, 
            strm.ltur_kw, 
            strm.lvnm, 
            strm.lvnm_kw, 
            strm.mejs, 
            strm.mejs_kw, 
            strm.mesa, 
            strm.mesa_kw, 
            strm.mfsi, 
            strm.mfsi_kw, 
            strm.mnfc, 
            strm.mnfc_kw, 
            strm.mpni, 
            strm.mpni_kw, 
            strm.mprs, 
            strm.mprs_kw, 
            strm.mstc, 
            strm.mstc_kw, 
            strm.nama, 
            strm.ncmp, 
            strm.odmu, 
            strm.odmu_kw, 
            strm.opsi, 
            strm.opsi_kw, 
            strm.owne, 
            strm.owne_kw, 
            strm.owni, 
            strm.owni_kw, 
            strm.pcfi, 
            strm.pcfi_kw, 
            strm.pcmd, 
            strm.pcmd_kw, 
            strm.pcsi, 
            strm.pcsi_kw, 
            strm.pdim, 
            strm.pdim_kw, 
            strm.pedi, 
            strm.pedi_kw, 
            strm.plai, 
            strm.plai_kw, 
            strm.plma, 
            strm.plma_kw, 
            strm.plnp, 
            strm.plnp_kw, 
            strm.ppeg, 
            strm.ppeg_kw, 
            strm.prci, 
            strm.prci_kw, 
            strm.prji, 
            strm.prji_kw, 
            strm.psch, 
            strm.psch_kw, 
            strm.ptri, 
            strm.ptri_kw, 
            strm.qumi, 
            strm.qumi_kw, 
            strm.rdes, 
            strm.rdes_kw, 
            strm.repr, 
            strm.rpti, 
            strm.rpti_kw, 
            strm.rsbs, 
            strm.rsbs_kw, 
            strm.scbs, 
            strm.scbs_kw, 
            strm.schi, 
            strm.schi_kw, 
            strm.sequencenumber, 
            strm.siac, 
            strm.simd, 
            strm.simd_kw, 
            strm.slbp, 
            strm.slbp_kw, 
            strm.slbs, 
            strm.slbs_kw, 
            strm.smfm, 
            strm.smfm_kw, 
            strm.smfs, 
            strm.smfs_kw, 
            strm.smii, 
            strm.smii_kw, 
            strm.spri, 
            strm.spri_kw, 
            strm.spsp, 
            strm.spsp_kw, 
            strm.srvi, 
            strm.srvi_kw, 
            strm.ssmf, 
            strm.ssmf_kw, 
            strm.stat, 
            strm.stat_kw, 
            strm.stbi, 
            strm.stbi_kw, 
            strm.tati, 
            strm.tati_kw, 
            strm.taxd, 
            strm.taxd_kw, 
            strm.timestamp, 
            strm.tlgi, 
            strm.tlgi_kw, 
            strm.trcn, 
            strm.trcn_kw, 
            strm.ucpu, 
            strm.ucpu_kw, 
            strm.ucsl, 
            strm.ucsl_kw, 
            strm.unef, 
            strm.unef_kw, 
            strm.username, 
            strm.usup, 
            strm.usup_kw, 
            strm.uwht, 
            strm.uwht_kw, 
            strm.vmic, 
            strm.vmic_kw, 
            strm.vmis, 
            strm.vmis_kw, 
            strm.wmbi, 
            strm.wmbi_kw, 
            strm.wrhi, 
            strm.wrhi_kw, 
            strm.xtmm, 
            strm.xtmm_kw, 
            strm.ETL_SEQUENCE_NUMBER,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.compnr,
            strm.indt,
            strm.ncmp ORDER BY strm.ETL_SEQUENCE_NUMBER desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_LN_TCCOM000 as  strm
        WHERE strm.ETL_DELETED=TRUE
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.compnr=src.compnr) OR (target.compnr IS NULL AND src.compnr IS NULL)) AND
            ((target.indt=src.indt) OR (target.indt IS NULL AND src.indt IS NULL)) AND
            ((target.ncmp=src.ncmp) OR (target.ncmp IS NULL AND src.ncmp IS NULL)) 
                when matched then update set
                    target.acfg=src.acfg, 
                    target.acfg_kw=src.acfg_kw, 
                    target.adcc=src.adcc, 
                    target.adcc_kw=src.adcc_kw, 
                    target.alhp=src.alhp, 
                    target.alhp_kw=src.alhp_kw, 
                    target.altm=src.altm, 
                    target.altm_kw=src.altm_kw, 
                    target.arcc=src.arcc, 
                    target.arcc_kw=src.arcc_kw, 
                    target.ardc=src.ardc, 
                    target.asci=src.asci, 
                    target.asci_kw=src.asci_kw, 
                    target.asec=src.asec, 
                    target.asec_kw=src.asec_kw, 
                    target.bape=src.bape, 
                    target.bape_kw=src.bape_kw, 
                    target.bcmi=src.bcmi, 
                    target.bcmi_kw=src.bcmi_kw, 
                    target.beid=src.beid, 
                    target.bgci=src.bgci, 
                    target.bgci_kw=src.bgci_kw, 
                    target.bulg=src.bulg, 
                    target.bulg_kw=src.bulg_kw, 
                    target.cadr=src.cadr, 
                    target.cadr_ref_compnr=src.cadr_ref_compnr, 
                    target.capp=src.capp, 
                    target.capp_kw=src.capp_kw, 
                    target.cbrk=src.cbrk, 
                    target.cbrk_kw=src.cbrk_kw, 
                    target.cbrn=src.cbrn, 
                    target.cbtp=src.cbtp, 
                    target.ccty=src.ccty, 
                    target.ccty_ref_compnr=src.ccty_ref_compnr, 
                    target.cfbs=src.cfbs, 
                    target.cfbs_kw=src.cfbs_kw, 
                    target.cfri=src.cfri, 
                    target.cfri_kw=src.cfri_kw, 
                    target.cinv=src.cinv, 
                    target.cinv_kw=src.cinv_kw, 
                    target.clan=src.clan, 
                    target.clan_ref_compnr=src.clan_ref_compnr, 
                    target.clbi=src.clbi, 
                    target.clbi_kw=src.clbi_kw, 
                    target.cmai=src.cmai, 
                    target.compnr=src.compnr, 
                    target.corg=src.corg, 
                    target.corg_kw=src.corg_kw, 
                    target.cpli=src.cpli, 
                    target.cpli_kw=src.cpli_kw, 
                    target.crid=src.crid, 
                    target.csli=src.csli, 
                    target.csli_kw=src.csli_kw, 
                    target.darc=src.darc, 
                    target.dasr=src.dasr, 
                    target.dasr_kw=src.dasr_kw, 
                    target.deleted=src.deleted, 
                    target.deln=src.deln, 
                    target.deln_kw=src.deln_kw, 
                    target.dsca=src.dsca, 
                    target.dsri=src.dsri, 
                    target.dsri_kw=src.dsri_kw, 
                    target.duns=src.duns, 
                    target.eaas=src.eaas, 
                    target.eaas_kw=src.eaas_kw, 
                    target.ecmi=src.ecmi, 
                    target.ecmi_kw=src.ecmi_kw, 
                    target.erac=src.erac, 
                    target.erac_kw=src.erac_kw, 
                    target.eupl=src.eupl, 
                    target.eupl_kw=src.eupl_kw, 
                    target.eusl=src.eusl, 
                    target.eusl_kw=src.eusl_kw, 
                    target.eust=src.eust, 
                    target.eust_kw=src.eust_kw, 
                    target.ffpl=src.ffpl, 
                    target.ffpl_kw=src.ffpl_kw, 
                    target.fidn=src.fidn, 
                    target.fini=src.fini, 
                    target.fini_kw=src.fini_kw, 
                    target.fovn=src.fovn, 
                    target.frmi=src.frmi, 
                    target.frmi_kw=src.frmi_kw, 
                    target.fstk=src.fstk, 
                    target.fstk_kw=src.fstk_kw, 
                    target.grpl=src.grpl, 
                    target.grpl_kw=src.grpl_kw, 
                    target.gtci=src.gtci, 
                    target.gtci_kw=src.gtci_kw, 
                    target.gtro=src.gtro, 
                    target.gtro_kw=src.gtro_kw, 
                    target.hcst=src.hcst, 
                    target.hcst_kw=src.hcst_kw, 
                    target.ilwh=src.ilwh, 
                    target.ilwh_kw=src.ilwh_kw, 
                    target.indt=src.indt, 
                    target.inf1=src.inf1, 
                    target.inf2=src.inf2, 
                    target.inf3=src.inf3, 
                    target.inf4=src.inf4, 
                    target.inpr=src.inpr, 
                    target.inpr_kw=src.inpr_kw, 
                    target.intr=src.intr, 
                    target.intr_kw=src.intr_kw, 
                    target.itpd=src.itpd, 
                    target.itpd_kw=src.itpd_kw, 
                    target.itri=src.itri, 
                    target.itri_kw=src.itri_kw, 
                    target.jspm=src.jspm, 
                    target.jspm_kw=src.jspm_kw, 
                    target.lago=src.lago, 
                    target.lago_kw=src.lago_kw, 
                    target.larg=src.larg, 
                    target.larg_kw=src.larg_kw, 
                    target.lbra=src.lbra, 
                    target.lbra_kw=src.lbra_kw, 
                    target.lche=src.lche, 
                    target.lche_kw=src.lche_kw, 
                    target.lchl=src.lchl, 
                    target.lchl_kw=src.lchl_kw, 
                    target.lchn=src.lchn, 
                    target.lchn_kw=src.lchn_kw, 
                    target.lcol=src.lcol, 
                    target.lcol_kw=src.lcol_kw, 
                    target.lcsi=src.lcsi, 
                    target.lcsi_kw=src.lcsi_kw, 
                    target.lcze=src.lcze, 
                    target.lcze_kw=src.lcze_kw, 
                    target.ldeu=src.ldeu, 
                    target.ldeu_kw=src.ldeu_kw, 
                    target.lesp=src.lesp, 
                    target.lesp_kw=src.lesp_kw, 
                    target.lgbr=src.lgbr, 
                    target.lgbr_kw=src.lgbr_kw, 
                    target.lgid=src.lgid, 
                    target.lhrv=src.lhrv, 
                    target.lhrv_kw=src.lhrv_kw, 
                    target.lhun=src.lhun, 
                    target.lhun_kw=src.lhun_kw, 
                    target.lidn=src.lidn, 
                    target.lidn_kw=src.lidn_kw, 
                    target.lind=src.lind, 
                    target.lind_kw=src.lind_kw, 
                    target.lisr=src.lisr, 
                    target.lisr_kw=src.lisr_kw, 
                    target.lita=src.lita, 
                    target.lita_kw=src.lita_kw, 
                    target.lmex=src.lmex, 
                    target.lmex_kw=src.lmex_kw, 
                    target.lmys=src.lmys, 
                    target.lmys_kw=src.lmys_kw, 
                    target.lnor=src.lnor, 
                    target.lnor_kw=src.lnor_kw, 
                    target.lnwi=src.lnwi, 
                    target.lnwi_kw=src.lnwi_kw, 
                    target.lper=src.lper, 
                    target.lper_kw=src.lper_kw, 
                    target.lphl=src.lphl, 
                    target.lphl_kw=src.lphl_kw, 
                    target.lpol=src.lpol, 
                    target.lpol_kw=src.lpol_kw, 
                    target.lpor=src.lpor, 
                    target.lpor_kw=src.lpor_kw, 
                    target.lrom=src.lrom, 
                    target.lrom_kw=src.lrom_kw, 
                    target.lrus=src.lrus, 
                    target.lrus_kw=src.lrus_kw, 
                    target.lsau=src.lsau, 
                    target.lsau_kw=src.lsau_kw, 
                    target.lsrb=src.lsrb, 
                    target.lsrb_kw=src.lsrb_kw, 
                    target.lsvk=src.lsvk, 
                    target.lsvk_kw=src.lsvk_kw, 
                    target.lsvn=src.lsvn, 
                    target.lsvn_kw=src.lsvn_kw, 
                    target.ltha=src.ltha, 
                    target.ltha_kw=src.ltha_kw, 
                    target.ltur=src.ltur, 
                    target.ltur_kw=src.ltur_kw, 
                    target.lvnm=src.lvnm, 
                    target.lvnm_kw=src.lvnm_kw, 
                    target.mejs=src.mejs, 
                    target.mejs_kw=src.mejs_kw, 
                    target.mesa=src.mesa, 
                    target.mesa_kw=src.mesa_kw, 
                    target.mfsi=src.mfsi, 
                    target.mfsi_kw=src.mfsi_kw, 
                    target.mnfc=src.mnfc, 
                    target.mnfc_kw=src.mnfc_kw, 
                    target.mpni=src.mpni, 
                    target.mpni_kw=src.mpni_kw, 
                    target.mprs=src.mprs, 
                    target.mprs_kw=src.mprs_kw, 
                    target.mstc=src.mstc, 
                    target.mstc_kw=src.mstc_kw, 
                    target.nama=src.nama, 
                    target.ncmp=src.ncmp, 
                    target.odmu=src.odmu, 
                    target.odmu_kw=src.odmu_kw, 
                    target.opsi=src.opsi, 
                    target.opsi_kw=src.opsi_kw, 
                    target.owne=src.owne, 
                    target.owne_kw=src.owne_kw, 
                    target.owni=src.owni, 
                    target.owni_kw=src.owni_kw, 
                    target.pcfi=src.pcfi, 
                    target.pcfi_kw=src.pcfi_kw, 
                    target.pcmd=src.pcmd, 
                    target.pcmd_kw=src.pcmd_kw, 
                    target.pcsi=src.pcsi, 
                    target.pcsi_kw=src.pcsi_kw, 
                    target.pdim=src.pdim, 
                    target.pdim_kw=src.pdim_kw, 
                    target.pedi=src.pedi, 
                    target.pedi_kw=src.pedi_kw, 
                    target.plai=src.plai, 
                    target.plai_kw=src.plai_kw, 
                    target.plma=src.plma, 
                    target.plma_kw=src.plma_kw, 
                    target.plnp=src.plnp, 
                    target.plnp_kw=src.plnp_kw, 
                    target.ppeg=src.ppeg, 
                    target.ppeg_kw=src.ppeg_kw, 
                    target.prci=src.prci, 
                    target.prci_kw=src.prci_kw, 
                    target.prji=src.prji, 
                    target.prji_kw=src.prji_kw, 
                    target.psch=src.psch, 
                    target.psch_kw=src.psch_kw, 
                    target.ptri=src.ptri, 
                    target.ptri_kw=src.ptri_kw, 
                    target.qumi=src.qumi, 
                    target.qumi_kw=src.qumi_kw, 
                    target.rdes=src.rdes, 
                    target.rdes_kw=src.rdes_kw, 
                    target.repr=src.repr, 
                    target.rpti=src.rpti, 
                    target.rpti_kw=src.rpti_kw, 
                    target.rsbs=src.rsbs, 
                    target.rsbs_kw=src.rsbs_kw, 
                    target.scbs=src.scbs, 
                    target.scbs_kw=src.scbs_kw, 
                    target.schi=src.schi, 
                    target.schi_kw=src.schi_kw, 
                    target.sequencenumber=src.sequencenumber, 
                    target.siac=src.siac, 
                    target.simd=src.simd, 
                    target.simd_kw=src.simd_kw, 
                    target.slbp=src.slbp, 
                    target.slbp_kw=src.slbp_kw, 
                    target.slbs=src.slbs, 
                    target.slbs_kw=src.slbs_kw, 
                    target.smfm=src.smfm, 
                    target.smfm_kw=src.smfm_kw, 
                    target.smfs=src.smfs, 
                    target.smfs_kw=src.smfs_kw, 
                    target.smii=src.smii, 
                    target.smii_kw=src.smii_kw, 
                    target.spri=src.spri, 
                    target.spri_kw=src.spri_kw, 
                    target.spsp=src.spsp, 
                    target.spsp_kw=src.spsp_kw, 
                    target.srvi=src.srvi, 
                    target.srvi_kw=src.srvi_kw, 
                    target.ssmf=src.ssmf, 
                    target.ssmf_kw=src.ssmf_kw, 
                    target.stat=src.stat, 
                    target.stat_kw=src.stat_kw, 
                    target.stbi=src.stbi, 
                    target.stbi_kw=src.stbi_kw, 
                    target.tati=src.tati, 
                    target.tati_kw=src.tati_kw, 
                    target.taxd=src.taxd, 
                    target.taxd_kw=src.taxd_kw, 
                    target.timestamp=src.timestamp, 
                    target.tlgi=src.tlgi, 
                    target.tlgi_kw=src.tlgi_kw, 
                    target.trcn=src.trcn, 
                    target.trcn_kw=src.trcn_kw, 
                    target.ucpu=src.ucpu, 
                    target.ucpu_kw=src.ucpu_kw, 
                    target.ucsl=src.ucsl, 
                    target.ucsl_kw=src.ucsl_kw, 
                    target.unef=src.unef, 
                    target.unef_kw=src.unef_kw, 
                    target.username=src.username, 
                    target.usup=src.usup, 
                    target.usup_kw=src.usup_kw, 
                    target.uwht=src.uwht, 
                    target.uwht_kw=src.uwht_kw, 
                    target.vmic=src.vmic, 
                    target.vmic_kw=src.vmic_kw, 
                    target.vmis=src.vmis, 
                    target.vmis_kw=src.vmis_kw, 
                    target.wmbi=src.wmbi, 
                    target.wmbi_kw=src.wmbi_kw, 
                    target.wrhi=src.wrhi, 
                    target.wrhi_kw=src.wrhi_kw, 
                    target.xtmm=src.xtmm, 
                    target.xtmm_kw=src.xtmm_kw, 
                    target.ETL_SEQUENCE_NUMBER=src.ETL_SEQUENCE_NUMBER,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename,
                    target.ETL_DELETED=src.ETL_DELETED
        when not matched   then insert ( acfg, acfg_kw, adcc, adcc_kw, alhp, alhp_kw, altm, altm_kw, arcc, arcc_kw, ardc, asci, asci_kw, asec, asec_kw, bape, bape_kw, bcmi, bcmi_kw, beid, bgci, bgci_kw, bulg, bulg_kw, cadr, cadr_ref_compnr, capp, capp_kw, cbrk, cbrk_kw, cbrn, cbtp, ccty, ccty_ref_compnr, cfbs, cfbs_kw, cfri, cfri_kw, cinv, cinv_kw, clan, clan_ref_compnr, clbi, clbi_kw, cmai, compnr, corg, corg_kw, cpli, cpli_kw, crid, csli, csli_kw, darc, dasr, dasr_kw, deleted, deln, deln_kw, dsca, dsri, dsri_kw, duns, eaas, eaas_kw, ecmi, ecmi_kw, erac, erac_kw, eupl, eupl_kw, eusl, eusl_kw, eust, eust_kw, ffpl, ffpl_kw, fidn, fini, fini_kw, fovn, frmi, frmi_kw, fstk, fstk_kw, grpl, grpl_kw, gtci, gtci_kw, gtro, gtro_kw, hcst, hcst_kw, ilwh, ilwh_kw, indt, inf1, inf2, inf3, inf4, inpr, inpr_kw, intr, intr_kw, itpd, itpd_kw, itri, itri_kw, jspm, jspm_kw, lago, lago_kw, larg, larg_kw, lbra, lbra_kw, lche, lche_kw, lchl, lchl_kw, lchn, lchn_kw, lcol, lcol_kw, lcsi, lcsi_kw, lcze, lcze_kw, ldeu, ldeu_kw, lesp, lesp_kw, lgbr, lgbr_kw, lgid, lhrv, lhrv_kw, lhun, lhun_kw, lidn, lidn_kw, lind, lind_kw, lisr, lisr_kw, lita, lita_kw, lmex, lmex_kw, lmys, lmys_kw, lnor, lnor_kw, lnwi, lnwi_kw, lper, lper_kw, lphl, lphl_kw, lpol, lpol_kw, lpor, lpor_kw, lrom, lrom_kw, lrus, lrus_kw, lsau, lsau_kw, lsrb, lsrb_kw, lsvk, lsvk_kw, lsvn, lsvn_kw, ltha, ltha_kw, ltur, ltur_kw, lvnm, lvnm_kw, mejs, mejs_kw, mesa, mesa_kw, mfsi, mfsi_kw, mnfc, mnfc_kw, mpni, mpni_kw, mprs, mprs_kw, mstc, mstc_kw, nama, ncmp, odmu, odmu_kw, opsi, opsi_kw, owne, owne_kw, owni, owni_kw, pcfi, pcfi_kw, pcmd, pcmd_kw, pcsi, pcsi_kw, pdim, pdim_kw, pedi, pedi_kw, plai, plai_kw, plma, plma_kw, plnp, plnp_kw, ppeg, ppeg_kw, prci, prci_kw, prji, prji_kw, psch, psch_kw, ptri, ptri_kw, qumi, qumi_kw, rdes, rdes_kw, repr, rpti, rpti_kw, rsbs, rsbs_kw, scbs, scbs_kw, schi, schi_kw, sequencenumber, siac, simd, simd_kw, slbp, slbp_kw, slbs, slbs_kw, smfm, smfm_kw, smfs, smfs_kw, smii, smii_kw, spri, spri_kw, spsp, spsp_kw, srvi, srvi_kw, ssmf, ssmf_kw, stat, stat_kw, stbi, stbi_kw, tati, tati_kw, taxd, taxd_kw, timestamp, tlgi, tlgi_kw, trcn, trcn_kw, ucpu, ucpu_kw, ucsl, ucsl_kw, unef, unef_kw, username, usup, usup_kw, uwht, uwht_kw, vmic, vmic_kw, vmis, vmis_kw, wmbi, wmbi_kw, wrhi, wrhi_kw, xtmm, xtmm_kw, 
                    ETL_SEQUENCE_NUMBER,                       
                    etl_load_datetime,
                    etl_load_metadatafilename,
                    etl_is_deleted,
                    ETL_DELETED) 
            values (
                    src.acfg, 
                    src.acfg_kw, 
                    src.adcc, 
                    src.adcc_kw, 
                    src.alhp, 
                    src.alhp_kw, 
                    src.altm, 
                    src.altm_kw, 
                    src.arcc, 
                    src.arcc_kw, 
                    src.ardc, 
                    src.asci, 
                    src.asci_kw, 
                    src.asec, 
                    src.asec_kw, 
                    src.bape, 
                    src.bape_kw, 
                    src.bcmi, 
                    src.bcmi_kw, 
                    src.beid, 
                    src.bgci, 
                    src.bgci_kw, 
                    src.bulg, 
                    src.bulg_kw, 
                    src.cadr, 
                    src.cadr_ref_compnr, 
                    src.capp, 
                    src.capp_kw, 
                    src.cbrk, 
                    src.cbrk_kw, 
                    src.cbrn, 
                    src.cbtp, 
                    src.ccty, 
                    src.ccty_ref_compnr, 
                    src.cfbs, 
                    src.cfbs_kw, 
                    src.cfri, 
                    src.cfri_kw, 
                    src.cinv, 
                    src.cinv_kw, 
                    src.clan, 
                    src.clan_ref_compnr, 
                    src.clbi, 
                    src.clbi_kw, 
                    src.cmai, 
                    src.compnr, 
                    src.corg, 
                    src.corg_kw, 
                    src.cpli, 
                    src.cpli_kw, 
                    src.crid, 
                    src.csli, 
                    src.csli_kw, 
                    src.darc, 
                    src.dasr, 
                    src.dasr_kw, 
                    src.deleted, 
                    src.deln, 
                    src.deln_kw, 
                    src.dsca, 
                    src.dsri, 
                    src.dsri_kw, 
                    src.duns, 
                    src.eaas, 
                    src.eaas_kw, 
                    src.ecmi, 
                    src.ecmi_kw, 
                    src.erac, 
                    src.erac_kw, 
                    src.eupl, 
                    src.eupl_kw, 
                    src.eusl, 
                    src.eusl_kw, 
                    src.eust, 
                    src.eust_kw, 
                    src.ffpl, 
                    src.ffpl_kw, 
                    src.fidn, 
                    src.fini, 
                    src.fini_kw, 
                    src.fovn, 
                    src.frmi, 
                    src.frmi_kw, 
                    src.fstk, 
                    src.fstk_kw, 
                    src.grpl, 
                    src.grpl_kw, 
                    src.gtci, 
                    src.gtci_kw, 
                    src.gtro, 
                    src.gtro_kw, 
                    src.hcst, 
                    src.hcst_kw, 
                    src.ilwh, 
                    src.ilwh_kw, 
                    src.indt, 
                    src.inf1, 
                    src.inf2, 
                    src.inf3, 
                    src.inf4, 
                    src.inpr, 
                    src.inpr_kw, 
                    src.intr, 
                    src.intr_kw, 
                    src.itpd, 
                    src.itpd_kw, 
                    src.itri, 
                    src.itri_kw, 
                    src.jspm, 
                    src.jspm_kw, 
                    src.lago, 
                    src.lago_kw, 
                    src.larg, 
                    src.larg_kw, 
                    src.lbra, 
                    src.lbra_kw, 
                    src.lche, 
                    src.lche_kw, 
                    src.lchl, 
                    src.lchl_kw, 
                    src.lchn, 
                    src.lchn_kw, 
                    src.lcol, 
                    src.lcol_kw, 
                    src.lcsi, 
                    src.lcsi_kw, 
                    src.lcze, 
                    src.lcze_kw, 
                    src.ldeu, 
                    src.ldeu_kw, 
                    src.lesp, 
                    src.lesp_kw, 
                    src.lgbr, 
                    src.lgbr_kw, 
                    src.lgid, 
                    src.lhrv, 
                    src.lhrv_kw, 
                    src.lhun, 
                    src.lhun_kw, 
                    src.lidn, 
                    src.lidn_kw, 
                    src.lind, 
                    src.lind_kw, 
                    src.lisr, 
                    src.lisr_kw, 
                    src.lita, 
                    src.lita_kw, 
                    src.lmex, 
                    src.lmex_kw, 
                    src.lmys, 
                    src.lmys_kw, 
                    src.lnor, 
                    src.lnor_kw, 
                    src.lnwi, 
                    src.lnwi_kw, 
                    src.lper, 
                    src.lper_kw, 
                    src.lphl, 
                    src.lphl_kw, 
                    src.lpol, 
                    src.lpol_kw, 
                    src.lpor, 
                    src.lpor_kw, 
                    src.lrom, 
                    src.lrom_kw, 
                    src.lrus, 
                    src.lrus_kw, 
                    src.lsau, 
                    src.lsau_kw, 
                    src.lsrb, 
                    src.lsrb_kw, 
                    src.lsvk, 
                    src.lsvk_kw, 
                    src.lsvn, 
                    src.lsvn_kw, 
                    src.ltha, 
                    src.ltha_kw, 
                    src.ltur, 
                    src.ltur_kw, 
                    src.lvnm, 
                    src.lvnm_kw, 
                    src.mejs, 
                    src.mejs_kw, 
                    src.mesa, 
                    src.mesa_kw, 
                    src.mfsi, 
                    src.mfsi_kw, 
                    src.mnfc, 
                    src.mnfc_kw, 
                    src.mpni, 
                    src.mpni_kw, 
                    src.mprs, 
                    src.mprs_kw, 
                    src.mstc, 
                    src.mstc_kw, 
                    src.nama, 
                    src.ncmp, 
                    src.odmu, 
                    src.odmu_kw, 
                    src.opsi, 
                    src.opsi_kw, 
                    src.owne, 
                    src.owne_kw, 
                    src.owni, 
                    src.owni_kw, 
                    src.pcfi, 
                    src.pcfi_kw, 
                    src.pcmd, 
                    src.pcmd_kw, 
                    src.pcsi, 
                    src.pcsi_kw, 
                    src.pdim, 
                    src.pdim_kw, 
                    src.pedi, 
                    src.pedi_kw, 
                    src.plai, 
                    src.plai_kw, 
                    src.plma, 
                    src.plma_kw, 
                    src.plnp, 
                    src.plnp_kw, 
                    src.ppeg, 
                    src.ppeg_kw, 
                    src.prci, 
                    src.prci_kw, 
                    src.prji, 
                    src.prji_kw, 
                    src.psch, 
                    src.psch_kw, 
                    src.ptri, 
                    src.ptri_kw, 
                    src.qumi, 
                    src.qumi_kw, 
                    src.rdes, 
                    src.rdes_kw, 
                    src.repr, 
                    src.rpti, 
                    src.rpti_kw, 
                    src.rsbs, 
                    src.rsbs_kw, 
                    src.scbs, 
                    src.scbs_kw, 
                    src.schi, 
                    src.schi_kw, 
                    src.sequencenumber, 
                    src.siac, 
                    src.simd, 
                    src.simd_kw, 
                    src.slbp, 
                    src.slbp_kw, 
                    src.slbs, 
                    src.slbs_kw, 
                    src.smfm, 
                    src.smfm_kw, 
                    src.smfs, 
                    src.smfs_kw, 
                    src.smii, 
                    src.smii_kw, 
                    src.spri, 
                    src.spri_kw, 
                    src.spsp, 
                    src.spsp_kw, 
                    src.srvi, 
                    src.srvi_kw, 
                    src.ssmf, 
                    src.ssmf_kw, 
                    src.stat, 
                    src.stat_kw, 
                    src.stbi, 
                    src.stbi_kw, 
                    src.tati, 
                    src.tati_kw, 
                    src.taxd, 
                    src.taxd_kw, 
                    src.timestamp, 
                    src.tlgi, 
                    src.tlgi_kw, 
                    src.trcn, 
                    src.trcn_kw, 
                    src.ucpu, 
                    src.ucpu_kw, 
                    src.ucsl, 
                    src.ucsl_kw, 
                    src.unef, 
                    src.unef_kw, 
                    src.username, 
                    src.usup, 
                    src.usup_kw, 
                    src.uwht, 
                    src.uwht_kw, 
                    src.vmic, 
                    src.vmic_kw, 
                    src.vmis, 
                    src.vmis_kw, 
                    src.wmbi, 
                    src.wmbi_kw, 
                    src.wrhi, 
                    src.wrhi_kw, 
                    src.xtmm, 
                    src.xtmm_kw,     
                    src.ETL_SEQUENCE_NUMBER,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename,
                    case when ETL_DELETED=TRUE then TRUE else FALSE end,
                    ETL_DELETED);
    `
} );

                    
//  Get number of rows inserted
        
        var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
        var rs = sqlStmt.execute();
        var number_of_rows_inserted = sqlStmt.getNumRowsInserted();
        var number_of_rows_updated =  sqlStmt.getNumRowsUpdated();
                    

        
    snowflake.execute ({sqlText: "commit"});

    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Success','Completed process execution.', 0 ," + number_of_rows_inserted.toString()+ "," +  number_of_rows_updated.toString() + ");";
    snowflake.execute({sqlText: log_sql_command});

    result = "Success"; 

    }       

    catch (err)  {
        snowflake.execute( {sqlText: "rollback;"} )
        var clean_error_msg = err.message.replace(/[^\w\s]/gi, '');
    //  Create a log entry to say INSERT STATEMENT failed
    
    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Failed','MERGE Failed. Error:" + err.code.toString()+" : "+ clean_error_msg  + "', 0 ,0,0);";
    snowflake.execute({sqlText: log_sql_command});
        ;
        throw "Failed: " + err.message;   // Return a success/error indicator.
        }
    return result;
    $$;