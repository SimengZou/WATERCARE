create or replace procedure DATAHUB_INTEGRATION.SP_LN_TICST001()
    returns varchar not null
                language javascript
                as
                $$

//  Variables

var result = "";                                    // return status of this proc call
const process_name = Object.keys(this)[0];          // name of currently executing process
var number_of_rows_inserted = 0;                             // track number of rows we have inserted
var number_of_rows_updated = 0;                             // track number of rows we have updated


//  Step 1.

//  Start execution - log start

log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('Insert','" + process_name + "','Running','Started process execution.', 0,0,0);";
snowflake.execute({sqlText: log_sql_command});

snowflake.execute( {sqlText: "begin transaction;"} );
try
    {
        var sql_command = `
                            INSERT INTO LANDING_ERROR.LN_RAW_ERROR
                            SELECT * FROM LANDING_ERROR.VW_STREAM_LN_TICST001_ERROR`;
    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();
        
        var sql_command = ` 
                            merge into  TARGET_LN.LN_TICST001 as target using (SELECT * FROM (SELECT 
            strm.aamt_1, 
            strm.aamt_2, 
            strm.aamt_3, 
            strm.aamt_dwhc, 
            strm.aamt_lclc, 
            strm.aamt_refc, 
            strm.aamt_rpc1, 
            strm.aamt_rpc2, 
            strm.aamu_1, 
            strm.aamu_2, 
            strm.aamu_3, 
            strm.aamu_dwhc, 
            strm.aamu_lclc, 
            strm.aamu_refc, 
            strm.aamu_rpc1, 
            strm.aamu_rpc2, 
            strm.aldt, 
            strm.alfp, 
            strm.almi, 
            strm.almi_kw, 
            strm.altp, 
            strm.altp_kw, 
            strm.alty, 
            strm.alty_kw, 
            strm.ames_dwhc, 
            strm.ames_lclc, 
            strm.ames_refc, 
            strm.ames_rpc1, 
            strm.ames_rpc2, 
            strm.aues_dwhc, 
            strm.aues_lclc, 
            strm.aues_refc, 
            strm.aues_rpc1, 
            strm.aues_rpc2, 
            strm.bfls, 
            strm.bfls_kw, 
            strm.bmdl, 
            strm.bmit, 
            strm.bmrv, 
            strm.boun, 
            strm.boun_ref_compnr, 
            strm.bpon, 
            strm.bseq, 
            strm.bwar, 
            strm.bwar_ref_compnr, 
            strm.cctt, 
            strm.cctt_kw, 
            strm.ccur, 
            strm.ccur_ref_compnr, 
            strm.clot, 
            strm.compnr, 
            strm.cpcs_1, 
            strm.cpcs_2, 
            strm.cpcs_3, 
            strm.cpcs_dwhc, 
            strm.cpcs_lclc, 
            strm.cpcs_refc, 
            strm.cpcs_rpc1, 
            strm.cpcs_rpc2, 
            strm.cpcu_1, 
            strm.cpcu_2, 
            strm.cpcu_3, 
            strm.cpcu_dwhc, 
            strm.cpcu_lclc, 
            strm.cpcu_refc, 
            strm.cpcu_rpc1, 
            strm.cpcu_rpc2, 
            strm.cpes_1, 
            strm.cpes_2, 
            strm.cpes_3, 
            strm.cpes_dwhc, 
            strm.cpes_eam1, 
            strm.cpes_eam2, 
            strm.cpes_eam3, 
            strm.cpes_refc, 
            strm.cues_1, 
            strm.cues_2, 
            strm.cues_3, 
            strm.cues_dwhc, 
            strm.cues_eau1, 
            strm.cues_eau2, 
            strm.cues_eau3, 
            strm.cues_refc, 
            strm.cwar, 
            strm.cwar_ref_compnr, 
            strm.deleted, 
            strm.dptm_fcmp, 
            strm.drin, 
            strm.drin_kw, 
            strm.dris, 
            strm.dris_kw, 
            strm.dstp, 
            strm.dstp_kw, 
            strm.effn, 
            strm.icfm, 
            strm.icfm_kw, 
            strm.ippg, 
            strm.ippg_kw, 
            strm.issu, 
            strm.issu_buar, 
            strm.issu_buln, 
            strm.issu_bupc, 
            strm.issu_butm, 
            strm.issu_buvl, 
            strm.issu_buwg, 
            strm.iswh, 
            strm.iswh_buar, 
            strm.iswh_buln, 
            strm.iswh_bupc, 
            strm.iswh_butm, 
            strm.iswh_buvl, 
            strm.iswh_buwg, 
            strm.item_rcmp, 
            strm.leng, 
            strm.lpno, 
            strm.lsel, 
            strm.lsel_kw, 
            strm.mcmd, 
            strm.mcmd_kw, 
            strm.noun, 
            strm.opno, 
            strm.owns, 
            strm.owns_kw, 
            strm.pdno, 
            strm.pdno_ref_compnr, 
            strm.pono, 
            strm.preq, 
            strm.qbfd, 
            strm.qbfd_buar, 
            strm.qbfd_buln, 
            strm.qbfd_bupc, 
            strm.qbfd_butm, 
            strm.qbfd_buvl, 
            strm.qbfd_buwg, 
            strm.qqar, 
            strm.qqar_buar, 
            strm.qqar_buln, 
            strm.qqar_bupc, 
            strm.qqar_butm, 
            strm.qqar_buvl, 
            strm.qqar_buwg, 
            strm.qqur, 
            strm.qscr, 
            strm.qscr_buar, 
            strm.qscr_buln, 
            strm.qscr_bupc, 
            strm.qscr_butm, 
            strm.qscr_buvl, 
            strm.qscr_buwg, 
            strm.qspl, 
            strm.qtor, 
            strm.qtor_buar, 
            strm.qtor_buln, 
            strm.qtor_bupc, 
            strm.qtor_butm, 
            strm.qtor_buvl, 
            strm.qtor_buwg, 
            strm.qucs, 
            strm.qucs_buar, 
            strm.qucs_buln, 
            strm.qucs_bupc, 
            strm.qucs_butm, 
            strm.qucs_buvl, 
            strm.qucs_buwg, 
            strm.ques, 
            strm.ques_buar, 
            strm.ques_buln, 
            strm.ques_bupc, 
            strm.ques_butm, 
            strm.ques_buvl, 
            strm.ques_buwg, 
            strm.qune, 
            strm.qune_buar, 
            strm.qune_buln, 
            strm.qune_bupc, 
            strm.qune_butm, 
            strm.qune_buvl, 
            strm.qune_buwg, 
            strm.rdsp, 
            strm.rdsp_kw, 
            strm.revi, 
            strm.revn, 
            strm.rtas, 
            strm.rtas_kw, 
            strm.rwit, 
            strm.rwit_kw, 
            strm.sayn, 
            strm.sayn_kw, 
            strm.sbsr, 
            strm.sbsr_kw, 
            strm.scdl, 
            strm.scpf, 
            strm.scpq, 
            strm.scpq_buar, 
            strm.scpq_buln, 
            strm.scpq_bupc, 
            strm.scpq_butm, 
            strm.scpq_buvl, 
            strm.scpq_buwg, 
            strm.sequencenumber, 
            strm.sitm, 
            strm.sitm_ref_compnr, 
            strm.sizu, 
            strm.sizu_ref_compnr, 
            strm.spcn, 
            strm.subc, 
            strm.subc_kw, 
            strm.subd, 
            strm.subd_buar, 
            strm.subd_buln, 
            strm.subd_bupc, 
            strm.subd_butm, 
            strm.subd_buvl, 
            strm.subd_buwg, 
            strm.timestamp, 
            strm.txta, 
            strm.txta_ref_compnr, 
            strm.username, 
            strm.widt, 
            strm.ETL_SEQUENCE_NUMBER,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.compnr,
            strm.pdno,
            strm.pono ORDER BY strm.ETL_SEQUENCE_NUMBER desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_LN_TICST001 as  strm
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.compnr=src.compnr) OR (target.compnr IS NULL AND src.compnr IS NULL)) AND
            ((target.pdno=src.pdno) OR (target.pdno IS NULL AND src.pdno IS NULL)) AND
            ((target.pono=src.pono) OR (target.pono IS NULL AND src.pono IS NULL)) 
                when matched and src.ETL_DELETED=TRUE THEN DELETE
                when matched then update set
                    target.aamt_1=src.aamt_1, 
                    target.aamt_2=src.aamt_2, 
                    target.aamt_3=src.aamt_3, 
                    target.aamt_dwhc=src.aamt_dwhc, 
                    target.aamt_lclc=src.aamt_lclc, 
                    target.aamt_refc=src.aamt_refc, 
                    target.aamt_rpc1=src.aamt_rpc1, 
                    target.aamt_rpc2=src.aamt_rpc2, 
                    target.aamu_1=src.aamu_1, 
                    target.aamu_2=src.aamu_2, 
                    target.aamu_3=src.aamu_3, 
                    target.aamu_dwhc=src.aamu_dwhc, 
                    target.aamu_lclc=src.aamu_lclc, 
                    target.aamu_refc=src.aamu_refc, 
                    target.aamu_rpc1=src.aamu_rpc1, 
                    target.aamu_rpc2=src.aamu_rpc2, 
                    target.aldt=src.aldt, 
                    target.alfp=src.alfp, 
                    target.almi=src.almi, 
                    target.almi_kw=src.almi_kw, 
                    target.altp=src.altp, 
                    target.altp_kw=src.altp_kw, 
                    target.alty=src.alty, 
                    target.alty_kw=src.alty_kw, 
                    target.ames_dwhc=src.ames_dwhc, 
                    target.ames_lclc=src.ames_lclc, 
                    target.ames_refc=src.ames_refc, 
                    target.ames_rpc1=src.ames_rpc1, 
                    target.ames_rpc2=src.ames_rpc2, 
                    target.aues_dwhc=src.aues_dwhc, 
                    target.aues_lclc=src.aues_lclc, 
                    target.aues_refc=src.aues_refc, 
                    target.aues_rpc1=src.aues_rpc1, 
                    target.aues_rpc2=src.aues_rpc2, 
                    target.bfls=src.bfls, 
                    target.bfls_kw=src.bfls_kw, 
                    target.bmdl=src.bmdl, 
                    target.bmit=src.bmit, 
                    target.bmrv=src.bmrv, 
                    target.boun=src.boun, 
                    target.boun_ref_compnr=src.boun_ref_compnr, 
                    target.bpon=src.bpon, 
                    target.bseq=src.bseq, 
                    target.bwar=src.bwar, 
                    target.bwar_ref_compnr=src.bwar_ref_compnr, 
                    target.cctt=src.cctt, 
                    target.cctt_kw=src.cctt_kw, 
                    target.ccur=src.ccur, 
                    target.ccur_ref_compnr=src.ccur_ref_compnr, 
                    target.clot=src.clot, 
                    target.compnr=src.compnr, 
                    target.cpcs_1=src.cpcs_1, 
                    target.cpcs_2=src.cpcs_2, 
                    target.cpcs_3=src.cpcs_3, 
                    target.cpcs_dwhc=src.cpcs_dwhc, 
                    target.cpcs_lclc=src.cpcs_lclc, 
                    target.cpcs_refc=src.cpcs_refc, 
                    target.cpcs_rpc1=src.cpcs_rpc1, 
                    target.cpcs_rpc2=src.cpcs_rpc2, 
                    target.cpcu_1=src.cpcu_1, 
                    target.cpcu_2=src.cpcu_2, 
                    target.cpcu_3=src.cpcu_3, 
                    target.cpcu_dwhc=src.cpcu_dwhc, 
                    target.cpcu_lclc=src.cpcu_lclc, 
                    target.cpcu_refc=src.cpcu_refc, 
                    target.cpcu_rpc1=src.cpcu_rpc1, 
                    target.cpcu_rpc2=src.cpcu_rpc2, 
                    target.cpes_1=src.cpes_1, 
                    target.cpes_2=src.cpes_2, 
                    target.cpes_3=src.cpes_3, 
                    target.cpes_dwhc=src.cpes_dwhc, 
                    target.cpes_eam1=src.cpes_eam1, 
                    target.cpes_eam2=src.cpes_eam2, 
                    target.cpes_eam3=src.cpes_eam3, 
                    target.cpes_refc=src.cpes_refc, 
                    target.cues_1=src.cues_1, 
                    target.cues_2=src.cues_2, 
                    target.cues_3=src.cues_3, 
                    target.cues_dwhc=src.cues_dwhc, 
                    target.cues_eau1=src.cues_eau1, 
                    target.cues_eau2=src.cues_eau2, 
                    target.cues_eau3=src.cues_eau3, 
                    target.cues_refc=src.cues_refc, 
                    target.cwar=src.cwar, 
                    target.cwar_ref_compnr=src.cwar_ref_compnr, 
                    target.deleted=src.deleted, 
                    target.dptm_fcmp=src.dptm_fcmp, 
                    target.drin=src.drin, 
                    target.drin_kw=src.drin_kw, 
                    target.dris=src.dris, 
                    target.dris_kw=src.dris_kw, 
                    target.dstp=src.dstp, 
                    target.dstp_kw=src.dstp_kw, 
                    target.effn=src.effn, 
                    target.icfm=src.icfm, 
                    target.icfm_kw=src.icfm_kw, 
                    target.ippg=src.ippg, 
                    target.ippg_kw=src.ippg_kw, 
                    target.issu=src.issu, 
                    target.issu_buar=src.issu_buar, 
                    target.issu_buln=src.issu_buln, 
                    target.issu_bupc=src.issu_bupc, 
                    target.issu_butm=src.issu_butm, 
                    target.issu_buvl=src.issu_buvl, 
                    target.issu_buwg=src.issu_buwg, 
                    target.iswh=src.iswh, 
                    target.iswh_buar=src.iswh_buar, 
                    target.iswh_buln=src.iswh_buln, 
                    target.iswh_bupc=src.iswh_bupc, 
                    target.iswh_butm=src.iswh_butm, 
                    target.iswh_buvl=src.iswh_buvl, 
                    target.iswh_buwg=src.iswh_buwg, 
                    target.item_rcmp=src.item_rcmp, 
                    target.leng=src.leng, 
                    target.lpno=src.lpno, 
                    target.lsel=src.lsel, 
                    target.lsel_kw=src.lsel_kw, 
                    target.mcmd=src.mcmd, 
                    target.mcmd_kw=src.mcmd_kw, 
                    target.noun=src.noun, 
                    target.opno=src.opno, 
                    target.owns=src.owns, 
                    target.owns_kw=src.owns_kw, 
                    target.pdno=src.pdno, 
                    target.pdno_ref_compnr=src.pdno_ref_compnr, 
                    target.pono=src.pono, 
                    target.preq=src.preq, 
                    target.qbfd=src.qbfd, 
                    target.qbfd_buar=src.qbfd_buar, 
                    target.qbfd_buln=src.qbfd_buln, 
                    target.qbfd_bupc=src.qbfd_bupc, 
                    target.qbfd_butm=src.qbfd_butm, 
                    target.qbfd_buvl=src.qbfd_buvl, 
                    target.qbfd_buwg=src.qbfd_buwg, 
                    target.qqar=src.qqar, 
                    target.qqar_buar=src.qqar_buar, 
                    target.qqar_buln=src.qqar_buln, 
                    target.qqar_bupc=src.qqar_bupc, 
                    target.qqar_butm=src.qqar_butm, 
                    target.qqar_buvl=src.qqar_buvl, 
                    target.qqar_buwg=src.qqar_buwg, 
                    target.qqur=src.qqur, 
                    target.qscr=src.qscr, 
                    target.qscr_buar=src.qscr_buar, 
                    target.qscr_buln=src.qscr_buln, 
                    target.qscr_bupc=src.qscr_bupc, 
                    target.qscr_butm=src.qscr_butm, 
                    target.qscr_buvl=src.qscr_buvl, 
                    target.qscr_buwg=src.qscr_buwg, 
                    target.qspl=src.qspl, 
                    target.qtor=src.qtor, 
                    target.qtor_buar=src.qtor_buar, 
                    target.qtor_buln=src.qtor_buln, 
                    target.qtor_bupc=src.qtor_bupc, 
                    target.qtor_butm=src.qtor_butm, 
                    target.qtor_buvl=src.qtor_buvl, 
                    target.qtor_buwg=src.qtor_buwg, 
                    target.qucs=src.qucs, 
                    target.qucs_buar=src.qucs_buar, 
                    target.qucs_buln=src.qucs_buln, 
                    target.qucs_bupc=src.qucs_bupc, 
                    target.qucs_butm=src.qucs_butm, 
                    target.qucs_buvl=src.qucs_buvl, 
                    target.qucs_buwg=src.qucs_buwg, 
                    target.ques=src.ques, 
                    target.ques_buar=src.ques_buar, 
                    target.ques_buln=src.ques_buln, 
                    target.ques_bupc=src.ques_bupc, 
                    target.ques_butm=src.ques_butm, 
                    target.ques_buvl=src.ques_buvl, 
                    target.ques_buwg=src.ques_buwg, 
                    target.qune=src.qune, 
                    target.qune_buar=src.qune_buar, 
                    target.qune_buln=src.qune_buln, 
                    target.qune_bupc=src.qune_bupc, 
                    target.qune_butm=src.qune_butm, 
                    target.qune_buvl=src.qune_buvl, 
                    target.qune_buwg=src.qune_buwg, 
                    target.rdsp=src.rdsp, 
                    target.rdsp_kw=src.rdsp_kw, 
                    target.revi=src.revi, 
                    target.revn=src.revn, 
                    target.rtas=src.rtas, 
                    target.rtas_kw=src.rtas_kw, 
                    target.rwit=src.rwit, 
                    target.rwit_kw=src.rwit_kw, 
                    target.sayn=src.sayn, 
                    target.sayn_kw=src.sayn_kw, 
                    target.sbsr=src.sbsr, 
                    target.sbsr_kw=src.sbsr_kw, 
                    target.scdl=src.scdl, 
                    target.scpf=src.scpf, 
                    target.scpq=src.scpq, 
                    target.scpq_buar=src.scpq_buar, 
                    target.scpq_buln=src.scpq_buln, 
                    target.scpq_bupc=src.scpq_bupc, 
                    target.scpq_butm=src.scpq_butm, 
                    target.scpq_buvl=src.scpq_buvl, 
                    target.scpq_buwg=src.scpq_buwg, 
                    target.sequencenumber=src.sequencenumber, 
                    target.sitm=src.sitm, 
                    target.sitm_ref_compnr=src.sitm_ref_compnr, 
                    target.sizu=src.sizu, 
                    target.sizu_ref_compnr=src.sizu_ref_compnr, 
                    target.spcn=src.spcn, 
                    target.subc=src.subc, 
                    target.subc_kw=src.subc_kw, 
                    target.subd=src.subd, 
                    target.subd_buar=src.subd_buar, 
                    target.subd_buln=src.subd_buln, 
                    target.subd_bupc=src.subd_bupc, 
                    target.subd_butm=src.subd_butm, 
                    target.subd_buvl=src.subd_buvl, 
                    target.subd_buwg=src.subd_buwg, 
                    target.timestamp=src.timestamp, 
                    target.txta=src.txta, 
                    target.txta_ref_compnr=src.txta_ref_compnr, 
                    target.username=src.username, 
                    target.widt=src.widt, 
                    target.ETL_SEQUENCE_NUMBER=src.ETL_SEQUENCE_NUMBER,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename
        when not matched and (src.ETL_DELETED=FALSE OR src.ETL_DELETED IS NULL)  then insert ( 
                    aamt_1, 
                    aamt_2, 
                    aamt_3, 
                    aamt_dwhc, 
                    aamt_lclc, 
                    aamt_refc, 
                    aamt_rpc1, 
                    aamt_rpc2, 
                    aamu_1, 
                    aamu_2, 
                    aamu_3, 
                    aamu_dwhc, 
                    aamu_lclc, 
                    aamu_refc, 
                    aamu_rpc1, 
                    aamu_rpc2, 
                    aldt, 
                    alfp, 
                    almi, 
                    almi_kw, 
                    altp, 
                    altp_kw, 
                    alty, 
                    alty_kw, 
                    ames_dwhc, 
                    ames_lclc, 
                    ames_refc, 
                    ames_rpc1, 
                    ames_rpc2, 
                    aues_dwhc, 
                    aues_lclc, 
                    aues_refc, 
                    aues_rpc1, 
                    aues_rpc2, 
                    bfls, 
                    bfls_kw, 
                    bmdl, 
                    bmit, 
                    bmrv, 
                    boun, 
                    boun_ref_compnr, 
                    bpon, 
                    bseq, 
                    bwar, 
                    bwar_ref_compnr, 
                    cctt, 
                    cctt_kw, 
                    ccur, 
                    ccur_ref_compnr, 
                    clot, 
                    compnr, 
                    cpcs_1, 
                    cpcs_2, 
                    cpcs_3, 
                    cpcs_dwhc, 
                    cpcs_lclc, 
                    cpcs_refc, 
                    cpcs_rpc1, 
                    cpcs_rpc2, 
                    cpcu_1, 
                    cpcu_2, 
                    cpcu_3, 
                    cpcu_dwhc, 
                    cpcu_lclc, 
                    cpcu_refc, 
                    cpcu_rpc1, 
                    cpcu_rpc2, 
                    cpes_1, 
                    cpes_2, 
                    cpes_3, 
                    cpes_dwhc, 
                    cpes_eam1, 
                    cpes_eam2, 
                    cpes_eam3, 
                    cpes_refc, 
                    cues_1, 
                    cues_2, 
                    cues_3, 
                    cues_dwhc, 
                    cues_eau1, 
                    cues_eau2, 
                    cues_eau3, 
                    cues_refc, 
                    cwar, 
                    cwar_ref_compnr, 
                    deleted, 
                    dptm_fcmp, 
                    drin, 
                    drin_kw, 
                    dris, 
                    dris_kw, 
                    dstp, 
                    dstp_kw, 
                    effn, 
                    icfm, 
                    icfm_kw, 
                    ippg, 
                    ippg_kw, 
                    issu, 
                    issu_buar, 
                    issu_buln, 
                    issu_bupc, 
                    issu_butm, 
                    issu_buvl, 
                    issu_buwg, 
                    iswh, 
                    iswh_buar, 
                    iswh_buln, 
                    iswh_bupc, 
                    iswh_butm, 
                    iswh_buvl, 
                    iswh_buwg, 
                    item_rcmp, 
                    leng, 
                    lpno, 
                    lsel, 
                    lsel_kw, 
                    mcmd, 
                    mcmd_kw, 
                    noun, 
                    opno, 
                    owns, 
                    owns_kw, 
                    pdno, 
                    pdno_ref_compnr, 
                    pono, 
                    preq, 
                    qbfd, 
                    qbfd_buar, 
                    qbfd_buln, 
                    qbfd_bupc, 
                    qbfd_butm, 
                    qbfd_buvl, 
                    qbfd_buwg, 
                    qqar, 
                    qqar_buar, 
                    qqar_buln, 
                    qqar_bupc, 
                    qqar_butm, 
                    qqar_buvl, 
                    qqar_buwg, 
                    qqur, 
                    qscr, 
                    qscr_buar, 
                    qscr_buln, 
                    qscr_bupc, 
                    qscr_butm, 
                    qscr_buvl, 
                    qscr_buwg, 
                    qspl, 
                    qtor, 
                    qtor_buar, 
                    qtor_buln, 
                    qtor_bupc, 
                    qtor_butm, 
                    qtor_buvl, 
                    qtor_buwg, 
                    qucs, 
                    qucs_buar, 
                    qucs_buln, 
                    qucs_bupc, 
                    qucs_butm, 
                    qucs_buvl, 
                    qucs_buwg, 
                    ques, 
                    ques_buar, 
                    ques_buln, 
                    ques_bupc, 
                    ques_butm, 
                    ques_buvl, 
                    ques_buwg, 
                    qune, 
                    qune_buar, 
                    qune_buln, 
                    qune_bupc, 
                    qune_butm, 
                    qune_buvl, 
                    qune_buwg, 
                    rdsp, 
                    rdsp_kw, 
                    revi, 
                    revn, 
                    rtas, 
                    rtas_kw, 
                    rwit, 
                    rwit_kw, 
                    sayn, 
                    sayn_kw, 
                    sbsr, 
                    sbsr_kw, 
                    scdl, 
                    scpf, 
                    scpq, 
                    scpq_buar, 
                    scpq_buln, 
                    scpq_bupc, 
                    scpq_butm, 
                    scpq_buvl, 
                    scpq_buwg, 
                    sequencenumber, 
                    sitm, 
                    sitm_ref_compnr, 
                    sizu, 
                    sizu_ref_compnr, 
                    spcn, 
                    subc, 
                    subc_kw, 
                    subd, 
                    subd_buar, 
                    subd_buln, 
                    subd_bupc, 
                    subd_butm, 
                    subd_buvl, 
                    subd_buwg, 
                    timestamp, 
                    txta, 
                    txta_ref_compnr, 
                    username, 
                    widt, 
                    ETL_SEQUENCE_NUMBER,                       
                    etl_load_datetime,
                    etl_load_metadatafilename) 
            values (
                    src.aamt_1, 
                    src.aamt_2, 
                    src.aamt_3, 
                    src.aamt_dwhc, 
                    src.aamt_lclc, 
                    src.aamt_refc, 
                    src.aamt_rpc1, 
                    src.aamt_rpc2, 
                    src.aamu_1, 
                    src.aamu_2, 
                    src.aamu_3, 
                    src.aamu_dwhc, 
                    src.aamu_lclc, 
                    src.aamu_refc, 
                    src.aamu_rpc1, 
                    src.aamu_rpc2, 
                    src.aldt, 
                    src.alfp, 
                    src.almi, 
                    src.almi_kw, 
                    src.altp, 
                    src.altp_kw, 
                    src.alty, 
                    src.alty_kw, 
                    src.ames_dwhc, 
                    src.ames_lclc, 
                    src.ames_refc, 
                    src.ames_rpc1, 
                    src.ames_rpc2, 
                    src.aues_dwhc, 
                    src.aues_lclc, 
                    src.aues_refc, 
                    src.aues_rpc1, 
                    src.aues_rpc2, 
                    src.bfls, 
                    src.bfls_kw, 
                    src.bmdl, 
                    src.bmit, 
                    src.bmrv, 
                    src.boun, 
                    src.boun_ref_compnr, 
                    src.bpon, 
                    src.bseq, 
                    src.bwar, 
                    src.bwar_ref_compnr, 
                    src.cctt, 
                    src.cctt_kw, 
                    src.ccur, 
                    src.ccur_ref_compnr, 
                    src.clot, 
                    src.compnr, 
                    src.cpcs_1, 
                    src.cpcs_2, 
                    src.cpcs_3, 
                    src.cpcs_dwhc, 
                    src.cpcs_lclc, 
                    src.cpcs_refc, 
                    src.cpcs_rpc1, 
                    src.cpcs_rpc2, 
                    src.cpcu_1, 
                    src.cpcu_2, 
                    src.cpcu_3, 
                    src.cpcu_dwhc, 
                    src.cpcu_lclc, 
                    src.cpcu_refc, 
                    src.cpcu_rpc1, 
                    src.cpcu_rpc2, 
                    src.cpes_1, 
                    src.cpes_2, 
                    src.cpes_3, 
                    src.cpes_dwhc, 
                    src.cpes_eam1, 
                    src.cpes_eam2, 
                    src.cpes_eam3, 
                    src.cpes_refc, 
                    src.cues_1, 
                    src.cues_2, 
                    src.cues_3, 
                    src.cues_dwhc, 
                    src.cues_eau1, 
                    src.cues_eau2, 
                    src.cues_eau3, 
                    src.cues_refc, 
                    src.cwar, 
                    src.cwar_ref_compnr, 
                    src.deleted, 
                    src.dptm_fcmp, 
                    src.drin, 
                    src.drin_kw, 
                    src.dris, 
                    src.dris_kw, 
                    src.dstp, 
                    src.dstp_kw, 
                    src.effn, 
                    src.icfm, 
                    src.icfm_kw, 
                    src.ippg, 
                    src.ippg_kw, 
                    src.issu, 
                    src.issu_buar, 
                    src.issu_buln, 
                    src.issu_bupc, 
                    src.issu_butm, 
                    src.issu_buvl, 
                    src.issu_buwg, 
                    src.iswh, 
                    src.iswh_buar, 
                    src.iswh_buln, 
                    src.iswh_bupc, 
                    src.iswh_butm, 
                    src.iswh_buvl, 
                    src.iswh_buwg, 
                    src.item_rcmp, 
                    src.leng, 
                    src.lpno, 
                    src.lsel, 
                    src.lsel_kw, 
                    src.mcmd, 
                    src.mcmd_kw, 
                    src.noun, 
                    src.opno, 
                    src.owns, 
                    src.owns_kw, 
                    src.pdno, 
                    src.pdno_ref_compnr, 
                    src.pono, 
                    src.preq, 
                    src.qbfd, 
                    src.qbfd_buar, 
                    src.qbfd_buln, 
                    src.qbfd_bupc, 
                    src.qbfd_butm, 
                    src.qbfd_buvl, 
                    src.qbfd_buwg, 
                    src.qqar, 
                    src.qqar_buar, 
                    src.qqar_buln, 
                    src.qqar_bupc, 
                    src.qqar_butm, 
                    src.qqar_buvl, 
                    src.qqar_buwg, 
                    src.qqur, 
                    src.qscr, 
                    src.qscr_buar, 
                    src.qscr_buln, 
                    src.qscr_bupc, 
                    src.qscr_butm, 
                    src.qscr_buvl, 
                    src.qscr_buwg, 
                    src.qspl, 
                    src.qtor, 
                    src.qtor_buar, 
                    src.qtor_buln, 
                    src.qtor_bupc, 
                    src.qtor_butm, 
                    src.qtor_buvl, 
                    src.qtor_buwg, 
                    src.qucs, 
                    src.qucs_buar, 
                    src.qucs_buln, 
                    src.qucs_bupc, 
                    src.qucs_butm, 
                    src.qucs_buvl, 
                    src.qucs_buwg, 
                    src.ques, 
                    src.ques_buar, 
                    src.ques_buln, 
                    src.ques_bupc, 
                    src.ques_butm, 
                    src.ques_buvl, 
                    src.ques_buwg, 
                    src.qune, 
                    src.qune_buar, 
                    src.qune_buln, 
                    src.qune_bupc, 
                    src.qune_butm, 
                    src.qune_buvl, 
                    src.qune_buwg, 
                    src.rdsp, 
                    src.rdsp_kw, 
                    src.revi, 
                    src.revn, 
                    src.rtas, 
                    src.rtas_kw, 
                    src.rwit, 
                    src.rwit_kw, 
                    src.sayn, 
                    src.sayn_kw, 
                    src.sbsr, 
                    src.sbsr_kw, 
                    src.scdl, 
                    src.scpf, 
                    src.scpq, 
                    src.scpq_buar, 
                    src.scpq_buln, 
                    src.scpq_bupc, 
                    src.scpq_butm, 
                    src.scpq_buvl, 
                    src.scpq_buwg, 
                    src.sequencenumber, 
                    src.sitm, 
                    src.sitm_ref_compnr, 
                    src.sizu, 
                    src.sizu_ref_compnr, 
                    src.spcn, 
                    src.subc, 
                    src.subc_kw, 
                    src.subd, 
                    src.subd_buar, 
                    src.subd_buln, 
                    src.subd_bupc, 
                    src.subd_butm, 
                    src.subd_buvl, 
                    src.subd_buwg, 
                    src.timestamp, 
                    src.txta, 
                    src.txta_ref_compnr, 
                    src.username, 
                    src.widt,     
                    src.ETL_SEQUENCE_NUMBER,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename);`;

    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();

    snowflake.execute( {sqlText: `merge into TARGET_HISTORY_LN.LN_TICST001_DELETED as target using (
                SELECT * FROM (SELECT 
            strm.aamt_1, 
            strm.aamt_2, 
            strm.aamt_3, 
            strm.aamt_dwhc, 
            strm.aamt_lclc, 
            strm.aamt_refc, 
            strm.aamt_rpc1, 
            strm.aamt_rpc2, 
            strm.aamu_1, 
            strm.aamu_2, 
            strm.aamu_3, 
            strm.aamu_dwhc, 
            strm.aamu_lclc, 
            strm.aamu_refc, 
            strm.aamu_rpc1, 
            strm.aamu_rpc2, 
            strm.aldt, 
            strm.alfp, 
            strm.almi, 
            strm.almi_kw, 
            strm.altp, 
            strm.altp_kw, 
            strm.alty, 
            strm.alty_kw, 
            strm.ames_dwhc, 
            strm.ames_lclc, 
            strm.ames_refc, 
            strm.ames_rpc1, 
            strm.ames_rpc2, 
            strm.aues_dwhc, 
            strm.aues_lclc, 
            strm.aues_refc, 
            strm.aues_rpc1, 
            strm.aues_rpc2, 
            strm.bfls, 
            strm.bfls_kw, 
            strm.bmdl, 
            strm.bmit, 
            strm.bmrv, 
            strm.boun, 
            strm.boun_ref_compnr, 
            strm.bpon, 
            strm.bseq, 
            strm.bwar, 
            strm.bwar_ref_compnr, 
            strm.cctt, 
            strm.cctt_kw, 
            strm.ccur, 
            strm.ccur_ref_compnr, 
            strm.clot, 
            strm.compnr, 
            strm.cpcs_1, 
            strm.cpcs_2, 
            strm.cpcs_3, 
            strm.cpcs_dwhc, 
            strm.cpcs_lclc, 
            strm.cpcs_refc, 
            strm.cpcs_rpc1, 
            strm.cpcs_rpc2, 
            strm.cpcu_1, 
            strm.cpcu_2, 
            strm.cpcu_3, 
            strm.cpcu_dwhc, 
            strm.cpcu_lclc, 
            strm.cpcu_refc, 
            strm.cpcu_rpc1, 
            strm.cpcu_rpc2, 
            strm.cpes_1, 
            strm.cpes_2, 
            strm.cpes_3, 
            strm.cpes_dwhc, 
            strm.cpes_eam1, 
            strm.cpes_eam2, 
            strm.cpes_eam3, 
            strm.cpes_refc, 
            strm.cues_1, 
            strm.cues_2, 
            strm.cues_3, 
            strm.cues_dwhc, 
            strm.cues_eau1, 
            strm.cues_eau2, 
            strm.cues_eau3, 
            strm.cues_refc, 
            strm.cwar, 
            strm.cwar_ref_compnr, 
            strm.deleted, 
            strm.dptm_fcmp, 
            strm.drin, 
            strm.drin_kw, 
            strm.dris, 
            strm.dris_kw, 
            strm.dstp, 
            strm.dstp_kw, 
            strm.effn, 
            strm.icfm, 
            strm.icfm_kw, 
            strm.ippg, 
            strm.ippg_kw, 
            strm.issu, 
            strm.issu_buar, 
            strm.issu_buln, 
            strm.issu_bupc, 
            strm.issu_butm, 
            strm.issu_buvl, 
            strm.issu_buwg, 
            strm.iswh, 
            strm.iswh_buar, 
            strm.iswh_buln, 
            strm.iswh_bupc, 
            strm.iswh_butm, 
            strm.iswh_buvl, 
            strm.iswh_buwg, 
            strm.item_rcmp, 
            strm.leng, 
            strm.lpno, 
            strm.lsel, 
            strm.lsel_kw, 
            strm.mcmd, 
            strm.mcmd_kw, 
            strm.noun, 
            strm.opno, 
            strm.owns, 
            strm.owns_kw, 
            strm.pdno, 
            strm.pdno_ref_compnr, 
            strm.pono, 
            strm.preq, 
            strm.qbfd, 
            strm.qbfd_buar, 
            strm.qbfd_buln, 
            strm.qbfd_bupc, 
            strm.qbfd_butm, 
            strm.qbfd_buvl, 
            strm.qbfd_buwg, 
            strm.qqar, 
            strm.qqar_buar, 
            strm.qqar_buln, 
            strm.qqar_bupc, 
            strm.qqar_butm, 
            strm.qqar_buvl, 
            strm.qqar_buwg, 
            strm.qqur, 
            strm.qscr, 
            strm.qscr_buar, 
            strm.qscr_buln, 
            strm.qscr_bupc, 
            strm.qscr_butm, 
            strm.qscr_buvl, 
            strm.qscr_buwg, 
            strm.qspl, 
            strm.qtor, 
            strm.qtor_buar, 
            strm.qtor_buln, 
            strm.qtor_bupc, 
            strm.qtor_butm, 
            strm.qtor_buvl, 
            strm.qtor_buwg, 
            strm.qucs, 
            strm.qucs_buar, 
            strm.qucs_buln, 
            strm.qucs_bupc, 
            strm.qucs_butm, 
            strm.qucs_buvl, 
            strm.qucs_buwg, 
            strm.ques, 
            strm.ques_buar, 
            strm.ques_buln, 
            strm.ques_bupc, 
            strm.ques_butm, 
            strm.ques_buvl, 
            strm.ques_buwg, 
            strm.qune, 
            strm.qune_buar, 
            strm.qune_buln, 
            strm.qune_bupc, 
            strm.qune_butm, 
            strm.qune_buvl, 
            strm.qune_buwg, 
            strm.rdsp, 
            strm.rdsp_kw, 
            strm.revi, 
            strm.revn, 
            strm.rtas, 
            strm.rtas_kw, 
            strm.rwit, 
            strm.rwit_kw, 
            strm.sayn, 
            strm.sayn_kw, 
            strm.sbsr, 
            strm.sbsr_kw, 
            strm.scdl, 
            strm.scpf, 
            strm.scpq, 
            strm.scpq_buar, 
            strm.scpq_buln, 
            strm.scpq_bupc, 
            strm.scpq_butm, 
            strm.scpq_buvl, 
            strm.scpq_buwg, 
            strm.sequencenumber, 
            strm.sitm, 
            strm.sitm_ref_compnr, 
            strm.sizu, 
            strm.sizu_ref_compnr, 
            strm.spcn, 
            strm.subc, 
            strm.subc_kw, 
            strm.subd, 
            strm.subd_buar, 
            strm.subd_buln, 
            strm.subd_bupc, 
            strm.subd_butm, 
            strm.subd_buvl, 
            strm.subd_buwg, 
            strm.timestamp, 
            strm.txta, 
            strm.txta_ref_compnr, 
            strm.username, 
            strm.widt, 
            strm.ETL_SEQUENCE_NUMBER,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.compnr,
            strm.pdno,
            strm.pono ORDER BY strm.ETL_SEQUENCE_NUMBER desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_LN_TICST001 as  strm
        WHERE strm.ETL_DELETED=TRUE
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.compnr=src.compnr) OR (target.compnr IS NULL AND src.compnr IS NULL)) AND
            ((target.pdno=src.pdno) OR (target.pdno IS NULL AND src.pdno IS NULL)) AND
            ((target.pono=src.pono) OR (target.pono IS NULL AND src.pono IS NULL)) 
                when matched then update set
                    target.aamt_1=src.aamt_1, 
                    target.aamt_2=src.aamt_2, 
                    target.aamt_3=src.aamt_3, 
                    target.aamt_dwhc=src.aamt_dwhc, 
                    target.aamt_lclc=src.aamt_lclc, 
                    target.aamt_refc=src.aamt_refc, 
                    target.aamt_rpc1=src.aamt_rpc1, 
                    target.aamt_rpc2=src.aamt_rpc2, 
                    target.aamu_1=src.aamu_1, 
                    target.aamu_2=src.aamu_2, 
                    target.aamu_3=src.aamu_3, 
                    target.aamu_dwhc=src.aamu_dwhc, 
                    target.aamu_lclc=src.aamu_lclc, 
                    target.aamu_refc=src.aamu_refc, 
                    target.aamu_rpc1=src.aamu_rpc1, 
                    target.aamu_rpc2=src.aamu_rpc2, 
                    target.aldt=src.aldt, 
                    target.alfp=src.alfp, 
                    target.almi=src.almi, 
                    target.almi_kw=src.almi_kw, 
                    target.altp=src.altp, 
                    target.altp_kw=src.altp_kw, 
                    target.alty=src.alty, 
                    target.alty_kw=src.alty_kw, 
                    target.ames_dwhc=src.ames_dwhc, 
                    target.ames_lclc=src.ames_lclc, 
                    target.ames_refc=src.ames_refc, 
                    target.ames_rpc1=src.ames_rpc1, 
                    target.ames_rpc2=src.ames_rpc2, 
                    target.aues_dwhc=src.aues_dwhc, 
                    target.aues_lclc=src.aues_lclc, 
                    target.aues_refc=src.aues_refc, 
                    target.aues_rpc1=src.aues_rpc1, 
                    target.aues_rpc2=src.aues_rpc2, 
                    target.bfls=src.bfls, 
                    target.bfls_kw=src.bfls_kw, 
                    target.bmdl=src.bmdl, 
                    target.bmit=src.bmit, 
                    target.bmrv=src.bmrv, 
                    target.boun=src.boun, 
                    target.boun_ref_compnr=src.boun_ref_compnr, 
                    target.bpon=src.bpon, 
                    target.bseq=src.bseq, 
                    target.bwar=src.bwar, 
                    target.bwar_ref_compnr=src.bwar_ref_compnr, 
                    target.cctt=src.cctt, 
                    target.cctt_kw=src.cctt_kw, 
                    target.ccur=src.ccur, 
                    target.ccur_ref_compnr=src.ccur_ref_compnr, 
                    target.clot=src.clot, 
                    target.compnr=src.compnr, 
                    target.cpcs_1=src.cpcs_1, 
                    target.cpcs_2=src.cpcs_2, 
                    target.cpcs_3=src.cpcs_3, 
                    target.cpcs_dwhc=src.cpcs_dwhc, 
                    target.cpcs_lclc=src.cpcs_lclc, 
                    target.cpcs_refc=src.cpcs_refc, 
                    target.cpcs_rpc1=src.cpcs_rpc1, 
                    target.cpcs_rpc2=src.cpcs_rpc2, 
                    target.cpcu_1=src.cpcu_1, 
                    target.cpcu_2=src.cpcu_2, 
                    target.cpcu_3=src.cpcu_3, 
                    target.cpcu_dwhc=src.cpcu_dwhc, 
                    target.cpcu_lclc=src.cpcu_lclc, 
                    target.cpcu_refc=src.cpcu_refc, 
                    target.cpcu_rpc1=src.cpcu_rpc1, 
                    target.cpcu_rpc2=src.cpcu_rpc2, 
                    target.cpes_1=src.cpes_1, 
                    target.cpes_2=src.cpes_2, 
                    target.cpes_3=src.cpes_3, 
                    target.cpes_dwhc=src.cpes_dwhc, 
                    target.cpes_eam1=src.cpes_eam1, 
                    target.cpes_eam2=src.cpes_eam2, 
                    target.cpes_eam3=src.cpes_eam3, 
                    target.cpes_refc=src.cpes_refc, 
                    target.cues_1=src.cues_1, 
                    target.cues_2=src.cues_2, 
                    target.cues_3=src.cues_3, 
                    target.cues_dwhc=src.cues_dwhc, 
                    target.cues_eau1=src.cues_eau1, 
                    target.cues_eau2=src.cues_eau2, 
                    target.cues_eau3=src.cues_eau3, 
                    target.cues_refc=src.cues_refc, 
                    target.cwar=src.cwar, 
                    target.cwar_ref_compnr=src.cwar_ref_compnr, 
                    target.deleted=src.deleted, 
                    target.dptm_fcmp=src.dptm_fcmp, 
                    target.drin=src.drin, 
                    target.drin_kw=src.drin_kw, 
                    target.dris=src.dris, 
                    target.dris_kw=src.dris_kw, 
                    target.dstp=src.dstp, 
                    target.dstp_kw=src.dstp_kw, 
                    target.effn=src.effn, 
                    target.icfm=src.icfm, 
                    target.icfm_kw=src.icfm_kw, 
                    target.ippg=src.ippg, 
                    target.ippg_kw=src.ippg_kw, 
                    target.issu=src.issu, 
                    target.issu_buar=src.issu_buar, 
                    target.issu_buln=src.issu_buln, 
                    target.issu_bupc=src.issu_bupc, 
                    target.issu_butm=src.issu_butm, 
                    target.issu_buvl=src.issu_buvl, 
                    target.issu_buwg=src.issu_buwg, 
                    target.iswh=src.iswh, 
                    target.iswh_buar=src.iswh_buar, 
                    target.iswh_buln=src.iswh_buln, 
                    target.iswh_bupc=src.iswh_bupc, 
                    target.iswh_butm=src.iswh_butm, 
                    target.iswh_buvl=src.iswh_buvl, 
                    target.iswh_buwg=src.iswh_buwg, 
                    target.item_rcmp=src.item_rcmp, 
                    target.leng=src.leng, 
                    target.lpno=src.lpno, 
                    target.lsel=src.lsel, 
                    target.lsel_kw=src.lsel_kw, 
                    target.mcmd=src.mcmd, 
                    target.mcmd_kw=src.mcmd_kw, 
                    target.noun=src.noun, 
                    target.opno=src.opno, 
                    target.owns=src.owns, 
                    target.owns_kw=src.owns_kw, 
                    target.pdno=src.pdno, 
                    target.pdno_ref_compnr=src.pdno_ref_compnr, 
                    target.pono=src.pono, 
                    target.preq=src.preq, 
                    target.qbfd=src.qbfd, 
                    target.qbfd_buar=src.qbfd_buar, 
                    target.qbfd_buln=src.qbfd_buln, 
                    target.qbfd_bupc=src.qbfd_bupc, 
                    target.qbfd_butm=src.qbfd_butm, 
                    target.qbfd_buvl=src.qbfd_buvl, 
                    target.qbfd_buwg=src.qbfd_buwg, 
                    target.qqar=src.qqar, 
                    target.qqar_buar=src.qqar_buar, 
                    target.qqar_buln=src.qqar_buln, 
                    target.qqar_bupc=src.qqar_bupc, 
                    target.qqar_butm=src.qqar_butm, 
                    target.qqar_buvl=src.qqar_buvl, 
                    target.qqar_buwg=src.qqar_buwg, 
                    target.qqur=src.qqur, 
                    target.qscr=src.qscr, 
                    target.qscr_buar=src.qscr_buar, 
                    target.qscr_buln=src.qscr_buln, 
                    target.qscr_bupc=src.qscr_bupc, 
                    target.qscr_butm=src.qscr_butm, 
                    target.qscr_buvl=src.qscr_buvl, 
                    target.qscr_buwg=src.qscr_buwg, 
                    target.qspl=src.qspl, 
                    target.qtor=src.qtor, 
                    target.qtor_buar=src.qtor_buar, 
                    target.qtor_buln=src.qtor_buln, 
                    target.qtor_bupc=src.qtor_bupc, 
                    target.qtor_butm=src.qtor_butm, 
                    target.qtor_buvl=src.qtor_buvl, 
                    target.qtor_buwg=src.qtor_buwg, 
                    target.qucs=src.qucs, 
                    target.qucs_buar=src.qucs_buar, 
                    target.qucs_buln=src.qucs_buln, 
                    target.qucs_bupc=src.qucs_bupc, 
                    target.qucs_butm=src.qucs_butm, 
                    target.qucs_buvl=src.qucs_buvl, 
                    target.qucs_buwg=src.qucs_buwg, 
                    target.ques=src.ques, 
                    target.ques_buar=src.ques_buar, 
                    target.ques_buln=src.ques_buln, 
                    target.ques_bupc=src.ques_bupc, 
                    target.ques_butm=src.ques_butm, 
                    target.ques_buvl=src.ques_buvl, 
                    target.ques_buwg=src.ques_buwg, 
                    target.qune=src.qune, 
                    target.qune_buar=src.qune_buar, 
                    target.qune_buln=src.qune_buln, 
                    target.qune_bupc=src.qune_bupc, 
                    target.qune_butm=src.qune_butm, 
                    target.qune_buvl=src.qune_buvl, 
                    target.qune_buwg=src.qune_buwg, 
                    target.rdsp=src.rdsp, 
                    target.rdsp_kw=src.rdsp_kw, 
                    target.revi=src.revi, 
                    target.revn=src.revn, 
                    target.rtas=src.rtas, 
                    target.rtas_kw=src.rtas_kw, 
                    target.rwit=src.rwit, 
                    target.rwit_kw=src.rwit_kw, 
                    target.sayn=src.sayn, 
                    target.sayn_kw=src.sayn_kw, 
                    target.sbsr=src.sbsr, 
                    target.sbsr_kw=src.sbsr_kw, 
                    target.scdl=src.scdl, 
                    target.scpf=src.scpf, 
                    target.scpq=src.scpq, 
                    target.scpq_buar=src.scpq_buar, 
                    target.scpq_buln=src.scpq_buln, 
                    target.scpq_bupc=src.scpq_bupc, 
                    target.scpq_butm=src.scpq_butm, 
                    target.scpq_buvl=src.scpq_buvl, 
                    target.scpq_buwg=src.scpq_buwg, 
                    target.sequencenumber=src.sequencenumber, 
                    target.sitm=src.sitm, 
                    target.sitm_ref_compnr=src.sitm_ref_compnr, 
                    target.sizu=src.sizu, 
                    target.sizu_ref_compnr=src.sizu_ref_compnr, 
                    target.spcn=src.spcn, 
                    target.subc=src.subc, 
                    target.subc_kw=src.subc_kw, 
                    target.subd=src.subd, 
                    target.subd_buar=src.subd_buar, 
                    target.subd_buln=src.subd_buln, 
                    target.subd_bupc=src.subd_bupc, 
                    target.subd_butm=src.subd_butm, 
                    target.subd_buvl=src.subd_buvl, 
                    target.subd_buwg=src.subd_buwg, 
                    target.timestamp=src.timestamp, 
                    target.txta=src.txta, 
                    target.txta_ref_compnr=src.txta_ref_compnr, 
                    target.username=src.username, 
                    target.widt=src.widt, 
                    target.ETL_SEQUENCE_NUMBER=src.ETL_SEQUENCE_NUMBER,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename,
                    target.ETL_DELETED=src.ETL_DELETED
        when not matched   then insert ( aamt_1, aamt_2, aamt_3, aamt_dwhc, aamt_lclc, aamt_refc, aamt_rpc1, aamt_rpc2, aamu_1, aamu_2, aamu_3, aamu_dwhc, aamu_lclc, aamu_refc, aamu_rpc1, aamu_rpc2, aldt, alfp, almi, almi_kw, altp, altp_kw, alty, alty_kw, ames_dwhc, ames_lclc, ames_refc, ames_rpc1, ames_rpc2, aues_dwhc, aues_lclc, aues_refc, aues_rpc1, aues_rpc2, bfls, bfls_kw, bmdl, bmit, bmrv, boun, boun_ref_compnr, bpon, bseq, bwar, bwar_ref_compnr, cctt, cctt_kw, ccur, ccur_ref_compnr, clot, compnr, cpcs_1, cpcs_2, cpcs_3, cpcs_dwhc, cpcs_lclc, cpcs_refc, cpcs_rpc1, cpcs_rpc2, cpcu_1, cpcu_2, cpcu_3, cpcu_dwhc, cpcu_lclc, cpcu_refc, cpcu_rpc1, cpcu_rpc2, cpes_1, cpes_2, cpes_3, cpes_dwhc, cpes_eam1, cpes_eam2, cpes_eam3, cpes_refc, cues_1, cues_2, cues_3, cues_dwhc, cues_eau1, cues_eau2, cues_eau3, cues_refc, cwar, cwar_ref_compnr, deleted, dptm_fcmp, drin, drin_kw, dris, dris_kw, dstp, dstp_kw, effn, icfm, icfm_kw, ippg, ippg_kw, issu, issu_buar, issu_buln, issu_bupc, issu_butm, issu_buvl, issu_buwg, iswh, iswh_buar, iswh_buln, iswh_bupc, iswh_butm, iswh_buvl, iswh_buwg, item_rcmp, leng, lpno, lsel, lsel_kw, mcmd, mcmd_kw, noun, opno, owns, owns_kw, pdno, pdno_ref_compnr, pono, preq, qbfd, qbfd_buar, qbfd_buln, qbfd_bupc, qbfd_butm, qbfd_buvl, qbfd_buwg, qqar, qqar_buar, qqar_buln, qqar_bupc, qqar_butm, qqar_buvl, qqar_buwg, qqur, qscr, qscr_buar, qscr_buln, qscr_bupc, qscr_butm, qscr_buvl, qscr_buwg, qspl, qtor, qtor_buar, qtor_buln, qtor_bupc, qtor_butm, qtor_buvl, qtor_buwg, qucs, qucs_buar, qucs_buln, qucs_bupc, qucs_butm, qucs_buvl, qucs_buwg, ques, ques_buar, ques_buln, ques_bupc, ques_butm, ques_buvl, ques_buwg, qune, qune_buar, qune_buln, qune_bupc, qune_butm, qune_buvl, qune_buwg, rdsp, rdsp_kw, revi, revn, rtas, rtas_kw, rwit, rwit_kw, sayn, sayn_kw, sbsr, sbsr_kw, scdl, scpf, scpq, scpq_buar, scpq_buln, scpq_bupc, scpq_butm, scpq_buvl, scpq_buwg, sequencenumber, sitm, sitm_ref_compnr, sizu, sizu_ref_compnr, spcn, subc, subc_kw, subd, subd_buar, subd_buln, subd_bupc, subd_butm, subd_buvl, subd_buwg, timestamp, txta, txta_ref_compnr, username, widt, 
                    ETL_SEQUENCE_NUMBER,                       
                    etl_load_datetime,
                    etl_load_metadatafilename,
                    etl_is_deleted,
                    ETL_DELETED) 
            values (
                    src.aamt_1, 
                    src.aamt_2, 
                    src.aamt_3, 
                    src.aamt_dwhc, 
                    src.aamt_lclc, 
                    src.aamt_refc, 
                    src.aamt_rpc1, 
                    src.aamt_rpc2, 
                    src.aamu_1, 
                    src.aamu_2, 
                    src.aamu_3, 
                    src.aamu_dwhc, 
                    src.aamu_lclc, 
                    src.aamu_refc, 
                    src.aamu_rpc1, 
                    src.aamu_rpc2, 
                    src.aldt, 
                    src.alfp, 
                    src.almi, 
                    src.almi_kw, 
                    src.altp, 
                    src.altp_kw, 
                    src.alty, 
                    src.alty_kw, 
                    src.ames_dwhc, 
                    src.ames_lclc, 
                    src.ames_refc, 
                    src.ames_rpc1, 
                    src.ames_rpc2, 
                    src.aues_dwhc, 
                    src.aues_lclc, 
                    src.aues_refc, 
                    src.aues_rpc1, 
                    src.aues_rpc2, 
                    src.bfls, 
                    src.bfls_kw, 
                    src.bmdl, 
                    src.bmit, 
                    src.bmrv, 
                    src.boun, 
                    src.boun_ref_compnr, 
                    src.bpon, 
                    src.bseq, 
                    src.bwar, 
                    src.bwar_ref_compnr, 
                    src.cctt, 
                    src.cctt_kw, 
                    src.ccur, 
                    src.ccur_ref_compnr, 
                    src.clot, 
                    src.compnr, 
                    src.cpcs_1, 
                    src.cpcs_2, 
                    src.cpcs_3, 
                    src.cpcs_dwhc, 
                    src.cpcs_lclc, 
                    src.cpcs_refc, 
                    src.cpcs_rpc1, 
                    src.cpcs_rpc2, 
                    src.cpcu_1, 
                    src.cpcu_2, 
                    src.cpcu_3, 
                    src.cpcu_dwhc, 
                    src.cpcu_lclc, 
                    src.cpcu_refc, 
                    src.cpcu_rpc1, 
                    src.cpcu_rpc2, 
                    src.cpes_1, 
                    src.cpes_2, 
                    src.cpes_3, 
                    src.cpes_dwhc, 
                    src.cpes_eam1, 
                    src.cpes_eam2, 
                    src.cpes_eam3, 
                    src.cpes_refc, 
                    src.cues_1, 
                    src.cues_2, 
                    src.cues_3, 
                    src.cues_dwhc, 
                    src.cues_eau1, 
                    src.cues_eau2, 
                    src.cues_eau3, 
                    src.cues_refc, 
                    src.cwar, 
                    src.cwar_ref_compnr, 
                    src.deleted, 
                    src.dptm_fcmp, 
                    src.drin, 
                    src.drin_kw, 
                    src.dris, 
                    src.dris_kw, 
                    src.dstp, 
                    src.dstp_kw, 
                    src.effn, 
                    src.icfm, 
                    src.icfm_kw, 
                    src.ippg, 
                    src.ippg_kw, 
                    src.issu, 
                    src.issu_buar, 
                    src.issu_buln, 
                    src.issu_bupc, 
                    src.issu_butm, 
                    src.issu_buvl, 
                    src.issu_buwg, 
                    src.iswh, 
                    src.iswh_buar, 
                    src.iswh_buln, 
                    src.iswh_bupc, 
                    src.iswh_butm, 
                    src.iswh_buvl, 
                    src.iswh_buwg, 
                    src.item_rcmp, 
                    src.leng, 
                    src.lpno, 
                    src.lsel, 
                    src.lsel_kw, 
                    src.mcmd, 
                    src.mcmd_kw, 
                    src.noun, 
                    src.opno, 
                    src.owns, 
                    src.owns_kw, 
                    src.pdno, 
                    src.pdno_ref_compnr, 
                    src.pono, 
                    src.preq, 
                    src.qbfd, 
                    src.qbfd_buar, 
                    src.qbfd_buln, 
                    src.qbfd_bupc, 
                    src.qbfd_butm, 
                    src.qbfd_buvl, 
                    src.qbfd_buwg, 
                    src.qqar, 
                    src.qqar_buar, 
                    src.qqar_buln, 
                    src.qqar_bupc, 
                    src.qqar_butm, 
                    src.qqar_buvl, 
                    src.qqar_buwg, 
                    src.qqur, 
                    src.qscr, 
                    src.qscr_buar, 
                    src.qscr_buln, 
                    src.qscr_bupc, 
                    src.qscr_butm, 
                    src.qscr_buvl, 
                    src.qscr_buwg, 
                    src.qspl, 
                    src.qtor, 
                    src.qtor_buar, 
                    src.qtor_buln, 
                    src.qtor_bupc, 
                    src.qtor_butm, 
                    src.qtor_buvl, 
                    src.qtor_buwg, 
                    src.qucs, 
                    src.qucs_buar, 
                    src.qucs_buln, 
                    src.qucs_bupc, 
                    src.qucs_butm, 
                    src.qucs_buvl, 
                    src.qucs_buwg, 
                    src.ques, 
                    src.ques_buar, 
                    src.ques_buln, 
                    src.ques_bupc, 
                    src.ques_butm, 
                    src.ques_buvl, 
                    src.ques_buwg, 
                    src.qune, 
                    src.qune_buar, 
                    src.qune_buln, 
                    src.qune_bupc, 
                    src.qune_butm, 
                    src.qune_buvl, 
                    src.qune_buwg, 
                    src.rdsp, 
                    src.rdsp_kw, 
                    src.revi, 
                    src.revn, 
                    src.rtas, 
                    src.rtas_kw, 
                    src.rwit, 
                    src.rwit_kw, 
                    src.sayn, 
                    src.sayn_kw, 
                    src.sbsr, 
                    src.sbsr_kw, 
                    src.scdl, 
                    src.scpf, 
                    src.scpq, 
                    src.scpq_buar, 
                    src.scpq_buln, 
                    src.scpq_bupc, 
                    src.scpq_butm, 
                    src.scpq_buvl, 
                    src.scpq_buwg, 
                    src.sequencenumber, 
                    src.sitm, 
                    src.sitm_ref_compnr, 
                    src.sizu, 
                    src.sizu_ref_compnr, 
                    src.spcn, 
                    src.subc, 
                    src.subc_kw, 
                    src.subd, 
                    src.subd_buar, 
                    src.subd_buln, 
                    src.subd_bupc, 
                    src.subd_butm, 
                    src.subd_buvl, 
                    src.subd_buwg, 
                    src.timestamp, 
                    src.txta, 
                    src.txta_ref_compnr, 
                    src.username, 
                    src.widt,     
                    src.ETL_SEQUENCE_NUMBER,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename,
                    case when ETL_DELETED=TRUE then TRUE else FALSE end,
                    ETL_DELETED);
    `
} );

                    
//  Get number of rows inserted
        
        var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
        var rs = sqlStmt.execute();
        var number_of_rows_inserted = sqlStmt.getNumRowsInserted();
        var number_of_rows_updated =  sqlStmt.getNumRowsUpdated();
                    

        
    snowflake.execute ({sqlText: "commit"});

    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Success','Completed process execution.', 0 ," + number_of_rows_inserted.toString()+ "," +  number_of_rows_updated.toString() + ");";
    snowflake.execute({sqlText: log_sql_command});

    result = "Success"; 

    }       

    catch (err)  {
        snowflake.execute( {sqlText: "rollback;"} )
        var clean_error_msg = err.message.replace(/[^\w\s]/gi, '');
    //  Create a log entry to say INSERT STATEMENT failed
    
    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Failed','MERGE Failed. Error:" + err.code.toString()+" : "+ clean_error_msg  + "', 0 ,0,0);";
    snowflake.execute({sqlText: log_sql_command});
        ;
        throw "Failed: " + err.message;   // Return a success/error indicator.
        }
    return result;
    $$;