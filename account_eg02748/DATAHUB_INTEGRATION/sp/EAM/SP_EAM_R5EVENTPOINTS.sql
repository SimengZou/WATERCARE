create or replace procedure DATAHUB_INTEGRATION.SP_EAM_R5EVENTPOINTS()
    returns varchar not null
                language javascript
                as
                $$

//  Variables

var result = "";                                    // return status of this proc call
const process_name = Object.keys(this)[0];          // name of currently executing process
var number_of_rows_inserted = 0;                             // track number of rows we have inserted
var number_of_rows_updated = 0;                             // track number of rows we have updated


//  Step 1.

//  Start execution - log start

log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('Insert','" + process_name + "','Running','Started process execution.', 0,0,0);";
snowflake.execute({sqlText: log_sql_command});

snowflake.execute( {sqlText: "begin transaction;"} );
try
    {
        var sql_command = `
                            INSERT INTO LANDING_ERROR.EAM_RAW_ERROR
                            SELECT * FROM LANDING_ERROR.VW_STREAM_EAM_R5EVENTPOINTS_ERROR`;
    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();
        
        var sql_command = ` 
                            merge into  TARGET_EAM.EAM_R5EVENTPOINTS as target using (SELECT * FROM (SELECT 
            strm.EPO_ASPECT, 
            strm.EPO_ASSESSEDSLOPE, 
            strm.EPO_AVGSLOPE, 
            strm.EPO_CLASS, 
            strm.EPO_CLASS_ORG, 
            strm.EPO_CODE, 
            strm.EPO_COMMENT, 
            strm.EPO_COMPLETED, 
            strm.EPO_CONFRATING, 
            strm.EPO_CREATE, 
            strm.EPO_CREATED, 
            strm.EPO_DATE, 
            strm.EPO_EVENT, 
            strm.EPO_FINDING, 
            strm.EPO_FROMGEOREF, 
            strm.EPO_FROMPOINT, 
            strm.EPO_FROMREFDESC, 
            strm.EPO_FROM_HORIZONTAL_OFFSET, 
            strm.EPO_FROM_HORIZONTAL_OFFSETTYPE, 
            strm.EPO_FROM_HORIZONTAL_OFFSETUOM, 
            strm.EPO_FROM_LATITUDE, 
            strm.EPO_FROM_LONGITUDE, 
            strm.EPO_FROM_OFFSET, 
            strm.EPO_FROM_OFFSET_DIRECTION, 
            strm.EPO_FROM_OFFSET_PERCENTAGE, 
            strm.EPO_FROM_REFERENCE, 
            strm.EPO_FROM_RELATIONSHIP_TYPE, 
            strm.EPO_FROM_VERTICAL_OFFSET, 
            strm.EPO_FROM_VERTICAL_OFFSETTYPE, 
            strm.EPO_FROM_VERTICAL_OFFSETUOM, 
            strm.EPO_FROM_XCOORDINATE, 
            strm.EPO_FROM_YCOORDINATE, 
            strm.EPO_INSPECTOR, 
            strm.EPO_JOB, 
            strm.EPO_LASTSAVED, 
            strm.EPO_LASTSLOPE, 
            strm.EPO_LINE, 
            strm.EPO_LOCATION, 
            strm.EPO_MAX, 
            strm.EPO_MAXDATE, 
            strm.EPO_MAXPPM, 
            strm.EPO_MAXSTWO, 
            strm.EPO_MAXTOL, 
            strm.EPO_MAXTOLDATE, 
            strm.EPO_METHOD, 
            strm.EPO_MIN, 
            strm.EPO_MINDATE, 
            strm.EPO_MINPPM, 
            strm.EPO_MINSTWO, 
            strm.EPO_MINTOL, 
            strm.EPO_MINTOLDATE, 
            strm.EPO_NIDATEMAXCRIT, 
            strm.EPO_NIDATEMAXTOL, 
            strm.EPO_NIDATEMINCRIT, 
            strm.EPO_NIDATEMINTOL, 
            strm.EPO_OBJECT, 
            strm.EPO_OBJECT_ORG, 
            strm.EPO_OBRTYPE, 
            strm.EPO_OBTYPE, 
            strm.EPO_ORIGEVENT, 
            strm.EPO_PARENT, 
            strm.EPO_POINT, 
            strm.EPO_POINTTYPE, 
            strm.EPO_PROCESSED, 
            strm.EPO_RESULT, 
            strm.EPO_RISK, 
            strm.EPO_RRESULT, 
            strm.EPO_STWO, 
            strm.EPO_TOGEOREF, 
            strm.EPO_TOPOINT, 
            strm.EPO_TOREFDESC, 
            strm.EPO_TO_HORIZONTAL_OFFSET, 
            strm.EPO_TO_HORIZONTAL_OFFSETTYPE, 
            strm.EPO_TO_HORIZONTAL_OFFSETUOM, 
            strm.EPO_TO_LATITUDE, 
            strm.EPO_TO_LONGITUDE, 
            strm.EPO_TO_OFFSET, 
            strm.EPO_TO_OFFSET_DIRECTION, 
            strm.EPO_TO_OFFSET_PERCENTAGE, 
            strm.EPO_TO_REFERENCE, 
            strm.EPO_TO_RELATIONSHIP_TYPE, 
            strm.EPO_TO_VERTICAL_OFFSET, 
            strm.EPO_TO_VERTICAL_OFFSETTYPE, 
            strm.EPO_TO_VERTICAL_OFFSETUOM, 
            strm.EPO_TO_XCOORDINATE, 
            strm.EPO_TO_YCOORDINATE, 
            strm.EPO_TYPE, 
            strm.EPO_UOM, 
            strm.EPO_UPDATECOUNT, 
            strm.EPO_UPDATED, 
            strm.EPO_VALUE, 
            strm.EPO_VARCHAR1, 
            strm.EPO_VARCHAR10, 
            strm.EPO_VARCHAR11, 
            strm.EPO_VARCHAR12, 
            strm.EPO_VARCHAR13, 
            strm.EPO_VARCHAR14, 
            strm.EPO_VARCHAR15, 
            strm.EPO_VARCHAR16, 
            strm.EPO_VARCHAR17, 
            strm.EPO_VARCHAR18, 
            strm.EPO_VARCHAR19, 
            strm.EPO_VARCHAR2, 
            strm.EPO_VARCHAR20, 
            strm.EPO_VARCHAR21, 
            strm.EPO_VARCHAR22, 
            strm.EPO_VARCHAR23, 
            strm.EPO_VARCHAR24, 
            strm.EPO_VARCHAR25, 
            strm.EPO_VARCHAR26, 
            strm.EPO_VARCHAR27, 
            strm.EPO_VARCHAR28, 
            strm.EPO_VARCHAR29, 
            strm.EPO_VARCHAR3, 
            strm.EPO_VARCHAR30, 
            strm.EPO_VARCHAR31, 
            strm.EPO_VARCHAR32, 
            strm.EPO_VARCHAR33, 
            strm.EPO_VARCHAR34, 
            strm.EPO_VARCHAR35, 
            strm.EPO_VARCHAR4, 
            strm.EPO_VARCHAR5, 
            strm.EPO_VARCHAR6, 
            strm.EPO_VARCHAR7, 
            strm.EPO_VARCHAR8, 
            strm.EPO_VARCHAR9, 
            strm.EPO_VARDATE1, 
            strm.EPO_VARDATE10, 
            strm.EPO_VARDATE11, 
            strm.EPO_VARDATE12, 
            strm.EPO_VARDATE13, 
            strm.EPO_VARDATE14, 
            strm.EPO_VARDATE15, 
            strm.EPO_VARDATE2, 
            strm.EPO_VARDATE3, 
            strm.EPO_VARDATE4, 
            strm.EPO_VARDATE5, 
            strm.EPO_VARDATE6, 
            strm.EPO_VARDATE7, 
            strm.EPO_VARDATE8, 
            strm.EPO_VARDATE9, 
            strm.EPO_VARNUM1, 
            strm.EPO_VARNUM10, 
            strm.EPO_VARNUM11, 
            strm.EPO_VARNUM12, 
            strm.EPO_VARNUM13, 
            strm.EPO_VARNUM14, 
            strm.EPO_VARNUM15, 
            strm.EPO_VARNUM16, 
            strm.EPO_VARNUM17, 
            strm.EPO_VARNUM18, 
            strm.EPO_VARNUM19, 
            strm.EPO_VARNUM2, 
            strm.EPO_VARNUM20, 
            strm.EPO_VARNUM21, 
            strm.EPO_VARNUM22, 
            strm.EPO_VARNUM23, 
            strm.EPO_VARNUM24, 
            strm.EPO_VARNUM25, 
            strm.EPO_VARNUM26, 
            strm.EPO_VARNUM27, 
            strm.EPO_VARNUM28, 
            strm.EPO_VARNUM29, 
            strm.EPO_VARNUM3, 
            strm.EPO_VARNUM30, 
            strm.EPO_VARNUM31, 
            strm.EPO_VARNUM32, 
            strm.EPO_VARNUM33, 
            strm.EPO_VARNUM34, 
            strm.EPO_VARNUM35, 
            strm.EPO_VARNUM4, 
            strm.EPO_VARNUM5, 
            strm.EPO_VARNUM6, 
            strm.EPO_VARNUM7, 
            strm.EPO_VARNUM8, 
            strm.EPO_VARNUM9, 
            strm._DELETED, 
            strm.ETL_LASTSAVED,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.EPO_CODE ORDER BY strm.ETL_LASTSAVED desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_EAM_R5EVENTPOINTS as  strm
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.EPO_CODE=src.EPO_CODE) OR (target.EPO_CODE IS NULL AND src.EPO_CODE IS NULL)) 
                when matched and src.ETL_DELETED=TRUE THEN DELETE
                when matched then update set
                    target.EPO_ASPECT=src.EPO_ASPECT, 
                    target.EPO_ASSESSEDSLOPE=src.EPO_ASSESSEDSLOPE, 
                    target.EPO_AVGSLOPE=src.EPO_AVGSLOPE, 
                    target.EPO_CLASS=src.EPO_CLASS, 
                    target.EPO_CLASS_ORG=src.EPO_CLASS_ORG, 
                    target.EPO_CODE=src.EPO_CODE, 
                    target.EPO_COMMENT=src.EPO_COMMENT, 
                    target.EPO_COMPLETED=src.EPO_COMPLETED, 
                    target.EPO_CONFRATING=src.EPO_CONFRATING, 
                    target.EPO_CREATE=src.EPO_CREATE, 
                    target.EPO_CREATED=src.EPO_CREATED, 
                    target.EPO_DATE=src.EPO_DATE, 
                    target.EPO_EVENT=src.EPO_EVENT, 
                    target.EPO_FINDING=src.EPO_FINDING, 
                    target.EPO_FROMGEOREF=src.EPO_FROMGEOREF, 
                    target.EPO_FROMPOINT=src.EPO_FROMPOINT, 
                    target.EPO_FROMREFDESC=src.EPO_FROMREFDESC, 
                    target.EPO_FROM_HORIZONTAL_OFFSET=src.EPO_FROM_HORIZONTAL_OFFSET, 
                    target.EPO_FROM_HORIZONTAL_OFFSETTYPE=src.EPO_FROM_HORIZONTAL_OFFSETTYPE, 
                    target.EPO_FROM_HORIZONTAL_OFFSETUOM=src.EPO_FROM_HORIZONTAL_OFFSETUOM, 
                    target.EPO_FROM_LATITUDE=src.EPO_FROM_LATITUDE, 
                    target.EPO_FROM_LONGITUDE=src.EPO_FROM_LONGITUDE, 
                    target.EPO_FROM_OFFSET=src.EPO_FROM_OFFSET, 
                    target.EPO_FROM_OFFSET_DIRECTION=src.EPO_FROM_OFFSET_DIRECTION, 
                    target.EPO_FROM_OFFSET_PERCENTAGE=src.EPO_FROM_OFFSET_PERCENTAGE, 
                    target.EPO_FROM_REFERENCE=src.EPO_FROM_REFERENCE, 
                    target.EPO_FROM_RELATIONSHIP_TYPE=src.EPO_FROM_RELATIONSHIP_TYPE, 
                    target.EPO_FROM_VERTICAL_OFFSET=src.EPO_FROM_VERTICAL_OFFSET, 
                    target.EPO_FROM_VERTICAL_OFFSETTYPE=src.EPO_FROM_VERTICAL_OFFSETTYPE, 
                    target.EPO_FROM_VERTICAL_OFFSETUOM=src.EPO_FROM_VERTICAL_OFFSETUOM, 
                    target.EPO_FROM_XCOORDINATE=src.EPO_FROM_XCOORDINATE, 
                    target.EPO_FROM_YCOORDINATE=src.EPO_FROM_YCOORDINATE, 
                    target.EPO_INSPECTOR=src.EPO_INSPECTOR, 
                    target.EPO_JOB=src.EPO_JOB, 
                    target.EPO_LASTSAVED=src.EPO_LASTSAVED, 
                    target.EPO_LASTSLOPE=src.EPO_LASTSLOPE, 
                    target.EPO_LINE=src.EPO_LINE, 
                    target.EPO_LOCATION=src.EPO_LOCATION, 
                    target.EPO_MAX=src.EPO_MAX, 
                    target.EPO_MAXDATE=src.EPO_MAXDATE, 
                    target.EPO_MAXPPM=src.EPO_MAXPPM, 
                    target.EPO_MAXSTWO=src.EPO_MAXSTWO, 
                    target.EPO_MAXTOL=src.EPO_MAXTOL, 
                    target.EPO_MAXTOLDATE=src.EPO_MAXTOLDATE, 
                    target.EPO_METHOD=src.EPO_METHOD, 
                    target.EPO_MIN=src.EPO_MIN, 
                    target.EPO_MINDATE=src.EPO_MINDATE, 
                    target.EPO_MINPPM=src.EPO_MINPPM, 
                    target.EPO_MINSTWO=src.EPO_MINSTWO, 
                    target.EPO_MINTOL=src.EPO_MINTOL, 
                    target.EPO_MINTOLDATE=src.EPO_MINTOLDATE, 
                    target.EPO_NIDATEMAXCRIT=src.EPO_NIDATEMAXCRIT, 
                    target.EPO_NIDATEMAXTOL=src.EPO_NIDATEMAXTOL, 
                    target.EPO_NIDATEMINCRIT=src.EPO_NIDATEMINCRIT, 
                    target.EPO_NIDATEMINTOL=src.EPO_NIDATEMINTOL, 
                    target.EPO_OBJECT=src.EPO_OBJECT, 
                    target.EPO_OBJECT_ORG=src.EPO_OBJECT_ORG, 
                    target.EPO_OBRTYPE=src.EPO_OBRTYPE, 
                    target.EPO_OBTYPE=src.EPO_OBTYPE, 
                    target.EPO_ORIGEVENT=src.EPO_ORIGEVENT, 
                    target.EPO_PARENT=src.EPO_PARENT, 
                    target.EPO_POINT=src.EPO_POINT, 
                    target.EPO_POINTTYPE=src.EPO_POINTTYPE, 
                    target.EPO_PROCESSED=src.EPO_PROCESSED, 
                    target.EPO_RESULT=src.EPO_RESULT, 
                    target.EPO_RISK=src.EPO_RISK, 
                    target.EPO_RRESULT=src.EPO_RRESULT, 
                    target.EPO_STWO=src.EPO_STWO, 
                    target.EPO_TOGEOREF=src.EPO_TOGEOREF, 
                    target.EPO_TOPOINT=src.EPO_TOPOINT, 
                    target.EPO_TOREFDESC=src.EPO_TOREFDESC, 
                    target.EPO_TO_HORIZONTAL_OFFSET=src.EPO_TO_HORIZONTAL_OFFSET, 
                    target.EPO_TO_HORIZONTAL_OFFSETTYPE=src.EPO_TO_HORIZONTAL_OFFSETTYPE, 
                    target.EPO_TO_HORIZONTAL_OFFSETUOM=src.EPO_TO_HORIZONTAL_OFFSETUOM, 
                    target.EPO_TO_LATITUDE=src.EPO_TO_LATITUDE, 
                    target.EPO_TO_LONGITUDE=src.EPO_TO_LONGITUDE, 
                    target.EPO_TO_OFFSET=src.EPO_TO_OFFSET, 
                    target.EPO_TO_OFFSET_DIRECTION=src.EPO_TO_OFFSET_DIRECTION, 
                    target.EPO_TO_OFFSET_PERCENTAGE=src.EPO_TO_OFFSET_PERCENTAGE, 
                    target.EPO_TO_REFERENCE=src.EPO_TO_REFERENCE, 
                    target.EPO_TO_RELATIONSHIP_TYPE=src.EPO_TO_RELATIONSHIP_TYPE, 
                    target.EPO_TO_VERTICAL_OFFSET=src.EPO_TO_VERTICAL_OFFSET, 
                    target.EPO_TO_VERTICAL_OFFSETTYPE=src.EPO_TO_VERTICAL_OFFSETTYPE, 
                    target.EPO_TO_VERTICAL_OFFSETUOM=src.EPO_TO_VERTICAL_OFFSETUOM, 
                    target.EPO_TO_XCOORDINATE=src.EPO_TO_XCOORDINATE, 
                    target.EPO_TO_YCOORDINATE=src.EPO_TO_YCOORDINATE, 
                    target.EPO_TYPE=src.EPO_TYPE, 
                    target.EPO_UOM=src.EPO_UOM, 
                    target.EPO_UPDATECOUNT=src.EPO_UPDATECOUNT, 
                    target.EPO_UPDATED=src.EPO_UPDATED, 
                    target.EPO_VALUE=src.EPO_VALUE, 
                    target.EPO_VARCHAR1=src.EPO_VARCHAR1, 
                    target.EPO_VARCHAR10=src.EPO_VARCHAR10, 
                    target.EPO_VARCHAR11=src.EPO_VARCHAR11, 
                    target.EPO_VARCHAR12=src.EPO_VARCHAR12, 
                    target.EPO_VARCHAR13=src.EPO_VARCHAR13, 
                    target.EPO_VARCHAR14=src.EPO_VARCHAR14, 
                    target.EPO_VARCHAR15=src.EPO_VARCHAR15, 
                    target.EPO_VARCHAR16=src.EPO_VARCHAR16, 
                    target.EPO_VARCHAR17=src.EPO_VARCHAR17, 
                    target.EPO_VARCHAR18=src.EPO_VARCHAR18, 
                    target.EPO_VARCHAR19=src.EPO_VARCHAR19, 
                    target.EPO_VARCHAR2=src.EPO_VARCHAR2, 
                    target.EPO_VARCHAR20=src.EPO_VARCHAR20, 
                    target.EPO_VARCHAR21=src.EPO_VARCHAR21, 
                    target.EPO_VARCHAR22=src.EPO_VARCHAR22, 
                    target.EPO_VARCHAR23=src.EPO_VARCHAR23, 
                    target.EPO_VARCHAR24=src.EPO_VARCHAR24, 
                    target.EPO_VARCHAR25=src.EPO_VARCHAR25, 
                    target.EPO_VARCHAR26=src.EPO_VARCHAR26, 
                    target.EPO_VARCHAR27=src.EPO_VARCHAR27, 
                    target.EPO_VARCHAR28=src.EPO_VARCHAR28, 
                    target.EPO_VARCHAR29=src.EPO_VARCHAR29, 
                    target.EPO_VARCHAR3=src.EPO_VARCHAR3, 
                    target.EPO_VARCHAR30=src.EPO_VARCHAR30, 
                    target.EPO_VARCHAR31=src.EPO_VARCHAR31, 
                    target.EPO_VARCHAR32=src.EPO_VARCHAR32, 
                    target.EPO_VARCHAR33=src.EPO_VARCHAR33, 
                    target.EPO_VARCHAR34=src.EPO_VARCHAR34, 
                    target.EPO_VARCHAR35=src.EPO_VARCHAR35, 
                    target.EPO_VARCHAR4=src.EPO_VARCHAR4, 
                    target.EPO_VARCHAR5=src.EPO_VARCHAR5, 
                    target.EPO_VARCHAR6=src.EPO_VARCHAR6, 
                    target.EPO_VARCHAR7=src.EPO_VARCHAR7, 
                    target.EPO_VARCHAR8=src.EPO_VARCHAR8, 
                    target.EPO_VARCHAR9=src.EPO_VARCHAR9, 
                    target.EPO_VARDATE1=src.EPO_VARDATE1, 
                    target.EPO_VARDATE10=src.EPO_VARDATE10, 
                    target.EPO_VARDATE11=src.EPO_VARDATE11, 
                    target.EPO_VARDATE12=src.EPO_VARDATE12, 
                    target.EPO_VARDATE13=src.EPO_VARDATE13, 
                    target.EPO_VARDATE14=src.EPO_VARDATE14, 
                    target.EPO_VARDATE15=src.EPO_VARDATE15, 
                    target.EPO_VARDATE2=src.EPO_VARDATE2, 
                    target.EPO_VARDATE3=src.EPO_VARDATE3, 
                    target.EPO_VARDATE4=src.EPO_VARDATE4, 
                    target.EPO_VARDATE5=src.EPO_VARDATE5, 
                    target.EPO_VARDATE6=src.EPO_VARDATE6, 
                    target.EPO_VARDATE7=src.EPO_VARDATE7, 
                    target.EPO_VARDATE8=src.EPO_VARDATE8, 
                    target.EPO_VARDATE9=src.EPO_VARDATE9, 
                    target.EPO_VARNUM1=src.EPO_VARNUM1, 
                    target.EPO_VARNUM10=src.EPO_VARNUM10, 
                    target.EPO_VARNUM11=src.EPO_VARNUM11, 
                    target.EPO_VARNUM12=src.EPO_VARNUM12, 
                    target.EPO_VARNUM13=src.EPO_VARNUM13, 
                    target.EPO_VARNUM14=src.EPO_VARNUM14, 
                    target.EPO_VARNUM15=src.EPO_VARNUM15, 
                    target.EPO_VARNUM16=src.EPO_VARNUM16, 
                    target.EPO_VARNUM17=src.EPO_VARNUM17, 
                    target.EPO_VARNUM18=src.EPO_VARNUM18, 
                    target.EPO_VARNUM19=src.EPO_VARNUM19, 
                    target.EPO_VARNUM2=src.EPO_VARNUM2, 
                    target.EPO_VARNUM20=src.EPO_VARNUM20, 
                    target.EPO_VARNUM21=src.EPO_VARNUM21, 
                    target.EPO_VARNUM22=src.EPO_VARNUM22, 
                    target.EPO_VARNUM23=src.EPO_VARNUM23, 
                    target.EPO_VARNUM24=src.EPO_VARNUM24, 
                    target.EPO_VARNUM25=src.EPO_VARNUM25, 
                    target.EPO_VARNUM26=src.EPO_VARNUM26, 
                    target.EPO_VARNUM27=src.EPO_VARNUM27, 
                    target.EPO_VARNUM28=src.EPO_VARNUM28, 
                    target.EPO_VARNUM29=src.EPO_VARNUM29, 
                    target.EPO_VARNUM3=src.EPO_VARNUM3, 
                    target.EPO_VARNUM30=src.EPO_VARNUM30, 
                    target.EPO_VARNUM31=src.EPO_VARNUM31, 
                    target.EPO_VARNUM32=src.EPO_VARNUM32, 
                    target.EPO_VARNUM33=src.EPO_VARNUM33, 
                    target.EPO_VARNUM34=src.EPO_VARNUM34, 
                    target.EPO_VARNUM35=src.EPO_VARNUM35, 
                    target.EPO_VARNUM4=src.EPO_VARNUM4, 
                    target.EPO_VARNUM5=src.EPO_VARNUM5, 
                    target.EPO_VARNUM6=src.EPO_VARNUM6, 
                    target.EPO_VARNUM7=src.EPO_VARNUM7, 
                    target.EPO_VARNUM8=src.EPO_VARNUM8, 
                    target.EPO_VARNUM9=src.EPO_VARNUM9, 
                    target._DELETED=src._DELETED, 
                    target.ETL_LASTSAVED=src.ETL_LASTSAVED,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename
        when not matched and (src.ETL_DELETED=FALSE OR src.ETL_DELETED IS NULL)  then insert ( 
                    EPO_ASPECT, 
                    EPO_ASSESSEDSLOPE, 
                    EPO_AVGSLOPE, 
                    EPO_CLASS, 
                    EPO_CLASS_ORG, 
                    EPO_CODE, 
                    EPO_COMMENT, 
                    EPO_COMPLETED, 
                    EPO_CONFRATING, 
                    EPO_CREATE, 
                    EPO_CREATED, 
                    EPO_DATE, 
                    EPO_EVENT, 
                    EPO_FINDING, 
                    EPO_FROMGEOREF, 
                    EPO_FROMPOINT, 
                    EPO_FROMREFDESC, 
                    EPO_FROM_HORIZONTAL_OFFSET, 
                    EPO_FROM_HORIZONTAL_OFFSETTYPE, 
                    EPO_FROM_HORIZONTAL_OFFSETUOM, 
                    EPO_FROM_LATITUDE, 
                    EPO_FROM_LONGITUDE, 
                    EPO_FROM_OFFSET, 
                    EPO_FROM_OFFSET_DIRECTION, 
                    EPO_FROM_OFFSET_PERCENTAGE, 
                    EPO_FROM_REFERENCE, 
                    EPO_FROM_RELATIONSHIP_TYPE, 
                    EPO_FROM_VERTICAL_OFFSET, 
                    EPO_FROM_VERTICAL_OFFSETTYPE, 
                    EPO_FROM_VERTICAL_OFFSETUOM, 
                    EPO_FROM_XCOORDINATE, 
                    EPO_FROM_YCOORDINATE, 
                    EPO_INSPECTOR, 
                    EPO_JOB, 
                    EPO_LASTSAVED, 
                    EPO_LASTSLOPE, 
                    EPO_LINE, 
                    EPO_LOCATION, 
                    EPO_MAX, 
                    EPO_MAXDATE, 
                    EPO_MAXPPM, 
                    EPO_MAXSTWO, 
                    EPO_MAXTOL, 
                    EPO_MAXTOLDATE, 
                    EPO_METHOD, 
                    EPO_MIN, 
                    EPO_MINDATE, 
                    EPO_MINPPM, 
                    EPO_MINSTWO, 
                    EPO_MINTOL, 
                    EPO_MINTOLDATE, 
                    EPO_NIDATEMAXCRIT, 
                    EPO_NIDATEMAXTOL, 
                    EPO_NIDATEMINCRIT, 
                    EPO_NIDATEMINTOL, 
                    EPO_OBJECT, 
                    EPO_OBJECT_ORG, 
                    EPO_OBRTYPE, 
                    EPO_OBTYPE, 
                    EPO_ORIGEVENT, 
                    EPO_PARENT, 
                    EPO_POINT, 
                    EPO_POINTTYPE, 
                    EPO_PROCESSED, 
                    EPO_RESULT, 
                    EPO_RISK, 
                    EPO_RRESULT, 
                    EPO_STWO, 
                    EPO_TOGEOREF, 
                    EPO_TOPOINT, 
                    EPO_TOREFDESC, 
                    EPO_TO_HORIZONTAL_OFFSET, 
                    EPO_TO_HORIZONTAL_OFFSETTYPE, 
                    EPO_TO_HORIZONTAL_OFFSETUOM, 
                    EPO_TO_LATITUDE, 
                    EPO_TO_LONGITUDE, 
                    EPO_TO_OFFSET, 
                    EPO_TO_OFFSET_DIRECTION, 
                    EPO_TO_OFFSET_PERCENTAGE, 
                    EPO_TO_REFERENCE, 
                    EPO_TO_RELATIONSHIP_TYPE, 
                    EPO_TO_VERTICAL_OFFSET, 
                    EPO_TO_VERTICAL_OFFSETTYPE, 
                    EPO_TO_VERTICAL_OFFSETUOM, 
                    EPO_TO_XCOORDINATE, 
                    EPO_TO_YCOORDINATE, 
                    EPO_TYPE, 
                    EPO_UOM, 
                    EPO_UPDATECOUNT, 
                    EPO_UPDATED, 
                    EPO_VALUE, 
                    EPO_VARCHAR1, 
                    EPO_VARCHAR10, 
                    EPO_VARCHAR11, 
                    EPO_VARCHAR12, 
                    EPO_VARCHAR13, 
                    EPO_VARCHAR14, 
                    EPO_VARCHAR15, 
                    EPO_VARCHAR16, 
                    EPO_VARCHAR17, 
                    EPO_VARCHAR18, 
                    EPO_VARCHAR19, 
                    EPO_VARCHAR2, 
                    EPO_VARCHAR20, 
                    EPO_VARCHAR21, 
                    EPO_VARCHAR22, 
                    EPO_VARCHAR23, 
                    EPO_VARCHAR24, 
                    EPO_VARCHAR25, 
                    EPO_VARCHAR26, 
                    EPO_VARCHAR27, 
                    EPO_VARCHAR28, 
                    EPO_VARCHAR29, 
                    EPO_VARCHAR3, 
                    EPO_VARCHAR30, 
                    EPO_VARCHAR31, 
                    EPO_VARCHAR32, 
                    EPO_VARCHAR33, 
                    EPO_VARCHAR34, 
                    EPO_VARCHAR35, 
                    EPO_VARCHAR4, 
                    EPO_VARCHAR5, 
                    EPO_VARCHAR6, 
                    EPO_VARCHAR7, 
                    EPO_VARCHAR8, 
                    EPO_VARCHAR9, 
                    EPO_VARDATE1, 
                    EPO_VARDATE10, 
                    EPO_VARDATE11, 
                    EPO_VARDATE12, 
                    EPO_VARDATE13, 
                    EPO_VARDATE14, 
                    EPO_VARDATE15, 
                    EPO_VARDATE2, 
                    EPO_VARDATE3, 
                    EPO_VARDATE4, 
                    EPO_VARDATE5, 
                    EPO_VARDATE6, 
                    EPO_VARDATE7, 
                    EPO_VARDATE8, 
                    EPO_VARDATE9, 
                    EPO_VARNUM1, 
                    EPO_VARNUM10, 
                    EPO_VARNUM11, 
                    EPO_VARNUM12, 
                    EPO_VARNUM13, 
                    EPO_VARNUM14, 
                    EPO_VARNUM15, 
                    EPO_VARNUM16, 
                    EPO_VARNUM17, 
                    EPO_VARNUM18, 
                    EPO_VARNUM19, 
                    EPO_VARNUM2, 
                    EPO_VARNUM20, 
                    EPO_VARNUM21, 
                    EPO_VARNUM22, 
                    EPO_VARNUM23, 
                    EPO_VARNUM24, 
                    EPO_VARNUM25, 
                    EPO_VARNUM26, 
                    EPO_VARNUM27, 
                    EPO_VARNUM28, 
                    EPO_VARNUM29, 
                    EPO_VARNUM3, 
                    EPO_VARNUM30, 
                    EPO_VARNUM31, 
                    EPO_VARNUM32, 
                    EPO_VARNUM33, 
                    EPO_VARNUM34, 
                    EPO_VARNUM35, 
                    EPO_VARNUM4, 
                    EPO_VARNUM5, 
                    EPO_VARNUM6, 
                    EPO_VARNUM7, 
                    EPO_VARNUM8, 
                    EPO_VARNUM9, 
                    _DELETED, 
                    ETL_LASTSAVED,                       
                    etl_load_datetime,
                    etl_load_metadatafilename) 
            values (
                    src.EPO_ASPECT, 
                    src.EPO_ASSESSEDSLOPE, 
                    src.EPO_AVGSLOPE, 
                    src.EPO_CLASS, 
                    src.EPO_CLASS_ORG, 
                    src.EPO_CODE, 
                    src.EPO_COMMENT, 
                    src.EPO_COMPLETED, 
                    src.EPO_CONFRATING, 
                    src.EPO_CREATE, 
                    src.EPO_CREATED, 
                    src.EPO_DATE, 
                    src.EPO_EVENT, 
                    src.EPO_FINDING, 
                    src.EPO_FROMGEOREF, 
                    src.EPO_FROMPOINT, 
                    src.EPO_FROMREFDESC, 
                    src.EPO_FROM_HORIZONTAL_OFFSET, 
                    src.EPO_FROM_HORIZONTAL_OFFSETTYPE, 
                    src.EPO_FROM_HORIZONTAL_OFFSETUOM, 
                    src.EPO_FROM_LATITUDE, 
                    src.EPO_FROM_LONGITUDE, 
                    src.EPO_FROM_OFFSET, 
                    src.EPO_FROM_OFFSET_DIRECTION, 
                    src.EPO_FROM_OFFSET_PERCENTAGE, 
                    src.EPO_FROM_REFERENCE, 
                    src.EPO_FROM_RELATIONSHIP_TYPE, 
                    src.EPO_FROM_VERTICAL_OFFSET, 
                    src.EPO_FROM_VERTICAL_OFFSETTYPE, 
                    src.EPO_FROM_VERTICAL_OFFSETUOM, 
                    src.EPO_FROM_XCOORDINATE, 
                    src.EPO_FROM_YCOORDINATE, 
                    src.EPO_INSPECTOR, 
                    src.EPO_JOB, 
                    src.EPO_LASTSAVED, 
                    src.EPO_LASTSLOPE, 
                    src.EPO_LINE, 
                    src.EPO_LOCATION, 
                    src.EPO_MAX, 
                    src.EPO_MAXDATE, 
                    src.EPO_MAXPPM, 
                    src.EPO_MAXSTWO, 
                    src.EPO_MAXTOL, 
                    src.EPO_MAXTOLDATE, 
                    src.EPO_METHOD, 
                    src.EPO_MIN, 
                    src.EPO_MINDATE, 
                    src.EPO_MINPPM, 
                    src.EPO_MINSTWO, 
                    src.EPO_MINTOL, 
                    src.EPO_MINTOLDATE, 
                    src.EPO_NIDATEMAXCRIT, 
                    src.EPO_NIDATEMAXTOL, 
                    src.EPO_NIDATEMINCRIT, 
                    src.EPO_NIDATEMINTOL, 
                    src.EPO_OBJECT, 
                    src.EPO_OBJECT_ORG, 
                    src.EPO_OBRTYPE, 
                    src.EPO_OBTYPE, 
                    src.EPO_ORIGEVENT, 
                    src.EPO_PARENT, 
                    src.EPO_POINT, 
                    src.EPO_POINTTYPE, 
                    src.EPO_PROCESSED, 
                    src.EPO_RESULT, 
                    src.EPO_RISK, 
                    src.EPO_RRESULT, 
                    src.EPO_STWO, 
                    src.EPO_TOGEOREF, 
                    src.EPO_TOPOINT, 
                    src.EPO_TOREFDESC, 
                    src.EPO_TO_HORIZONTAL_OFFSET, 
                    src.EPO_TO_HORIZONTAL_OFFSETTYPE, 
                    src.EPO_TO_HORIZONTAL_OFFSETUOM, 
                    src.EPO_TO_LATITUDE, 
                    src.EPO_TO_LONGITUDE, 
                    src.EPO_TO_OFFSET, 
                    src.EPO_TO_OFFSET_DIRECTION, 
                    src.EPO_TO_OFFSET_PERCENTAGE, 
                    src.EPO_TO_REFERENCE, 
                    src.EPO_TO_RELATIONSHIP_TYPE, 
                    src.EPO_TO_VERTICAL_OFFSET, 
                    src.EPO_TO_VERTICAL_OFFSETTYPE, 
                    src.EPO_TO_VERTICAL_OFFSETUOM, 
                    src.EPO_TO_XCOORDINATE, 
                    src.EPO_TO_YCOORDINATE, 
                    src.EPO_TYPE, 
                    src.EPO_UOM, 
                    src.EPO_UPDATECOUNT, 
                    src.EPO_UPDATED, 
                    src.EPO_VALUE, 
                    src.EPO_VARCHAR1, 
                    src.EPO_VARCHAR10, 
                    src.EPO_VARCHAR11, 
                    src.EPO_VARCHAR12, 
                    src.EPO_VARCHAR13, 
                    src.EPO_VARCHAR14, 
                    src.EPO_VARCHAR15, 
                    src.EPO_VARCHAR16, 
                    src.EPO_VARCHAR17, 
                    src.EPO_VARCHAR18, 
                    src.EPO_VARCHAR19, 
                    src.EPO_VARCHAR2, 
                    src.EPO_VARCHAR20, 
                    src.EPO_VARCHAR21, 
                    src.EPO_VARCHAR22, 
                    src.EPO_VARCHAR23, 
                    src.EPO_VARCHAR24, 
                    src.EPO_VARCHAR25, 
                    src.EPO_VARCHAR26, 
                    src.EPO_VARCHAR27, 
                    src.EPO_VARCHAR28, 
                    src.EPO_VARCHAR29, 
                    src.EPO_VARCHAR3, 
                    src.EPO_VARCHAR30, 
                    src.EPO_VARCHAR31, 
                    src.EPO_VARCHAR32, 
                    src.EPO_VARCHAR33, 
                    src.EPO_VARCHAR34, 
                    src.EPO_VARCHAR35, 
                    src.EPO_VARCHAR4, 
                    src.EPO_VARCHAR5, 
                    src.EPO_VARCHAR6, 
                    src.EPO_VARCHAR7, 
                    src.EPO_VARCHAR8, 
                    src.EPO_VARCHAR9, 
                    src.EPO_VARDATE1, 
                    src.EPO_VARDATE10, 
                    src.EPO_VARDATE11, 
                    src.EPO_VARDATE12, 
                    src.EPO_VARDATE13, 
                    src.EPO_VARDATE14, 
                    src.EPO_VARDATE15, 
                    src.EPO_VARDATE2, 
                    src.EPO_VARDATE3, 
                    src.EPO_VARDATE4, 
                    src.EPO_VARDATE5, 
                    src.EPO_VARDATE6, 
                    src.EPO_VARDATE7, 
                    src.EPO_VARDATE8, 
                    src.EPO_VARDATE9, 
                    src.EPO_VARNUM1, 
                    src.EPO_VARNUM10, 
                    src.EPO_VARNUM11, 
                    src.EPO_VARNUM12, 
                    src.EPO_VARNUM13, 
                    src.EPO_VARNUM14, 
                    src.EPO_VARNUM15, 
                    src.EPO_VARNUM16, 
                    src.EPO_VARNUM17, 
                    src.EPO_VARNUM18, 
                    src.EPO_VARNUM19, 
                    src.EPO_VARNUM2, 
                    src.EPO_VARNUM20, 
                    src.EPO_VARNUM21, 
                    src.EPO_VARNUM22, 
                    src.EPO_VARNUM23, 
                    src.EPO_VARNUM24, 
                    src.EPO_VARNUM25, 
                    src.EPO_VARNUM26, 
                    src.EPO_VARNUM27, 
                    src.EPO_VARNUM28, 
                    src.EPO_VARNUM29, 
                    src.EPO_VARNUM3, 
                    src.EPO_VARNUM30, 
                    src.EPO_VARNUM31, 
                    src.EPO_VARNUM32, 
                    src.EPO_VARNUM33, 
                    src.EPO_VARNUM34, 
                    src.EPO_VARNUM35, 
                    src.EPO_VARNUM4, 
                    src.EPO_VARNUM5, 
                    src.EPO_VARNUM6, 
                    src.EPO_VARNUM7, 
                    src.EPO_VARNUM8, 
                    src.EPO_VARNUM9, 
                    src._DELETED,     
                    src.ETL_LASTSAVED,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename);`;

    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();

    snowflake.execute( {sqlText: `merge into TARGET_HISTORY_EAM.EAM_R5EVENTPOINTS_DELETED as target using (
                SELECT * FROM (SELECT 
            strm.EPO_ASPECT, 
            strm.EPO_ASSESSEDSLOPE, 
            strm.EPO_AVGSLOPE, 
            strm.EPO_CLASS, 
            strm.EPO_CLASS_ORG, 
            strm.EPO_CODE, 
            strm.EPO_COMMENT, 
            strm.EPO_COMPLETED, 
            strm.EPO_CONFRATING, 
            strm.EPO_CREATE, 
            strm.EPO_CREATED, 
            strm.EPO_DATE, 
            strm.EPO_EVENT, 
            strm.EPO_FINDING, 
            strm.EPO_FROMGEOREF, 
            strm.EPO_FROMPOINT, 
            strm.EPO_FROMREFDESC, 
            strm.EPO_FROM_HORIZONTAL_OFFSET, 
            strm.EPO_FROM_HORIZONTAL_OFFSETTYPE, 
            strm.EPO_FROM_HORIZONTAL_OFFSETUOM, 
            strm.EPO_FROM_LATITUDE, 
            strm.EPO_FROM_LONGITUDE, 
            strm.EPO_FROM_OFFSET, 
            strm.EPO_FROM_OFFSET_DIRECTION, 
            strm.EPO_FROM_OFFSET_PERCENTAGE, 
            strm.EPO_FROM_REFERENCE, 
            strm.EPO_FROM_RELATIONSHIP_TYPE, 
            strm.EPO_FROM_VERTICAL_OFFSET, 
            strm.EPO_FROM_VERTICAL_OFFSETTYPE, 
            strm.EPO_FROM_VERTICAL_OFFSETUOM, 
            strm.EPO_FROM_XCOORDINATE, 
            strm.EPO_FROM_YCOORDINATE, 
            strm.EPO_INSPECTOR, 
            strm.EPO_JOB, 
            strm.EPO_LASTSAVED, 
            strm.EPO_LASTSLOPE, 
            strm.EPO_LINE, 
            strm.EPO_LOCATION, 
            strm.EPO_MAX, 
            strm.EPO_MAXDATE, 
            strm.EPO_MAXPPM, 
            strm.EPO_MAXSTWO, 
            strm.EPO_MAXTOL, 
            strm.EPO_MAXTOLDATE, 
            strm.EPO_METHOD, 
            strm.EPO_MIN, 
            strm.EPO_MINDATE, 
            strm.EPO_MINPPM, 
            strm.EPO_MINSTWO, 
            strm.EPO_MINTOL, 
            strm.EPO_MINTOLDATE, 
            strm.EPO_NIDATEMAXCRIT, 
            strm.EPO_NIDATEMAXTOL, 
            strm.EPO_NIDATEMINCRIT, 
            strm.EPO_NIDATEMINTOL, 
            strm.EPO_OBJECT, 
            strm.EPO_OBJECT_ORG, 
            strm.EPO_OBRTYPE, 
            strm.EPO_OBTYPE, 
            strm.EPO_ORIGEVENT, 
            strm.EPO_PARENT, 
            strm.EPO_POINT, 
            strm.EPO_POINTTYPE, 
            strm.EPO_PROCESSED, 
            strm.EPO_RESULT, 
            strm.EPO_RISK, 
            strm.EPO_RRESULT, 
            strm.EPO_STWO, 
            strm.EPO_TOGEOREF, 
            strm.EPO_TOPOINT, 
            strm.EPO_TOREFDESC, 
            strm.EPO_TO_HORIZONTAL_OFFSET, 
            strm.EPO_TO_HORIZONTAL_OFFSETTYPE, 
            strm.EPO_TO_HORIZONTAL_OFFSETUOM, 
            strm.EPO_TO_LATITUDE, 
            strm.EPO_TO_LONGITUDE, 
            strm.EPO_TO_OFFSET, 
            strm.EPO_TO_OFFSET_DIRECTION, 
            strm.EPO_TO_OFFSET_PERCENTAGE, 
            strm.EPO_TO_REFERENCE, 
            strm.EPO_TO_RELATIONSHIP_TYPE, 
            strm.EPO_TO_VERTICAL_OFFSET, 
            strm.EPO_TO_VERTICAL_OFFSETTYPE, 
            strm.EPO_TO_VERTICAL_OFFSETUOM, 
            strm.EPO_TO_XCOORDINATE, 
            strm.EPO_TO_YCOORDINATE, 
            strm.EPO_TYPE, 
            strm.EPO_UOM, 
            strm.EPO_UPDATECOUNT, 
            strm.EPO_UPDATED, 
            strm.EPO_VALUE, 
            strm.EPO_VARCHAR1, 
            strm.EPO_VARCHAR10, 
            strm.EPO_VARCHAR11, 
            strm.EPO_VARCHAR12, 
            strm.EPO_VARCHAR13, 
            strm.EPO_VARCHAR14, 
            strm.EPO_VARCHAR15, 
            strm.EPO_VARCHAR16, 
            strm.EPO_VARCHAR17, 
            strm.EPO_VARCHAR18, 
            strm.EPO_VARCHAR19, 
            strm.EPO_VARCHAR2, 
            strm.EPO_VARCHAR20, 
            strm.EPO_VARCHAR21, 
            strm.EPO_VARCHAR22, 
            strm.EPO_VARCHAR23, 
            strm.EPO_VARCHAR24, 
            strm.EPO_VARCHAR25, 
            strm.EPO_VARCHAR26, 
            strm.EPO_VARCHAR27, 
            strm.EPO_VARCHAR28, 
            strm.EPO_VARCHAR29, 
            strm.EPO_VARCHAR3, 
            strm.EPO_VARCHAR30, 
            strm.EPO_VARCHAR31, 
            strm.EPO_VARCHAR32, 
            strm.EPO_VARCHAR33, 
            strm.EPO_VARCHAR34, 
            strm.EPO_VARCHAR35, 
            strm.EPO_VARCHAR4, 
            strm.EPO_VARCHAR5, 
            strm.EPO_VARCHAR6, 
            strm.EPO_VARCHAR7, 
            strm.EPO_VARCHAR8, 
            strm.EPO_VARCHAR9, 
            strm.EPO_VARDATE1, 
            strm.EPO_VARDATE10, 
            strm.EPO_VARDATE11, 
            strm.EPO_VARDATE12, 
            strm.EPO_VARDATE13, 
            strm.EPO_VARDATE14, 
            strm.EPO_VARDATE15, 
            strm.EPO_VARDATE2, 
            strm.EPO_VARDATE3, 
            strm.EPO_VARDATE4, 
            strm.EPO_VARDATE5, 
            strm.EPO_VARDATE6, 
            strm.EPO_VARDATE7, 
            strm.EPO_VARDATE8, 
            strm.EPO_VARDATE9, 
            strm.EPO_VARNUM1, 
            strm.EPO_VARNUM10, 
            strm.EPO_VARNUM11, 
            strm.EPO_VARNUM12, 
            strm.EPO_VARNUM13, 
            strm.EPO_VARNUM14, 
            strm.EPO_VARNUM15, 
            strm.EPO_VARNUM16, 
            strm.EPO_VARNUM17, 
            strm.EPO_VARNUM18, 
            strm.EPO_VARNUM19, 
            strm.EPO_VARNUM2, 
            strm.EPO_VARNUM20, 
            strm.EPO_VARNUM21, 
            strm.EPO_VARNUM22, 
            strm.EPO_VARNUM23, 
            strm.EPO_VARNUM24, 
            strm.EPO_VARNUM25, 
            strm.EPO_VARNUM26, 
            strm.EPO_VARNUM27, 
            strm.EPO_VARNUM28, 
            strm.EPO_VARNUM29, 
            strm.EPO_VARNUM3, 
            strm.EPO_VARNUM30, 
            strm.EPO_VARNUM31, 
            strm.EPO_VARNUM32, 
            strm.EPO_VARNUM33, 
            strm.EPO_VARNUM34, 
            strm.EPO_VARNUM35, 
            strm.EPO_VARNUM4, 
            strm.EPO_VARNUM5, 
            strm.EPO_VARNUM6, 
            strm.EPO_VARNUM7, 
            strm.EPO_VARNUM8, 
            strm.EPO_VARNUM9, 
            strm._DELETED, 
            strm.ETL_LASTSAVED,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.EPO_CODE ORDER BY strm.ETL_LASTSAVED desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_EAM_R5EVENTPOINTS as  strm
        WHERE strm.ETL_DELETED=TRUE
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.EPO_CODE=src.EPO_CODE) OR (target.EPO_CODE IS NULL AND src.EPO_CODE IS NULL)) 
                when matched then update set
                    target.EPO_ASPECT=src.EPO_ASPECT, 
                    target.EPO_ASSESSEDSLOPE=src.EPO_ASSESSEDSLOPE, 
                    target.EPO_AVGSLOPE=src.EPO_AVGSLOPE, 
                    target.EPO_CLASS=src.EPO_CLASS, 
                    target.EPO_CLASS_ORG=src.EPO_CLASS_ORG, 
                    target.EPO_CODE=src.EPO_CODE, 
                    target.EPO_COMMENT=src.EPO_COMMENT, 
                    target.EPO_COMPLETED=src.EPO_COMPLETED, 
                    target.EPO_CONFRATING=src.EPO_CONFRATING, 
                    target.EPO_CREATE=src.EPO_CREATE, 
                    target.EPO_CREATED=src.EPO_CREATED, 
                    target.EPO_DATE=src.EPO_DATE, 
                    target.EPO_EVENT=src.EPO_EVENT, 
                    target.EPO_FINDING=src.EPO_FINDING, 
                    target.EPO_FROMGEOREF=src.EPO_FROMGEOREF, 
                    target.EPO_FROMPOINT=src.EPO_FROMPOINT, 
                    target.EPO_FROMREFDESC=src.EPO_FROMREFDESC, 
                    target.EPO_FROM_HORIZONTAL_OFFSET=src.EPO_FROM_HORIZONTAL_OFFSET, 
                    target.EPO_FROM_HORIZONTAL_OFFSETTYPE=src.EPO_FROM_HORIZONTAL_OFFSETTYPE, 
                    target.EPO_FROM_HORIZONTAL_OFFSETUOM=src.EPO_FROM_HORIZONTAL_OFFSETUOM, 
                    target.EPO_FROM_LATITUDE=src.EPO_FROM_LATITUDE, 
                    target.EPO_FROM_LONGITUDE=src.EPO_FROM_LONGITUDE, 
                    target.EPO_FROM_OFFSET=src.EPO_FROM_OFFSET, 
                    target.EPO_FROM_OFFSET_DIRECTION=src.EPO_FROM_OFFSET_DIRECTION, 
                    target.EPO_FROM_OFFSET_PERCENTAGE=src.EPO_FROM_OFFSET_PERCENTAGE, 
                    target.EPO_FROM_REFERENCE=src.EPO_FROM_REFERENCE, 
                    target.EPO_FROM_RELATIONSHIP_TYPE=src.EPO_FROM_RELATIONSHIP_TYPE, 
                    target.EPO_FROM_VERTICAL_OFFSET=src.EPO_FROM_VERTICAL_OFFSET, 
                    target.EPO_FROM_VERTICAL_OFFSETTYPE=src.EPO_FROM_VERTICAL_OFFSETTYPE, 
                    target.EPO_FROM_VERTICAL_OFFSETUOM=src.EPO_FROM_VERTICAL_OFFSETUOM, 
                    target.EPO_FROM_XCOORDINATE=src.EPO_FROM_XCOORDINATE, 
                    target.EPO_FROM_YCOORDINATE=src.EPO_FROM_YCOORDINATE, 
                    target.EPO_INSPECTOR=src.EPO_INSPECTOR, 
                    target.EPO_JOB=src.EPO_JOB, 
                    target.EPO_LASTSAVED=src.EPO_LASTSAVED, 
                    target.EPO_LASTSLOPE=src.EPO_LASTSLOPE, 
                    target.EPO_LINE=src.EPO_LINE, 
                    target.EPO_LOCATION=src.EPO_LOCATION, 
                    target.EPO_MAX=src.EPO_MAX, 
                    target.EPO_MAXDATE=src.EPO_MAXDATE, 
                    target.EPO_MAXPPM=src.EPO_MAXPPM, 
                    target.EPO_MAXSTWO=src.EPO_MAXSTWO, 
                    target.EPO_MAXTOL=src.EPO_MAXTOL, 
                    target.EPO_MAXTOLDATE=src.EPO_MAXTOLDATE, 
                    target.EPO_METHOD=src.EPO_METHOD, 
                    target.EPO_MIN=src.EPO_MIN, 
                    target.EPO_MINDATE=src.EPO_MINDATE, 
                    target.EPO_MINPPM=src.EPO_MINPPM, 
                    target.EPO_MINSTWO=src.EPO_MINSTWO, 
                    target.EPO_MINTOL=src.EPO_MINTOL, 
                    target.EPO_MINTOLDATE=src.EPO_MINTOLDATE, 
                    target.EPO_NIDATEMAXCRIT=src.EPO_NIDATEMAXCRIT, 
                    target.EPO_NIDATEMAXTOL=src.EPO_NIDATEMAXTOL, 
                    target.EPO_NIDATEMINCRIT=src.EPO_NIDATEMINCRIT, 
                    target.EPO_NIDATEMINTOL=src.EPO_NIDATEMINTOL, 
                    target.EPO_OBJECT=src.EPO_OBJECT, 
                    target.EPO_OBJECT_ORG=src.EPO_OBJECT_ORG, 
                    target.EPO_OBRTYPE=src.EPO_OBRTYPE, 
                    target.EPO_OBTYPE=src.EPO_OBTYPE, 
                    target.EPO_ORIGEVENT=src.EPO_ORIGEVENT, 
                    target.EPO_PARENT=src.EPO_PARENT, 
                    target.EPO_POINT=src.EPO_POINT, 
                    target.EPO_POINTTYPE=src.EPO_POINTTYPE, 
                    target.EPO_PROCESSED=src.EPO_PROCESSED, 
                    target.EPO_RESULT=src.EPO_RESULT, 
                    target.EPO_RISK=src.EPO_RISK, 
                    target.EPO_RRESULT=src.EPO_RRESULT, 
                    target.EPO_STWO=src.EPO_STWO, 
                    target.EPO_TOGEOREF=src.EPO_TOGEOREF, 
                    target.EPO_TOPOINT=src.EPO_TOPOINT, 
                    target.EPO_TOREFDESC=src.EPO_TOREFDESC, 
                    target.EPO_TO_HORIZONTAL_OFFSET=src.EPO_TO_HORIZONTAL_OFFSET, 
                    target.EPO_TO_HORIZONTAL_OFFSETTYPE=src.EPO_TO_HORIZONTAL_OFFSETTYPE, 
                    target.EPO_TO_HORIZONTAL_OFFSETUOM=src.EPO_TO_HORIZONTAL_OFFSETUOM, 
                    target.EPO_TO_LATITUDE=src.EPO_TO_LATITUDE, 
                    target.EPO_TO_LONGITUDE=src.EPO_TO_LONGITUDE, 
                    target.EPO_TO_OFFSET=src.EPO_TO_OFFSET, 
                    target.EPO_TO_OFFSET_DIRECTION=src.EPO_TO_OFFSET_DIRECTION, 
                    target.EPO_TO_OFFSET_PERCENTAGE=src.EPO_TO_OFFSET_PERCENTAGE, 
                    target.EPO_TO_REFERENCE=src.EPO_TO_REFERENCE, 
                    target.EPO_TO_RELATIONSHIP_TYPE=src.EPO_TO_RELATIONSHIP_TYPE, 
                    target.EPO_TO_VERTICAL_OFFSET=src.EPO_TO_VERTICAL_OFFSET, 
                    target.EPO_TO_VERTICAL_OFFSETTYPE=src.EPO_TO_VERTICAL_OFFSETTYPE, 
                    target.EPO_TO_VERTICAL_OFFSETUOM=src.EPO_TO_VERTICAL_OFFSETUOM, 
                    target.EPO_TO_XCOORDINATE=src.EPO_TO_XCOORDINATE, 
                    target.EPO_TO_YCOORDINATE=src.EPO_TO_YCOORDINATE, 
                    target.EPO_TYPE=src.EPO_TYPE, 
                    target.EPO_UOM=src.EPO_UOM, 
                    target.EPO_UPDATECOUNT=src.EPO_UPDATECOUNT, 
                    target.EPO_UPDATED=src.EPO_UPDATED, 
                    target.EPO_VALUE=src.EPO_VALUE, 
                    target.EPO_VARCHAR1=src.EPO_VARCHAR1, 
                    target.EPO_VARCHAR10=src.EPO_VARCHAR10, 
                    target.EPO_VARCHAR11=src.EPO_VARCHAR11, 
                    target.EPO_VARCHAR12=src.EPO_VARCHAR12, 
                    target.EPO_VARCHAR13=src.EPO_VARCHAR13, 
                    target.EPO_VARCHAR14=src.EPO_VARCHAR14, 
                    target.EPO_VARCHAR15=src.EPO_VARCHAR15, 
                    target.EPO_VARCHAR16=src.EPO_VARCHAR16, 
                    target.EPO_VARCHAR17=src.EPO_VARCHAR17, 
                    target.EPO_VARCHAR18=src.EPO_VARCHAR18, 
                    target.EPO_VARCHAR19=src.EPO_VARCHAR19, 
                    target.EPO_VARCHAR2=src.EPO_VARCHAR2, 
                    target.EPO_VARCHAR20=src.EPO_VARCHAR20, 
                    target.EPO_VARCHAR21=src.EPO_VARCHAR21, 
                    target.EPO_VARCHAR22=src.EPO_VARCHAR22, 
                    target.EPO_VARCHAR23=src.EPO_VARCHAR23, 
                    target.EPO_VARCHAR24=src.EPO_VARCHAR24, 
                    target.EPO_VARCHAR25=src.EPO_VARCHAR25, 
                    target.EPO_VARCHAR26=src.EPO_VARCHAR26, 
                    target.EPO_VARCHAR27=src.EPO_VARCHAR27, 
                    target.EPO_VARCHAR28=src.EPO_VARCHAR28, 
                    target.EPO_VARCHAR29=src.EPO_VARCHAR29, 
                    target.EPO_VARCHAR3=src.EPO_VARCHAR3, 
                    target.EPO_VARCHAR30=src.EPO_VARCHAR30, 
                    target.EPO_VARCHAR31=src.EPO_VARCHAR31, 
                    target.EPO_VARCHAR32=src.EPO_VARCHAR32, 
                    target.EPO_VARCHAR33=src.EPO_VARCHAR33, 
                    target.EPO_VARCHAR34=src.EPO_VARCHAR34, 
                    target.EPO_VARCHAR35=src.EPO_VARCHAR35, 
                    target.EPO_VARCHAR4=src.EPO_VARCHAR4, 
                    target.EPO_VARCHAR5=src.EPO_VARCHAR5, 
                    target.EPO_VARCHAR6=src.EPO_VARCHAR6, 
                    target.EPO_VARCHAR7=src.EPO_VARCHAR7, 
                    target.EPO_VARCHAR8=src.EPO_VARCHAR8, 
                    target.EPO_VARCHAR9=src.EPO_VARCHAR9, 
                    target.EPO_VARDATE1=src.EPO_VARDATE1, 
                    target.EPO_VARDATE10=src.EPO_VARDATE10, 
                    target.EPO_VARDATE11=src.EPO_VARDATE11, 
                    target.EPO_VARDATE12=src.EPO_VARDATE12, 
                    target.EPO_VARDATE13=src.EPO_VARDATE13, 
                    target.EPO_VARDATE14=src.EPO_VARDATE14, 
                    target.EPO_VARDATE15=src.EPO_VARDATE15, 
                    target.EPO_VARDATE2=src.EPO_VARDATE2, 
                    target.EPO_VARDATE3=src.EPO_VARDATE3, 
                    target.EPO_VARDATE4=src.EPO_VARDATE4, 
                    target.EPO_VARDATE5=src.EPO_VARDATE5, 
                    target.EPO_VARDATE6=src.EPO_VARDATE6, 
                    target.EPO_VARDATE7=src.EPO_VARDATE7, 
                    target.EPO_VARDATE8=src.EPO_VARDATE8, 
                    target.EPO_VARDATE9=src.EPO_VARDATE9, 
                    target.EPO_VARNUM1=src.EPO_VARNUM1, 
                    target.EPO_VARNUM10=src.EPO_VARNUM10, 
                    target.EPO_VARNUM11=src.EPO_VARNUM11, 
                    target.EPO_VARNUM12=src.EPO_VARNUM12, 
                    target.EPO_VARNUM13=src.EPO_VARNUM13, 
                    target.EPO_VARNUM14=src.EPO_VARNUM14, 
                    target.EPO_VARNUM15=src.EPO_VARNUM15, 
                    target.EPO_VARNUM16=src.EPO_VARNUM16, 
                    target.EPO_VARNUM17=src.EPO_VARNUM17, 
                    target.EPO_VARNUM18=src.EPO_VARNUM18, 
                    target.EPO_VARNUM19=src.EPO_VARNUM19, 
                    target.EPO_VARNUM2=src.EPO_VARNUM2, 
                    target.EPO_VARNUM20=src.EPO_VARNUM20, 
                    target.EPO_VARNUM21=src.EPO_VARNUM21, 
                    target.EPO_VARNUM22=src.EPO_VARNUM22, 
                    target.EPO_VARNUM23=src.EPO_VARNUM23, 
                    target.EPO_VARNUM24=src.EPO_VARNUM24, 
                    target.EPO_VARNUM25=src.EPO_VARNUM25, 
                    target.EPO_VARNUM26=src.EPO_VARNUM26, 
                    target.EPO_VARNUM27=src.EPO_VARNUM27, 
                    target.EPO_VARNUM28=src.EPO_VARNUM28, 
                    target.EPO_VARNUM29=src.EPO_VARNUM29, 
                    target.EPO_VARNUM3=src.EPO_VARNUM3, 
                    target.EPO_VARNUM30=src.EPO_VARNUM30, 
                    target.EPO_VARNUM31=src.EPO_VARNUM31, 
                    target.EPO_VARNUM32=src.EPO_VARNUM32, 
                    target.EPO_VARNUM33=src.EPO_VARNUM33, 
                    target.EPO_VARNUM34=src.EPO_VARNUM34, 
                    target.EPO_VARNUM35=src.EPO_VARNUM35, 
                    target.EPO_VARNUM4=src.EPO_VARNUM4, 
                    target.EPO_VARNUM5=src.EPO_VARNUM5, 
                    target.EPO_VARNUM6=src.EPO_VARNUM6, 
                    target.EPO_VARNUM7=src.EPO_VARNUM7, 
                    target.EPO_VARNUM8=src.EPO_VARNUM8, 
                    target.EPO_VARNUM9=src.EPO_VARNUM9, 
                    target._DELETED=src._DELETED, 
                    target.ETL_LASTSAVED=src.ETL_LASTSAVED,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename,
                    target.ETL_DELETED=src.ETL_DELETED
        when not matched   then insert ( EPO_ASPECT, EPO_ASSESSEDSLOPE, EPO_AVGSLOPE, EPO_CLASS, EPO_CLASS_ORG, EPO_CODE, EPO_COMMENT, EPO_COMPLETED, EPO_CONFRATING, EPO_CREATE, EPO_CREATED, EPO_DATE, EPO_EVENT, EPO_FINDING, EPO_FROMGEOREF, EPO_FROMPOINT, EPO_FROMREFDESC, EPO_FROM_HORIZONTAL_OFFSET, EPO_FROM_HORIZONTAL_OFFSETTYPE, EPO_FROM_HORIZONTAL_OFFSETUOM, EPO_FROM_LATITUDE, EPO_FROM_LONGITUDE, EPO_FROM_OFFSET, EPO_FROM_OFFSET_DIRECTION, EPO_FROM_OFFSET_PERCENTAGE, EPO_FROM_REFERENCE, EPO_FROM_RELATIONSHIP_TYPE, EPO_FROM_VERTICAL_OFFSET, EPO_FROM_VERTICAL_OFFSETTYPE, EPO_FROM_VERTICAL_OFFSETUOM, EPO_FROM_XCOORDINATE, EPO_FROM_YCOORDINATE, EPO_INSPECTOR, EPO_JOB, EPO_LASTSAVED, EPO_LASTSLOPE, EPO_LINE, EPO_LOCATION, EPO_MAX, EPO_MAXDATE, EPO_MAXPPM, EPO_MAXSTWO, EPO_MAXTOL, EPO_MAXTOLDATE, EPO_METHOD, EPO_MIN, EPO_MINDATE, EPO_MINPPM, EPO_MINSTWO, EPO_MINTOL, EPO_MINTOLDATE, EPO_NIDATEMAXCRIT, EPO_NIDATEMAXTOL, EPO_NIDATEMINCRIT, EPO_NIDATEMINTOL, EPO_OBJECT, EPO_OBJECT_ORG, EPO_OBRTYPE, EPO_OBTYPE, EPO_ORIGEVENT, EPO_PARENT, EPO_POINT, EPO_POINTTYPE, EPO_PROCESSED, EPO_RESULT, EPO_RISK, EPO_RRESULT, EPO_STWO, EPO_TOGEOREF, EPO_TOPOINT, EPO_TOREFDESC, EPO_TO_HORIZONTAL_OFFSET, EPO_TO_HORIZONTAL_OFFSETTYPE, EPO_TO_HORIZONTAL_OFFSETUOM, EPO_TO_LATITUDE, EPO_TO_LONGITUDE, EPO_TO_OFFSET, EPO_TO_OFFSET_DIRECTION, EPO_TO_OFFSET_PERCENTAGE, EPO_TO_REFERENCE, EPO_TO_RELATIONSHIP_TYPE, EPO_TO_VERTICAL_OFFSET, EPO_TO_VERTICAL_OFFSETTYPE, EPO_TO_VERTICAL_OFFSETUOM, EPO_TO_XCOORDINATE, EPO_TO_YCOORDINATE, EPO_TYPE, EPO_UOM, EPO_UPDATECOUNT, EPO_UPDATED, EPO_VALUE, EPO_VARCHAR1, EPO_VARCHAR10, EPO_VARCHAR11, EPO_VARCHAR12, EPO_VARCHAR13, EPO_VARCHAR14, EPO_VARCHAR15, EPO_VARCHAR16, EPO_VARCHAR17, EPO_VARCHAR18, EPO_VARCHAR19, EPO_VARCHAR2, EPO_VARCHAR20, EPO_VARCHAR21, EPO_VARCHAR22, EPO_VARCHAR23, EPO_VARCHAR24, EPO_VARCHAR25, EPO_VARCHAR26, EPO_VARCHAR27, EPO_VARCHAR28, EPO_VARCHAR29, EPO_VARCHAR3, EPO_VARCHAR30, EPO_VARCHAR31, EPO_VARCHAR32, EPO_VARCHAR33, EPO_VARCHAR34, EPO_VARCHAR35, EPO_VARCHAR4, EPO_VARCHAR5, EPO_VARCHAR6, EPO_VARCHAR7, EPO_VARCHAR8, EPO_VARCHAR9, EPO_VARDATE1, EPO_VARDATE10, EPO_VARDATE11, EPO_VARDATE12, EPO_VARDATE13, EPO_VARDATE14, EPO_VARDATE15, EPO_VARDATE2, EPO_VARDATE3, EPO_VARDATE4, EPO_VARDATE5, EPO_VARDATE6, EPO_VARDATE7, EPO_VARDATE8, EPO_VARDATE9, EPO_VARNUM1, EPO_VARNUM10, EPO_VARNUM11, EPO_VARNUM12, EPO_VARNUM13, EPO_VARNUM14, EPO_VARNUM15, EPO_VARNUM16, EPO_VARNUM17, EPO_VARNUM18, EPO_VARNUM19, EPO_VARNUM2, EPO_VARNUM20, EPO_VARNUM21, EPO_VARNUM22, EPO_VARNUM23, EPO_VARNUM24, EPO_VARNUM25, EPO_VARNUM26, EPO_VARNUM27, EPO_VARNUM28, EPO_VARNUM29, EPO_VARNUM3, EPO_VARNUM30, EPO_VARNUM31, EPO_VARNUM32, EPO_VARNUM33, EPO_VARNUM34, EPO_VARNUM35, EPO_VARNUM4, EPO_VARNUM5, EPO_VARNUM6, EPO_VARNUM7, EPO_VARNUM8, EPO_VARNUM9, _DELETED, 
                    ETL_LASTSAVED,                       
                    etl_load_datetime,
                    etl_load_metadatafilename,
                    etl_is_deleted,
                    ETL_DELETED) 
            values (
                    src.EPO_ASPECT, 
                    src.EPO_ASSESSEDSLOPE, 
                    src.EPO_AVGSLOPE, 
                    src.EPO_CLASS, 
                    src.EPO_CLASS_ORG, 
                    src.EPO_CODE, 
                    src.EPO_COMMENT, 
                    src.EPO_COMPLETED, 
                    src.EPO_CONFRATING, 
                    src.EPO_CREATE, 
                    src.EPO_CREATED, 
                    src.EPO_DATE, 
                    src.EPO_EVENT, 
                    src.EPO_FINDING, 
                    src.EPO_FROMGEOREF, 
                    src.EPO_FROMPOINT, 
                    src.EPO_FROMREFDESC, 
                    src.EPO_FROM_HORIZONTAL_OFFSET, 
                    src.EPO_FROM_HORIZONTAL_OFFSETTYPE, 
                    src.EPO_FROM_HORIZONTAL_OFFSETUOM, 
                    src.EPO_FROM_LATITUDE, 
                    src.EPO_FROM_LONGITUDE, 
                    src.EPO_FROM_OFFSET, 
                    src.EPO_FROM_OFFSET_DIRECTION, 
                    src.EPO_FROM_OFFSET_PERCENTAGE, 
                    src.EPO_FROM_REFERENCE, 
                    src.EPO_FROM_RELATIONSHIP_TYPE, 
                    src.EPO_FROM_VERTICAL_OFFSET, 
                    src.EPO_FROM_VERTICAL_OFFSETTYPE, 
                    src.EPO_FROM_VERTICAL_OFFSETUOM, 
                    src.EPO_FROM_XCOORDINATE, 
                    src.EPO_FROM_YCOORDINATE, 
                    src.EPO_INSPECTOR, 
                    src.EPO_JOB, 
                    src.EPO_LASTSAVED, 
                    src.EPO_LASTSLOPE, 
                    src.EPO_LINE, 
                    src.EPO_LOCATION, 
                    src.EPO_MAX, 
                    src.EPO_MAXDATE, 
                    src.EPO_MAXPPM, 
                    src.EPO_MAXSTWO, 
                    src.EPO_MAXTOL, 
                    src.EPO_MAXTOLDATE, 
                    src.EPO_METHOD, 
                    src.EPO_MIN, 
                    src.EPO_MINDATE, 
                    src.EPO_MINPPM, 
                    src.EPO_MINSTWO, 
                    src.EPO_MINTOL, 
                    src.EPO_MINTOLDATE, 
                    src.EPO_NIDATEMAXCRIT, 
                    src.EPO_NIDATEMAXTOL, 
                    src.EPO_NIDATEMINCRIT, 
                    src.EPO_NIDATEMINTOL, 
                    src.EPO_OBJECT, 
                    src.EPO_OBJECT_ORG, 
                    src.EPO_OBRTYPE, 
                    src.EPO_OBTYPE, 
                    src.EPO_ORIGEVENT, 
                    src.EPO_PARENT, 
                    src.EPO_POINT, 
                    src.EPO_POINTTYPE, 
                    src.EPO_PROCESSED, 
                    src.EPO_RESULT, 
                    src.EPO_RISK, 
                    src.EPO_RRESULT, 
                    src.EPO_STWO, 
                    src.EPO_TOGEOREF, 
                    src.EPO_TOPOINT, 
                    src.EPO_TOREFDESC, 
                    src.EPO_TO_HORIZONTAL_OFFSET, 
                    src.EPO_TO_HORIZONTAL_OFFSETTYPE, 
                    src.EPO_TO_HORIZONTAL_OFFSETUOM, 
                    src.EPO_TO_LATITUDE, 
                    src.EPO_TO_LONGITUDE, 
                    src.EPO_TO_OFFSET, 
                    src.EPO_TO_OFFSET_DIRECTION, 
                    src.EPO_TO_OFFSET_PERCENTAGE, 
                    src.EPO_TO_REFERENCE, 
                    src.EPO_TO_RELATIONSHIP_TYPE, 
                    src.EPO_TO_VERTICAL_OFFSET, 
                    src.EPO_TO_VERTICAL_OFFSETTYPE, 
                    src.EPO_TO_VERTICAL_OFFSETUOM, 
                    src.EPO_TO_XCOORDINATE, 
                    src.EPO_TO_YCOORDINATE, 
                    src.EPO_TYPE, 
                    src.EPO_UOM, 
                    src.EPO_UPDATECOUNT, 
                    src.EPO_UPDATED, 
                    src.EPO_VALUE, 
                    src.EPO_VARCHAR1, 
                    src.EPO_VARCHAR10, 
                    src.EPO_VARCHAR11, 
                    src.EPO_VARCHAR12, 
                    src.EPO_VARCHAR13, 
                    src.EPO_VARCHAR14, 
                    src.EPO_VARCHAR15, 
                    src.EPO_VARCHAR16, 
                    src.EPO_VARCHAR17, 
                    src.EPO_VARCHAR18, 
                    src.EPO_VARCHAR19, 
                    src.EPO_VARCHAR2, 
                    src.EPO_VARCHAR20, 
                    src.EPO_VARCHAR21, 
                    src.EPO_VARCHAR22, 
                    src.EPO_VARCHAR23, 
                    src.EPO_VARCHAR24, 
                    src.EPO_VARCHAR25, 
                    src.EPO_VARCHAR26, 
                    src.EPO_VARCHAR27, 
                    src.EPO_VARCHAR28, 
                    src.EPO_VARCHAR29, 
                    src.EPO_VARCHAR3, 
                    src.EPO_VARCHAR30, 
                    src.EPO_VARCHAR31, 
                    src.EPO_VARCHAR32, 
                    src.EPO_VARCHAR33, 
                    src.EPO_VARCHAR34, 
                    src.EPO_VARCHAR35, 
                    src.EPO_VARCHAR4, 
                    src.EPO_VARCHAR5, 
                    src.EPO_VARCHAR6, 
                    src.EPO_VARCHAR7, 
                    src.EPO_VARCHAR8, 
                    src.EPO_VARCHAR9, 
                    src.EPO_VARDATE1, 
                    src.EPO_VARDATE10, 
                    src.EPO_VARDATE11, 
                    src.EPO_VARDATE12, 
                    src.EPO_VARDATE13, 
                    src.EPO_VARDATE14, 
                    src.EPO_VARDATE15, 
                    src.EPO_VARDATE2, 
                    src.EPO_VARDATE3, 
                    src.EPO_VARDATE4, 
                    src.EPO_VARDATE5, 
                    src.EPO_VARDATE6, 
                    src.EPO_VARDATE7, 
                    src.EPO_VARDATE8, 
                    src.EPO_VARDATE9, 
                    src.EPO_VARNUM1, 
                    src.EPO_VARNUM10, 
                    src.EPO_VARNUM11, 
                    src.EPO_VARNUM12, 
                    src.EPO_VARNUM13, 
                    src.EPO_VARNUM14, 
                    src.EPO_VARNUM15, 
                    src.EPO_VARNUM16, 
                    src.EPO_VARNUM17, 
                    src.EPO_VARNUM18, 
                    src.EPO_VARNUM19, 
                    src.EPO_VARNUM2, 
                    src.EPO_VARNUM20, 
                    src.EPO_VARNUM21, 
                    src.EPO_VARNUM22, 
                    src.EPO_VARNUM23, 
                    src.EPO_VARNUM24, 
                    src.EPO_VARNUM25, 
                    src.EPO_VARNUM26, 
                    src.EPO_VARNUM27, 
                    src.EPO_VARNUM28, 
                    src.EPO_VARNUM29, 
                    src.EPO_VARNUM3, 
                    src.EPO_VARNUM30, 
                    src.EPO_VARNUM31, 
                    src.EPO_VARNUM32, 
                    src.EPO_VARNUM33, 
                    src.EPO_VARNUM34, 
                    src.EPO_VARNUM35, 
                    src.EPO_VARNUM4, 
                    src.EPO_VARNUM5, 
                    src.EPO_VARNUM6, 
                    src.EPO_VARNUM7, 
                    src.EPO_VARNUM8, 
                    src.EPO_VARNUM9, 
                    src._DELETED,     
                    src.ETL_LASTSAVED,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename,
                    case when ETL_DELETED=TRUE then TRUE else FALSE end,
                    ETL_DELETED);
    `
} );

                    
//  Get number of rows inserted
        
        var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
        var rs = sqlStmt.execute();
        var number_of_rows_inserted = sqlStmt.getNumRowsInserted();
        var number_of_rows_updated =  sqlStmt.getNumRowsUpdated();
                    

        
    snowflake.execute ({sqlText: "commit"});

    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Success','Completed process execution.', 0 ," + number_of_rows_inserted.toString()+ "," +  number_of_rows_updated.toString() + ");";
    snowflake.execute({sqlText: log_sql_command});

    result = "Success"; 

    }       

    catch (err)  {
        snowflake.execute( {sqlText: "rollback;"} )
        var clean_error_msg = err.message.replace(/[^\w\s]/gi, '');
    //  Create a log entry to say INSERT STATEMENT failed
    
    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Failed','MERGE Failed. Error:" + err.code.toString()+" : "+ clean_error_msg  + "', 0 ,0,0);";
    snowflake.execute({sqlText: log_sql_command});
        ;
        throw "Failed: " + err.message;   // Return a success/error indicator.
        }
    return result;
    $$;