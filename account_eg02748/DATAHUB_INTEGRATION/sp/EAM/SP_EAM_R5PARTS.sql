create or replace procedure DATAHUB_INTEGRATION.SP_EAM_R5PARTS()
    returns varchar not null
                language javascript
                as
                $$

//  Variables

var result = "";                                    // return status of this proc call
const process_name = Object.keys(this)[0];          // name of currently executing process
var number_of_rows_inserted = 0;                             // track number of rows we have inserted
var number_of_rows_updated = 0;                             // track number of rows we have updated


//  Step 1.

//  Start execution - log start

log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('Insert','" + process_name + "','Running','Started process execution.', 0,0,0);";
snowflake.execute({sqlText: log_sql_command});

snowflake.execute( {sqlText: "begin transaction;"} );
try
    {
        var sql_command = `
                            INSERT INTO LANDING_ERROR.EAM_RAW_ERROR
                            SELECT * FROM LANDING_ERROR.VW_STREAM_EAM_R5PARTS_ERROR`;
    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();
        
        var sql_command = ` 
                            merge into  TARGET_EAM.EAM_R5PARTS as target using (SELECT * FROM (SELECT 
            strm.PAR_ASMLEVEL, 
            strm.PAR_AVGPRICE, 
            strm.PAR_BASEPRICE, 
            strm.PAR_BUYER, 
            strm.PAR_BYASSET, 
            strm.PAR_BYLOT, 
            strm.PAR_CALSTANDARD, 
            strm.PAR_CATEGORY, 
            strm.PAR_CLASS, 
            strm.PAR_CLASS_ORG, 
            strm.PAR_CODE, 
            strm.PAR_CODESTRUCTURE, 
            strm.PAR_COMMODITY, 
            strm.PAR_COMPLEVEL, 
            strm.PAR_CONDITION, 
            strm.PAR_CONDITIONTPL, 
            strm.PAR_CONDITIONTPL_ORG, 
            strm.PAR_COREVALUE, 
            strm.PAR_CREATED, 
            strm.PAR_CREATEDBY, 
            strm.PAR_DESC, 
            strm.PAR_DOCUMOTO_BOOKID, 
            strm.PAR_DOCUMOTO_PART, 
            strm.PAR_FUGITIVEEMISSIONGAS, 
            strm.PAR_IMPORTANCE, 
            strm.PAR_INSMETHOD, 
            strm.PAR_INSPECT, 
            strm.PAR_INTERFACE, 
            strm.PAR_KIT, 
            strm.PAR_LASTPRICE, 
            strm.PAR_LASTSAVED, 
            strm.PAR_LASTSTATUSUPDATE, 
            strm.PAR_LONGDESCRIPTION, 
            strm.PAR_MATERIALTYPE, 
            strm.PAR_NOTUSED, 
            strm.PAR_ORG, 
            strm.PAR_PARENTPART, 
            strm.PAR_PREFSUP, 
            strm.PAR_PREFSUPPRICE, 
            strm.PAR_PREFSUP_ORG, 
            strm.PAR_PREFUOM, 
            strm.PAR_PREVENTREORDERS, 
            strm.PAR_PROFILEPICTURE, 
            strm.PAR_REPAIRABLE, 
            strm.PAR_SAFETYREVIEWED, 
            strm.PAR_SAFETYREVIEWEDBY, 
            strm.PAR_SAFETYREVIEWEDNAME, 
            strm.PAR_SAFETYREVIEWEDTYPE, 
            strm.PAR_SAFETYREVIEWREQUIRED, 
            strm.PAR_SAVEHISTORY, 
            strm.PAR_SOURCECODE, 
            strm.PAR_SOURCESYSTEM, 
            strm.PAR_STDPRICE, 
            strm.PAR_SUBCOMMODITY, 
            strm.PAR_SYSLEVEL, 
            strm.PAR_TAX, 
            strm.PAR_TOOL, 
            strm.PAR_TRACKBYCONDITION, 
            strm.PAR_TRACKRTYPE, 
            strm.PAR_TRACKTYPE, 
            strm.PAR_UDFCHAR01, 
            strm.PAR_UDFCHAR02, 
            strm.PAR_UDFCHAR03, 
            strm.PAR_UDFCHAR04, 
            strm.PAR_UDFCHAR05, 
            strm.PAR_UDFCHAR06, 
            strm.PAR_UDFCHAR07, 
            strm.PAR_UDFCHAR08, 
            strm.PAR_UDFCHAR09, 
            strm.PAR_UDFCHAR10, 
            strm.PAR_UDFCHAR11, 
            strm.PAR_UDFCHAR12, 
            strm.PAR_UDFCHAR13, 
            strm.PAR_UDFCHAR14, 
            strm.PAR_UDFCHAR15, 
            strm.PAR_UDFCHAR16, 
            strm.PAR_UDFCHAR17, 
            strm.PAR_UDFCHAR18, 
            strm.PAR_UDFCHAR19, 
            strm.PAR_UDFCHAR20, 
            strm.PAR_UDFCHAR21, 
            strm.PAR_UDFCHAR22, 
            strm.PAR_UDFCHAR23, 
            strm.PAR_UDFCHAR24, 
            strm.PAR_UDFCHAR25, 
            strm.PAR_UDFCHAR26, 
            strm.PAR_UDFCHAR27, 
            strm.PAR_UDFCHAR28, 
            strm.PAR_UDFCHAR29, 
            strm.PAR_UDFCHAR30, 
            strm.PAR_UDFCHKBOX01, 
            strm.PAR_UDFCHKBOX02, 
            strm.PAR_UDFCHKBOX03, 
            strm.PAR_UDFCHKBOX04, 
            strm.PAR_UDFCHKBOX05, 
            strm.PAR_UDFDATE01, 
            strm.PAR_UDFDATE02, 
            strm.PAR_UDFDATE03, 
            strm.PAR_UDFDATE04, 
            strm.PAR_UDFDATE05, 
            strm.PAR_UDFNOTE01, 
            strm.PAR_UDFNOTE02, 
            strm.PAR_UDFNUM01, 
            strm.PAR_UDFNUM02, 
            strm.PAR_UDFNUM03, 
            strm.PAR_UDFNUM04, 
            strm.PAR_UDFNUM05, 
            strm.PAR_UOM, 
            strm.PAR_UPDATECOUNT, 
            strm.PAR_UPDATED, 
            strm.PAR_UPDATEDBY, 
            strm.PAR_WARDAYS, 
            strm._DELETED, 
            strm.ETL_LASTSAVED,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.PAR_CODE,
            strm.PAR_ORG ORDER BY strm.ETL_LASTSAVED desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_EAM_R5PARTS as  strm
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.PAR_CODE=src.PAR_CODE) OR (target.PAR_CODE IS NULL AND src.PAR_CODE IS NULL)) AND
            ((target.PAR_ORG=src.PAR_ORG) OR (target.PAR_ORG IS NULL AND src.PAR_ORG IS NULL)) 
                when matched and src.ETL_DELETED=TRUE THEN DELETE
                when matched then update set
                    target.PAR_ASMLEVEL=src.PAR_ASMLEVEL, 
                    target.PAR_AVGPRICE=src.PAR_AVGPRICE, 
                    target.PAR_BASEPRICE=src.PAR_BASEPRICE, 
                    target.PAR_BUYER=src.PAR_BUYER, 
                    target.PAR_BYASSET=src.PAR_BYASSET, 
                    target.PAR_BYLOT=src.PAR_BYLOT, 
                    target.PAR_CALSTANDARD=src.PAR_CALSTANDARD, 
                    target.PAR_CATEGORY=src.PAR_CATEGORY, 
                    target.PAR_CLASS=src.PAR_CLASS, 
                    target.PAR_CLASS_ORG=src.PAR_CLASS_ORG, 
                    target.PAR_CODE=src.PAR_CODE, 
                    target.PAR_CODESTRUCTURE=src.PAR_CODESTRUCTURE, 
                    target.PAR_COMMODITY=src.PAR_COMMODITY, 
                    target.PAR_COMPLEVEL=src.PAR_COMPLEVEL, 
                    target.PAR_CONDITION=src.PAR_CONDITION, 
                    target.PAR_CONDITIONTPL=src.PAR_CONDITIONTPL, 
                    target.PAR_CONDITIONTPL_ORG=src.PAR_CONDITIONTPL_ORG, 
                    target.PAR_COREVALUE=src.PAR_COREVALUE, 
                    target.PAR_CREATED=src.PAR_CREATED, 
                    target.PAR_CREATEDBY=src.PAR_CREATEDBY, 
                    target.PAR_DESC=src.PAR_DESC, 
                    target.PAR_DOCUMOTO_BOOKID=src.PAR_DOCUMOTO_BOOKID, 
                    target.PAR_DOCUMOTO_PART=src.PAR_DOCUMOTO_PART, 
                    target.PAR_FUGITIVEEMISSIONGAS=src.PAR_FUGITIVEEMISSIONGAS, 
                    target.PAR_IMPORTANCE=src.PAR_IMPORTANCE, 
                    target.PAR_INSMETHOD=src.PAR_INSMETHOD, 
                    target.PAR_INSPECT=src.PAR_INSPECT, 
                    target.PAR_INTERFACE=src.PAR_INTERFACE, 
                    target.PAR_KIT=src.PAR_KIT, 
                    target.PAR_LASTPRICE=src.PAR_LASTPRICE, 
                    target.PAR_LASTSAVED=src.PAR_LASTSAVED, 
                    target.PAR_LASTSTATUSUPDATE=src.PAR_LASTSTATUSUPDATE, 
                    target.PAR_LONGDESCRIPTION=src.PAR_LONGDESCRIPTION, 
                    target.PAR_MATERIALTYPE=src.PAR_MATERIALTYPE, 
                    target.PAR_NOTUSED=src.PAR_NOTUSED, 
                    target.PAR_ORG=src.PAR_ORG, 
                    target.PAR_PARENTPART=src.PAR_PARENTPART, 
                    target.PAR_PREFSUP=src.PAR_PREFSUP, 
                    target.PAR_PREFSUPPRICE=src.PAR_PREFSUPPRICE, 
                    target.PAR_PREFSUP_ORG=src.PAR_PREFSUP_ORG, 
                    target.PAR_PREFUOM=src.PAR_PREFUOM, 
                    target.PAR_PREVENTREORDERS=src.PAR_PREVENTREORDERS, 
                    target.PAR_PROFILEPICTURE=src.PAR_PROFILEPICTURE, 
                    target.PAR_REPAIRABLE=src.PAR_REPAIRABLE, 
                    target.PAR_SAFETYREVIEWED=src.PAR_SAFETYREVIEWED, 
                    target.PAR_SAFETYREVIEWEDBY=src.PAR_SAFETYREVIEWEDBY, 
                    target.PAR_SAFETYREVIEWEDNAME=src.PAR_SAFETYREVIEWEDNAME, 
                    target.PAR_SAFETYREVIEWEDTYPE=src.PAR_SAFETYREVIEWEDTYPE, 
                    target.PAR_SAFETYREVIEWREQUIRED=src.PAR_SAFETYREVIEWREQUIRED, 
                    target.PAR_SAVEHISTORY=src.PAR_SAVEHISTORY, 
                    target.PAR_SOURCECODE=src.PAR_SOURCECODE, 
                    target.PAR_SOURCESYSTEM=src.PAR_SOURCESYSTEM, 
                    target.PAR_STDPRICE=src.PAR_STDPRICE, 
                    target.PAR_SUBCOMMODITY=src.PAR_SUBCOMMODITY, 
                    target.PAR_SYSLEVEL=src.PAR_SYSLEVEL, 
                    target.PAR_TAX=src.PAR_TAX, 
                    target.PAR_TOOL=src.PAR_TOOL, 
                    target.PAR_TRACKBYCONDITION=src.PAR_TRACKBYCONDITION, 
                    target.PAR_TRACKRTYPE=src.PAR_TRACKRTYPE, 
                    target.PAR_TRACKTYPE=src.PAR_TRACKTYPE, 
                    target.PAR_UDFCHAR01=src.PAR_UDFCHAR01, 
                    target.PAR_UDFCHAR02=src.PAR_UDFCHAR02, 
                    target.PAR_UDFCHAR03=src.PAR_UDFCHAR03, 
                    target.PAR_UDFCHAR04=src.PAR_UDFCHAR04, 
                    target.PAR_UDFCHAR05=src.PAR_UDFCHAR05, 
                    target.PAR_UDFCHAR06=src.PAR_UDFCHAR06, 
                    target.PAR_UDFCHAR07=src.PAR_UDFCHAR07, 
                    target.PAR_UDFCHAR08=src.PAR_UDFCHAR08, 
                    target.PAR_UDFCHAR09=src.PAR_UDFCHAR09, 
                    target.PAR_UDFCHAR10=src.PAR_UDFCHAR10, 
                    target.PAR_UDFCHAR11=src.PAR_UDFCHAR11, 
                    target.PAR_UDFCHAR12=src.PAR_UDFCHAR12, 
                    target.PAR_UDFCHAR13=src.PAR_UDFCHAR13, 
                    target.PAR_UDFCHAR14=src.PAR_UDFCHAR14, 
                    target.PAR_UDFCHAR15=src.PAR_UDFCHAR15, 
                    target.PAR_UDFCHAR16=src.PAR_UDFCHAR16, 
                    target.PAR_UDFCHAR17=src.PAR_UDFCHAR17, 
                    target.PAR_UDFCHAR18=src.PAR_UDFCHAR18, 
                    target.PAR_UDFCHAR19=src.PAR_UDFCHAR19, 
                    target.PAR_UDFCHAR20=src.PAR_UDFCHAR20, 
                    target.PAR_UDFCHAR21=src.PAR_UDFCHAR21, 
                    target.PAR_UDFCHAR22=src.PAR_UDFCHAR22, 
                    target.PAR_UDFCHAR23=src.PAR_UDFCHAR23, 
                    target.PAR_UDFCHAR24=src.PAR_UDFCHAR24, 
                    target.PAR_UDFCHAR25=src.PAR_UDFCHAR25, 
                    target.PAR_UDFCHAR26=src.PAR_UDFCHAR26, 
                    target.PAR_UDFCHAR27=src.PAR_UDFCHAR27, 
                    target.PAR_UDFCHAR28=src.PAR_UDFCHAR28, 
                    target.PAR_UDFCHAR29=src.PAR_UDFCHAR29, 
                    target.PAR_UDFCHAR30=src.PAR_UDFCHAR30, 
                    target.PAR_UDFCHKBOX01=src.PAR_UDFCHKBOX01, 
                    target.PAR_UDFCHKBOX02=src.PAR_UDFCHKBOX02, 
                    target.PAR_UDFCHKBOX03=src.PAR_UDFCHKBOX03, 
                    target.PAR_UDFCHKBOX04=src.PAR_UDFCHKBOX04, 
                    target.PAR_UDFCHKBOX05=src.PAR_UDFCHKBOX05, 
                    target.PAR_UDFDATE01=src.PAR_UDFDATE01, 
                    target.PAR_UDFDATE02=src.PAR_UDFDATE02, 
                    target.PAR_UDFDATE03=src.PAR_UDFDATE03, 
                    target.PAR_UDFDATE04=src.PAR_UDFDATE04, 
                    target.PAR_UDFDATE05=src.PAR_UDFDATE05, 
                    target.PAR_UDFNOTE01=src.PAR_UDFNOTE01, 
                    target.PAR_UDFNOTE02=src.PAR_UDFNOTE02, 
                    target.PAR_UDFNUM01=src.PAR_UDFNUM01, 
                    target.PAR_UDFNUM02=src.PAR_UDFNUM02, 
                    target.PAR_UDFNUM03=src.PAR_UDFNUM03, 
                    target.PAR_UDFNUM04=src.PAR_UDFNUM04, 
                    target.PAR_UDFNUM05=src.PAR_UDFNUM05, 
                    target.PAR_UOM=src.PAR_UOM, 
                    target.PAR_UPDATECOUNT=src.PAR_UPDATECOUNT, 
                    target.PAR_UPDATED=src.PAR_UPDATED, 
                    target.PAR_UPDATEDBY=src.PAR_UPDATEDBY, 
                    target.PAR_WARDAYS=src.PAR_WARDAYS, 
                    target._DELETED=src._DELETED, 
                    target.ETL_LASTSAVED=src.ETL_LASTSAVED,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename
        when not matched and (src.ETL_DELETED=FALSE OR src.ETL_DELETED IS NULL)  then insert ( 
                    PAR_ASMLEVEL, 
                    PAR_AVGPRICE, 
                    PAR_BASEPRICE, 
                    PAR_BUYER, 
                    PAR_BYASSET, 
                    PAR_BYLOT, 
                    PAR_CALSTANDARD, 
                    PAR_CATEGORY, 
                    PAR_CLASS, 
                    PAR_CLASS_ORG, 
                    PAR_CODE, 
                    PAR_CODESTRUCTURE, 
                    PAR_COMMODITY, 
                    PAR_COMPLEVEL, 
                    PAR_CONDITION, 
                    PAR_CONDITIONTPL, 
                    PAR_CONDITIONTPL_ORG, 
                    PAR_COREVALUE, 
                    PAR_CREATED, 
                    PAR_CREATEDBY, 
                    PAR_DESC, 
                    PAR_DOCUMOTO_BOOKID, 
                    PAR_DOCUMOTO_PART, 
                    PAR_FUGITIVEEMISSIONGAS, 
                    PAR_IMPORTANCE, 
                    PAR_INSMETHOD, 
                    PAR_INSPECT, 
                    PAR_INTERFACE, 
                    PAR_KIT, 
                    PAR_LASTPRICE, 
                    PAR_LASTSAVED, 
                    PAR_LASTSTATUSUPDATE, 
                    PAR_LONGDESCRIPTION, 
                    PAR_MATERIALTYPE, 
                    PAR_NOTUSED, 
                    PAR_ORG, 
                    PAR_PARENTPART, 
                    PAR_PREFSUP, 
                    PAR_PREFSUPPRICE, 
                    PAR_PREFSUP_ORG, 
                    PAR_PREFUOM, 
                    PAR_PREVENTREORDERS, 
                    PAR_PROFILEPICTURE, 
                    PAR_REPAIRABLE, 
                    PAR_SAFETYREVIEWED, 
                    PAR_SAFETYREVIEWEDBY, 
                    PAR_SAFETYREVIEWEDNAME, 
                    PAR_SAFETYREVIEWEDTYPE, 
                    PAR_SAFETYREVIEWREQUIRED, 
                    PAR_SAVEHISTORY, 
                    PAR_SOURCECODE, 
                    PAR_SOURCESYSTEM, 
                    PAR_STDPRICE, 
                    PAR_SUBCOMMODITY, 
                    PAR_SYSLEVEL, 
                    PAR_TAX, 
                    PAR_TOOL, 
                    PAR_TRACKBYCONDITION, 
                    PAR_TRACKRTYPE, 
                    PAR_TRACKTYPE, 
                    PAR_UDFCHAR01, 
                    PAR_UDFCHAR02, 
                    PAR_UDFCHAR03, 
                    PAR_UDFCHAR04, 
                    PAR_UDFCHAR05, 
                    PAR_UDFCHAR06, 
                    PAR_UDFCHAR07, 
                    PAR_UDFCHAR08, 
                    PAR_UDFCHAR09, 
                    PAR_UDFCHAR10, 
                    PAR_UDFCHAR11, 
                    PAR_UDFCHAR12, 
                    PAR_UDFCHAR13, 
                    PAR_UDFCHAR14, 
                    PAR_UDFCHAR15, 
                    PAR_UDFCHAR16, 
                    PAR_UDFCHAR17, 
                    PAR_UDFCHAR18, 
                    PAR_UDFCHAR19, 
                    PAR_UDFCHAR20, 
                    PAR_UDFCHAR21, 
                    PAR_UDFCHAR22, 
                    PAR_UDFCHAR23, 
                    PAR_UDFCHAR24, 
                    PAR_UDFCHAR25, 
                    PAR_UDFCHAR26, 
                    PAR_UDFCHAR27, 
                    PAR_UDFCHAR28, 
                    PAR_UDFCHAR29, 
                    PAR_UDFCHAR30, 
                    PAR_UDFCHKBOX01, 
                    PAR_UDFCHKBOX02, 
                    PAR_UDFCHKBOX03, 
                    PAR_UDFCHKBOX04, 
                    PAR_UDFCHKBOX05, 
                    PAR_UDFDATE01, 
                    PAR_UDFDATE02, 
                    PAR_UDFDATE03, 
                    PAR_UDFDATE04, 
                    PAR_UDFDATE05, 
                    PAR_UDFNOTE01, 
                    PAR_UDFNOTE02, 
                    PAR_UDFNUM01, 
                    PAR_UDFNUM02, 
                    PAR_UDFNUM03, 
                    PAR_UDFNUM04, 
                    PAR_UDFNUM05, 
                    PAR_UOM, 
                    PAR_UPDATECOUNT, 
                    PAR_UPDATED, 
                    PAR_UPDATEDBY, 
                    PAR_WARDAYS, 
                    _DELETED, 
                    ETL_LASTSAVED,                       
                    etl_load_datetime,
                    etl_load_metadatafilename) 
            values (
                    src.PAR_ASMLEVEL, 
                    src.PAR_AVGPRICE, 
                    src.PAR_BASEPRICE, 
                    src.PAR_BUYER, 
                    src.PAR_BYASSET, 
                    src.PAR_BYLOT, 
                    src.PAR_CALSTANDARD, 
                    src.PAR_CATEGORY, 
                    src.PAR_CLASS, 
                    src.PAR_CLASS_ORG, 
                    src.PAR_CODE, 
                    src.PAR_CODESTRUCTURE, 
                    src.PAR_COMMODITY, 
                    src.PAR_COMPLEVEL, 
                    src.PAR_CONDITION, 
                    src.PAR_CONDITIONTPL, 
                    src.PAR_CONDITIONTPL_ORG, 
                    src.PAR_COREVALUE, 
                    src.PAR_CREATED, 
                    src.PAR_CREATEDBY, 
                    src.PAR_DESC, 
                    src.PAR_DOCUMOTO_BOOKID, 
                    src.PAR_DOCUMOTO_PART, 
                    src.PAR_FUGITIVEEMISSIONGAS, 
                    src.PAR_IMPORTANCE, 
                    src.PAR_INSMETHOD, 
                    src.PAR_INSPECT, 
                    src.PAR_INTERFACE, 
                    src.PAR_KIT, 
                    src.PAR_LASTPRICE, 
                    src.PAR_LASTSAVED, 
                    src.PAR_LASTSTATUSUPDATE, 
                    src.PAR_LONGDESCRIPTION, 
                    src.PAR_MATERIALTYPE, 
                    src.PAR_NOTUSED, 
                    src.PAR_ORG, 
                    src.PAR_PARENTPART, 
                    src.PAR_PREFSUP, 
                    src.PAR_PREFSUPPRICE, 
                    src.PAR_PREFSUP_ORG, 
                    src.PAR_PREFUOM, 
                    src.PAR_PREVENTREORDERS, 
                    src.PAR_PROFILEPICTURE, 
                    src.PAR_REPAIRABLE, 
                    src.PAR_SAFETYREVIEWED, 
                    src.PAR_SAFETYREVIEWEDBY, 
                    src.PAR_SAFETYREVIEWEDNAME, 
                    src.PAR_SAFETYREVIEWEDTYPE, 
                    src.PAR_SAFETYREVIEWREQUIRED, 
                    src.PAR_SAVEHISTORY, 
                    src.PAR_SOURCECODE, 
                    src.PAR_SOURCESYSTEM, 
                    src.PAR_STDPRICE, 
                    src.PAR_SUBCOMMODITY, 
                    src.PAR_SYSLEVEL, 
                    src.PAR_TAX, 
                    src.PAR_TOOL, 
                    src.PAR_TRACKBYCONDITION, 
                    src.PAR_TRACKRTYPE, 
                    src.PAR_TRACKTYPE, 
                    src.PAR_UDFCHAR01, 
                    src.PAR_UDFCHAR02, 
                    src.PAR_UDFCHAR03, 
                    src.PAR_UDFCHAR04, 
                    src.PAR_UDFCHAR05, 
                    src.PAR_UDFCHAR06, 
                    src.PAR_UDFCHAR07, 
                    src.PAR_UDFCHAR08, 
                    src.PAR_UDFCHAR09, 
                    src.PAR_UDFCHAR10, 
                    src.PAR_UDFCHAR11, 
                    src.PAR_UDFCHAR12, 
                    src.PAR_UDFCHAR13, 
                    src.PAR_UDFCHAR14, 
                    src.PAR_UDFCHAR15, 
                    src.PAR_UDFCHAR16, 
                    src.PAR_UDFCHAR17, 
                    src.PAR_UDFCHAR18, 
                    src.PAR_UDFCHAR19, 
                    src.PAR_UDFCHAR20, 
                    src.PAR_UDFCHAR21, 
                    src.PAR_UDFCHAR22, 
                    src.PAR_UDFCHAR23, 
                    src.PAR_UDFCHAR24, 
                    src.PAR_UDFCHAR25, 
                    src.PAR_UDFCHAR26, 
                    src.PAR_UDFCHAR27, 
                    src.PAR_UDFCHAR28, 
                    src.PAR_UDFCHAR29, 
                    src.PAR_UDFCHAR30, 
                    src.PAR_UDFCHKBOX01, 
                    src.PAR_UDFCHKBOX02, 
                    src.PAR_UDFCHKBOX03, 
                    src.PAR_UDFCHKBOX04, 
                    src.PAR_UDFCHKBOX05, 
                    src.PAR_UDFDATE01, 
                    src.PAR_UDFDATE02, 
                    src.PAR_UDFDATE03, 
                    src.PAR_UDFDATE04, 
                    src.PAR_UDFDATE05, 
                    src.PAR_UDFNOTE01, 
                    src.PAR_UDFNOTE02, 
                    src.PAR_UDFNUM01, 
                    src.PAR_UDFNUM02, 
                    src.PAR_UDFNUM03, 
                    src.PAR_UDFNUM04, 
                    src.PAR_UDFNUM05, 
                    src.PAR_UOM, 
                    src.PAR_UPDATECOUNT, 
                    src.PAR_UPDATED, 
                    src.PAR_UPDATEDBY, 
                    src.PAR_WARDAYS, 
                    src._DELETED,     
                    src.ETL_LASTSAVED,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename);`;

    var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
    var rs = sqlStmt.execute();

    snowflake.execute( {sqlText: `merge into TARGET_HISTORY_EAM.EAM_R5PARTS_DELETED as target using (
                SELECT * FROM (SELECT 
            strm.PAR_ASMLEVEL, 
            strm.PAR_AVGPRICE, 
            strm.PAR_BASEPRICE, 
            strm.PAR_BUYER, 
            strm.PAR_BYASSET, 
            strm.PAR_BYLOT, 
            strm.PAR_CALSTANDARD, 
            strm.PAR_CATEGORY, 
            strm.PAR_CLASS, 
            strm.PAR_CLASS_ORG, 
            strm.PAR_CODE, 
            strm.PAR_CODESTRUCTURE, 
            strm.PAR_COMMODITY, 
            strm.PAR_COMPLEVEL, 
            strm.PAR_CONDITION, 
            strm.PAR_CONDITIONTPL, 
            strm.PAR_CONDITIONTPL_ORG, 
            strm.PAR_COREVALUE, 
            strm.PAR_CREATED, 
            strm.PAR_CREATEDBY, 
            strm.PAR_DESC, 
            strm.PAR_DOCUMOTO_BOOKID, 
            strm.PAR_DOCUMOTO_PART, 
            strm.PAR_FUGITIVEEMISSIONGAS, 
            strm.PAR_IMPORTANCE, 
            strm.PAR_INSMETHOD, 
            strm.PAR_INSPECT, 
            strm.PAR_INTERFACE, 
            strm.PAR_KIT, 
            strm.PAR_LASTPRICE, 
            strm.PAR_LASTSAVED, 
            strm.PAR_LASTSTATUSUPDATE, 
            strm.PAR_LONGDESCRIPTION, 
            strm.PAR_MATERIALTYPE, 
            strm.PAR_NOTUSED, 
            strm.PAR_ORG, 
            strm.PAR_PARENTPART, 
            strm.PAR_PREFSUP, 
            strm.PAR_PREFSUPPRICE, 
            strm.PAR_PREFSUP_ORG, 
            strm.PAR_PREFUOM, 
            strm.PAR_PREVENTREORDERS, 
            strm.PAR_PROFILEPICTURE, 
            strm.PAR_REPAIRABLE, 
            strm.PAR_SAFETYREVIEWED, 
            strm.PAR_SAFETYREVIEWEDBY, 
            strm.PAR_SAFETYREVIEWEDNAME, 
            strm.PAR_SAFETYREVIEWEDTYPE, 
            strm.PAR_SAFETYREVIEWREQUIRED, 
            strm.PAR_SAVEHISTORY, 
            strm.PAR_SOURCECODE, 
            strm.PAR_SOURCESYSTEM, 
            strm.PAR_STDPRICE, 
            strm.PAR_SUBCOMMODITY, 
            strm.PAR_SYSLEVEL, 
            strm.PAR_TAX, 
            strm.PAR_TOOL, 
            strm.PAR_TRACKBYCONDITION, 
            strm.PAR_TRACKRTYPE, 
            strm.PAR_TRACKTYPE, 
            strm.PAR_UDFCHAR01, 
            strm.PAR_UDFCHAR02, 
            strm.PAR_UDFCHAR03, 
            strm.PAR_UDFCHAR04, 
            strm.PAR_UDFCHAR05, 
            strm.PAR_UDFCHAR06, 
            strm.PAR_UDFCHAR07, 
            strm.PAR_UDFCHAR08, 
            strm.PAR_UDFCHAR09, 
            strm.PAR_UDFCHAR10, 
            strm.PAR_UDFCHAR11, 
            strm.PAR_UDFCHAR12, 
            strm.PAR_UDFCHAR13, 
            strm.PAR_UDFCHAR14, 
            strm.PAR_UDFCHAR15, 
            strm.PAR_UDFCHAR16, 
            strm.PAR_UDFCHAR17, 
            strm.PAR_UDFCHAR18, 
            strm.PAR_UDFCHAR19, 
            strm.PAR_UDFCHAR20, 
            strm.PAR_UDFCHAR21, 
            strm.PAR_UDFCHAR22, 
            strm.PAR_UDFCHAR23, 
            strm.PAR_UDFCHAR24, 
            strm.PAR_UDFCHAR25, 
            strm.PAR_UDFCHAR26, 
            strm.PAR_UDFCHAR27, 
            strm.PAR_UDFCHAR28, 
            strm.PAR_UDFCHAR29, 
            strm.PAR_UDFCHAR30, 
            strm.PAR_UDFCHKBOX01, 
            strm.PAR_UDFCHKBOX02, 
            strm.PAR_UDFCHKBOX03, 
            strm.PAR_UDFCHKBOX04, 
            strm.PAR_UDFCHKBOX05, 
            strm.PAR_UDFDATE01, 
            strm.PAR_UDFDATE02, 
            strm.PAR_UDFDATE03, 
            strm.PAR_UDFDATE04, 
            strm.PAR_UDFDATE05, 
            strm.PAR_UDFNOTE01, 
            strm.PAR_UDFNOTE02, 
            strm.PAR_UDFNUM01, 
            strm.PAR_UDFNUM02, 
            strm.PAR_UDFNUM03, 
            strm.PAR_UDFNUM04, 
            strm.PAR_UDFNUM05, 
            strm.PAR_UOM, 
            strm.PAR_UPDATECOUNT, 
            strm.PAR_UPDATED, 
            strm.PAR_UPDATEDBY, 
            strm.PAR_WARDAYS, 
            strm._DELETED, 
            strm.ETL_LASTSAVED,
            strm.ETL_DELETED,
            strm.etl_load_datetime,
            strm.etl_load_metadatafilename,
            ROW_NUMBER() OVER (PARTITION BY 
            strm.PAR_CODE,
            strm.PAR_ORG ORDER BY strm.ETL_LASTSAVED desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
        FROM DATAHUB_INTEGRATION.VW_STREAM_EAM_R5PARTS as  strm
        WHERE strm.ETL_DELETED=TRUE
                    )   
            WHERE ROWNUMBER=1  
            
                    ) as src on
            ((target.PAR_CODE=src.PAR_CODE) OR (target.PAR_CODE IS NULL AND src.PAR_CODE IS NULL)) AND
            ((target.PAR_ORG=src.PAR_ORG) OR (target.PAR_ORG IS NULL AND src.PAR_ORG IS NULL)) 
                when matched then update set
                    target.PAR_ASMLEVEL=src.PAR_ASMLEVEL, 
                    target.PAR_AVGPRICE=src.PAR_AVGPRICE, 
                    target.PAR_BASEPRICE=src.PAR_BASEPRICE, 
                    target.PAR_BUYER=src.PAR_BUYER, 
                    target.PAR_BYASSET=src.PAR_BYASSET, 
                    target.PAR_BYLOT=src.PAR_BYLOT, 
                    target.PAR_CALSTANDARD=src.PAR_CALSTANDARD, 
                    target.PAR_CATEGORY=src.PAR_CATEGORY, 
                    target.PAR_CLASS=src.PAR_CLASS, 
                    target.PAR_CLASS_ORG=src.PAR_CLASS_ORG, 
                    target.PAR_CODE=src.PAR_CODE, 
                    target.PAR_CODESTRUCTURE=src.PAR_CODESTRUCTURE, 
                    target.PAR_COMMODITY=src.PAR_COMMODITY, 
                    target.PAR_COMPLEVEL=src.PAR_COMPLEVEL, 
                    target.PAR_CONDITION=src.PAR_CONDITION, 
                    target.PAR_CONDITIONTPL=src.PAR_CONDITIONTPL, 
                    target.PAR_CONDITIONTPL_ORG=src.PAR_CONDITIONTPL_ORG, 
                    target.PAR_COREVALUE=src.PAR_COREVALUE, 
                    target.PAR_CREATED=src.PAR_CREATED, 
                    target.PAR_CREATEDBY=src.PAR_CREATEDBY, 
                    target.PAR_DESC=src.PAR_DESC, 
                    target.PAR_DOCUMOTO_BOOKID=src.PAR_DOCUMOTO_BOOKID, 
                    target.PAR_DOCUMOTO_PART=src.PAR_DOCUMOTO_PART, 
                    target.PAR_FUGITIVEEMISSIONGAS=src.PAR_FUGITIVEEMISSIONGAS, 
                    target.PAR_IMPORTANCE=src.PAR_IMPORTANCE, 
                    target.PAR_INSMETHOD=src.PAR_INSMETHOD, 
                    target.PAR_INSPECT=src.PAR_INSPECT, 
                    target.PAR_INTERFACE=src.PAR_INTERFACE, 
                    target.PAR_KIT=src.PAR_KIT, 
                    target.PAR_LASTPRICE=src.PAR_LASTPRICE, 
                    target.PAR_LASTSAVED=src.PAR_LASTSAVED, 
                    target.PAR_LASTSTATUSUPDATE=src.PAR_LASTSTATUSUPDATE, 
                    target.PAR_LONGDESCRIPTION=src.PAR_LONGDESCRIPTION, 
                    target.PAR_MATERIALTYPE=src.PAR_MATERIALTYPE, 
                    target.PAR_NOTUSED=src.PAR_NOTUSED, 
                    target.PAR_ORG=src.PAR_ORG, 
                    target.PAR_PARENTPART=src.PAR_PARENTPART, 
                    target.PAR_PREFSUP=src.PAR_PREFSUP, 
                    target.PAR_PREFSUPPRICE=src.PAR_PREFSUPPRICE, 
                    target.PAR_PREFSUP_ORG=src.PAR_PREFSUP_ORG, 
                    target.PAR_PREFUOM=src.PAR_PREFUOM, 
                    target.PAR_PREVENTREORDERS=src.PAR_PREVENTREORDERS, 
                    target.PAR_PROFILEPICTURE=src.PAR_PROFILEPICTURE, 
                    target.PAR_REPAIRABLE=src.PAR_REPAIRABLE, 
                    target.PAR_SAFETYREVIEWED=src.PAR_SAFETYREVIEWED, 
                    target.PAR_SAFETYREVIEWEDBY=src.PAR_SAFETYREVIEWEDBY, 
                    target.PAR_SAFETYREVIEWEDNAME=src.PAR_SAFETYREVIEWEDNAME, 
                    target.PAR_SAFETYREVIEWEDTYPE=src.PAR_SAFETYREVIEWEDTYPE, 
                    target.PAR_SAFETYREVIEWREQUIRED=src.PAR_SAFETYREVIEWREQUIRED, 
                    target.PAR_SAVEHISTORY=src.PAR_SAVEHISTORY, 
                    target.PAR_SOURCECODE=src.PAR_SOURCECODE, 
                    target.PAR_SOURCESYSTEM=src.PAR_SOURCESYSTEM, 
                    target.PAR_STDPRICE=src.PAR_STDPRICE, 
                    target.PAR_SUBCOMMODITY=src.PAR_SUBCOMMODITY, 
                    target.PAR_SYSLEVEL=src.PAR_SYSLEVEL, 
                    target.PAR_TAX=src.PAR_TAX, 
                    target.PAR_TOOL=src.PAR_TOOL, 
                    target.PAR_TRACKBYCONDITION=src.PAR_TRACKBYCONDITION, 
                    target.PAR_TRACKRTYPE=src.PAR_TRACKRTYPE, 
                    target.PAR_TRACKTYPE=src.PAR_TRACKTYPE, 
                    target.PAR_UDFCHAR01=src.PAR_UDFCHAR01, 
                    target.PAR_UDFCHAR02=src.PAR_UDFCHAR02, 
                    target.PAR_UDFCHAR03=src.PAR_UDFCHAR03, 
                    target.PAR_UDFCHAR04=src.PAR_UDFCHAR04, 
                    target.PAR_UDFCHAR05=src.PAR_UDFCHAR05, 
                    target.PAR_UDFCHAR06=src.PAR_UDFCHAR06, 
                    target.PAR_UDFCHAR07=src.PAR_UDFCHAR07, 
                    target.PAR_UDFCHAR08=src.PAR_UDFCHAR08, 
                    target.PAR_UDFCHAR09=src.PAR_UDFCHAR09, 
                    target.PAR_UDFCHAR10=src.PAR_UDFCHAR10, 
                    target.PAR_UDFCHAR11=src.PAR_UDFCHAR11, 
                    target.PAR_UDFCHAR12=src.PAR_UDFCHAR12, 
                    target.PAR_UDFCHAR13=src.PAR_UDFCHAR13, 
                    target.PAR_UDFCHAR14=src.PAR_UDFCHAR14, 
                    target.PAR_UDFCHAR15=src.PAR_UDFCHAR15, 
                    target.PAR_UDFCHAR16=src.PAR_UDFCHAR16, 
                    target.PAR_UDFCHAR17=src.PAR_UDFCHAR17, 
                    target.PAR_UDFCHAR18=src.PAR_UDFCHAR18, 
                    target.PAR_UDFCHAR19=src.PAR_UDFCHAR19, 
                    target.PAR_UDFCHAR20=src.PAR_UDFCHAR20, 
                    target.PAR_UDFCHAR21=src.PAR_UDFCHAR21, 
                    target.PAR_UDFCHAR22=src.PAR_UDFCHAR22, 
                    target.PAR_UDFCHAR23=src.PAR_UDFCHAR23, 
                    target.PAR_UDFCHAR24=src.PAR_UDFCHAR24, 
                    target.PAR_UDFCHAR25=src.PAR_UDFCHAR25, 
                    target.PAR_UDFCHAR26=src.PAR_UDFCHAR26, 
                    target.PAR_UDFCHAR27=src.PAR_UDFCHAR27, 
                    target.PAR_UDFCHAR28=src.PAR_UDFCHAR28, 
                    target.PAR_UDFCHAR29=src.PAR_UDFCHAR29, 
                    target.PAR_UDFCHAR30=src.PAR_UDFCHAR30, 
                    target.PAR_UDFCHKBOX01=src.PAR_UDFCHKBOX01, 
                    target.PAR_UDFCHKBOX02=src.PAR_UDFCHKBOX02, 
                    target.PAR_UDFCHKBOX03=src.PAR_UDFCHKBOX03, 
                    target.PAR_UDFCHKBOX04=src.PAR_UDFCHKBOX04, 
                    target.PAR_UDFCHKBOX05=src.PAR_UDFCHKBOX05, 
                    target.PAR_UDFDATE01=src.PAR_UDFDATE01, 
                    target.PAR_UDFDATE02=src.PAR_UDFDATE02, 
                    target.PAR_UDFDATE03=src.PAR_UDFDATE03, 
                    target.PAR_UDFDATE04=src.PAR_UDFDATE04, 
                    target.PAR_UDFDATE05=src.PAR_UDFDATE05, 
                    target.PAR_UDFNOTE01=src.PAR_UDFNOTE01, 
                    target.PAR_UDFNOTE02=src.PAR_UDFNOTE02, 
                    target.PAR_UDFNUM01=src.PAR_UDFNUM01, 
                    target.PAR_UDFNUM02=src.PAR_UDFNUM02, 
                    target.PAR_UDFNUM03=src.PAR_UDFNUM03, 
                    target.PAR_UDFNUM04=src.PAR_UDFNUM04, 
                    target.PAR_UDFNUM05=src.PAR_UDFNUM05, 
                    target.PAR_UOM=src.PAR_UOM, 
                    target.PAR_UPDATECOUNT=src.PAR_UPDATECOUNT, 
                    target.PAR_UPDATED=src.PAR_UPDATED, 
                    target.PAR_UPDATEDBY=src.PAR_UPDATEDBY, 
                    target.PAR_WARDAYS=src.PAR_WARDAYS, 
                    target._DELETED=src._DELETED, 
                    target.ETL_LASTSAVED=src.ETL_LASTSAVED,
                    target.etl_load_datetime=CURRENT_TIMESTAMP,
                    target.etl_load_metadatafilename=src.etl_load_metadatafilename,
                    target.ETL_DELETED=src.ETL_DELETED
        when not matched   then insert ( PAR_ASMLEVEL, PAR_AVGPRICE, PAR_BASEPRICE, PAR_BUYER, PAR_BYASSET, PAR_BYLOT, PAR_CALSTANDARD, PAR_CATEGORY, PAR_CLASS, PAR_CLASS_ORG, PAR_CODE, PAR_CODESTRUCTURE, PAR_COMMODITY, PAR_COMPLEVEL, PAR_CONDITION, PAR_CONDITIONTPL, PAR_CONDITIONTPL_ORG, PAR_COREVALUE, PAR_CREATED, PAR_CREATEDBY, PAR_DESC, PAR_DOCUMOTO_BOOKID, PAR_DOCUMOTO_PART, PAR_FUGITIVEEMISSIONGAS, PAR_IMPORTANCE, PAR_INSMETHOD, PAR_INSPECT, PAR_INTERFACE, PAR_KIT, PAR_LASTPRICE, PAR_LASTSAVED, PAR_LASTSTATUSUPDATE, PAR_LONGDESCRIPTION, PAR_MATERIALTYPE, PAR_NOTUSED, PAR_ORG, PAR_PARENTPART, PAR_PREFSUP, PAR_PREFSUPPRICE, PAR_PREFSUP_ORG, PAR_PREFUOM, PAR_PREVENTREORDERS, PAR_PROFILEPICTURE, PAR_REPAIRABLE, PAR_SAFETYREVIEWED, PAR_SAFETYREVIEWEDBY, PAR_SAFETYREVIEWEDNAME, PAR_SAFETYREVIEWEDTYPE, PAR_SAFETYREVIEWREQUIRED, PAR_SAVEHISTORY, PAR_SOURCECODE, PAR_SOURCESYSTEM, PAR_STDPRICE, PAR_SUBCOMMODITY, PAR_SYSLEVEL, PAR_TAX, PAR_TOOL, PAR_TRACKBYCONDITION, PAR_TRACKRTYPE, PAR_TRACKTYPE, PAR_UDFCHAR01, PAR_UDFCHAR02, PAR_UDFCHAR03, PAR_UDFCHAR04, PAR_UDFCHAR05, PAR_UDFCHAR06, PAR_UDFCHAR07, PAR_UDFCHAR08, PAR_UDFCHAR09, PAR_UDFCHAR10, PAR_UDFCHAR11, PAR_UDFCHAR12, PAR_UDFCHAR13, PAR_UDFCHAR14, PAR_UDFCHAR15, PAR_UDFCHAR16, PAR_UDFCHAR17, PAR_UDFCHAR18, PAR_UDFCHAR19, PAR_UDFCHAR20, PAR_UDFCHAR21, PAR_UDFCHAR22, PAR_UDFCHAR23, PAR_UDFCHAR24, PAR_UDFCHAR25, PAR_UDFCHAR26, PAR_UDFCHAR27, PAR_UDFCHAR28, PAR_UDFCHAR29, PAR_UDFCHAR30, PAR_UDFCHKBOX01, PAR_UDFCHKBOX02, PAR_UDFCHKBOX03, PAR_UDFCHKBOX04, PAR_UDFCHKBOX05, PAR_UDFDATE01, PAR_UDFDATE02, PAR_UDFDATE03, PAR_UDFDATE04, PAR_UDFDATE05, PAR_UDFNOTE01, PAR_UDFNOTE02, PAR_UDFNUM01, PAR_UDFNUM02, PAR_UDFNUM03, PAR_UDFNUM04, PAR_UDFNUM05, PAR_UOM, PAR_UPDATECOUNT, PAR_UPDATED, PAR_UPDATEDBY, PAR_WARDAYS, _DELETED, 
                    ETL_LASTSAVED,                       
                    etl_load_datetime,
                    etl_load_metadatafilename,
                    etl_is_deleted,
                    ETL_DELETED) 
            values (
                    src.PAR_ASMLEVEL, 
                    src.PAR_AVGPRICE, 
                    src.PAR_BASEPRICE, 
                    src.PAR_BUYER, 
                    src.PAR_BYASSET, 
                    src.PAR_BYLOT, 
                    src.PAR_CALSTANDARD, 
                    src.PAR_CATEGORY, 
                    src.PAR_CLASS, 
                    src.PAR_CLASS_ORG, 
                    src.PAR_CODE, 
                    src.PAR_CODESTRUCTURE, 
                    src.PAR_COMMODITY, 
                    src.PAR_COMPLEVEL, 
                    src.PAR_CONDITION, 
                    src.PAR_CONDITIONTPL, 
                    src.PAR_CONDITIONTPL_ORG, 
                    src.PAR_COREVALUE, 
                    src.PAR_CREATED, 
                    src.PAR_CREATEDBY, 
                    src.PAR_DESC, 
                    src.PAR_DOCUMOTO_BOOKID, 
                    src.PAR_DOCUMOTO_PART, 
                    src.PAR_FUGITIVEEMISSIONGAS, 
                    src.PAR_IMPORTANCE, 
                    src.PAR_INSMETHOD, 
                    src.PAR_INSPECT, 
                    src.PAR_INTERFACE, 
                    src.PAR_KIT, 
                    src.PAR_LASTPRICE, 
                    src.PAR_LASTSAVED, 
                    src.PAR_LASTSTATUSUPDATE, 
                    src.PAR_LONGDESCRIPTION, 
                    src.PAR_MATERIALTYPE, 
                    src.PAR_NOTUSED, 
                    src.PAR_ORG, 
                    src.PAR_PARENTPART, 
                    src.PAR_PREFSUP, 
                    src.PAR_PREFSUPPRICE, 
                    src.PAR_PREFSUP_ORG, 
                    src.PAR_PREFUOM, 
                    src.PAR_PREVENTREORDERS, 
                    src.PAR_PROFILEPICTURE, 
                    src.PAR_REPAIRABLE, 
                    src.PAR_SAFETYREVIEWED, 
                    src.PAR_SAFETYREVIEWEDBY, 
                    src.PAR_SAFETYREVIEWEDNAME, 
                    src.PAR_SAFETYREVIEWEDTYPE, 
                    src.PAR_SAFETYREVIEWREQUIRED, 
                    src.PAR_SAVEHISTORY, 
                    src.PAR_SOURCECODE, 
                    src.PAR_SOURCESYSTEM, 
                    src.PAR_STDPRICE, 
                    src.PAR_SUBCOMMODITY, 
                    src.PAR_SYSLEVEL, 
                    src.PAR_TAX, 
                    src.PAR_TOOL, 
                    src.PAR_TRACKBYCONDITION, 
                    src.PAR_TRACKRTYPE, 
                    src.PAR_TRACKTYPE, 
                    src.PAR_UDFCHAR01, 
                    src.PAR_UDFCHAR02, 
                    src.PAR_UDFCHAR03, 
                    src.PAR_UDFCHAR04, 
                    src.PAR_UDFCHAR05, 
                    src.PAR_UDFCHAR06, 
                    src.PAR_UDFCHAR07, 
                    src.PAR_UDFCHAR08, 
                    src.PAR_UDFCHAR09, 
                    src.PAR_UDFCHAR10, 
                    src.PAR_UDFCHAR11, 
                    src.PAR_UDFCHAR12, 
                    src.PAR_UDFCHAR13, 
                    src.PAR_UDFCHAR14, 
                    src.PAR_UDFCHAR15, 
                    src.PAR_UDFCHAR16, 
                    src.PAR_UDFCHAR17, 
                    src.PAR_UDFCHAR18, 
                    src.PAR_UDFCHAR19, 
                    src.PAR_UDFCHAR20, 
                    src.PAR_UDFCHAR21, 
                    src.PAR_UDFCHAR22, 
                    src.PAR_UDFCHAR23, 
                    src.PAR_UDFCHAR24, 
                    src.PAR_UDFCHAR25, 
                    src.PAR_UDFCHAR26, 
                    src.PAR_UDFCHAR27, 
                    src.PAR_UDFCHAR28, 
                    src.PAR_UDFCHAR29, 
                    src.PAR_UDFCHAR30, 
                    src.PAR_UDFCHKBOX01, 
                    src.PAR_UDFCHKBOX02, 
                    src.PAR_UDFCHKBOX03, 
                    src.PAR_UDFCHKBOX04, 
                    src.PAR_UDFCHKBOX05, 
                    src.PAR_UDFDATE01, 
                    src.PAR_UDFDATE02, 
                    src.PAR_UDFDATE03, 
                    src.PAR_UDFDATE04, 
                    src.PAR_UDFDATE05, 
                    src.PAR_UDFNOTE01, 
                    src.PAR_UDFNOTE02, 
                    src.PAR_UDFNUM01, 
                    src.PAR_UDFNUM02, 
                    src.PAR_UDFNUM03, 
                    src.PAR_UDFNUM04, 
                    src.PAR_UDFNUM05, 
                    src.PAR_UOM, 
                    src.PAR_UPDATECOUNT, 
                    src.PAR_UPDATED, 
                    src.PAR_UPDATEDBY, 
                    src.PAR_WARDAYS, 
                    src._DELETED,     
                    src.ETL_LASTSAVED,
                    CURRENT_TIMESTAMP,
                    src.etl_load_metadatafilename,
                    case when ETL_DELETED=TRUE then TRUE else FALSE end,
                    ETL_DELETED);
    `
} );

                    
//  Get number of rows inserted
        
        var sqlStmt = snowflake.createStatement( {sqlText:  sql_command} );
        var rs = sqlStmt.execute();
        var number_of_rows_inserted = sqlStmt.getNumRowsInserted();
        var number_of_rows_updated =  sqlStmt.getNumRowsUpdated();
                    

        
    snowflake.execute ({sqlText: "commit"});

    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Success','Completed process execution.', 0 ," + number_of_rows_inserted.toString()+ "," +  number_of_rows_updated.toString() + ");";
    snowflake.execute({sqlText: log_sql_command});

    result = "Success"; 

    }       

    catch (err)  {
        snowflake.execute( {sqlText: "rollback;"} )
        var clean_error_msg = err.message.replace(/[^\w\s]/gi, '');
    //  Create a log entry to say INSERT STATEMENT failed
    
    log_sql_command = "call datahub_logging.sp_etl_log_ingestion_process('UpdateEnd','" + process_name + "','Failed','MERGE Failed. Error:" + err.code.toString()+" : "+ clean_error_msg  + "', 0 ,0,0);";
    snowflake.execute({sqlText: log_sql_command});
        ;
        throw "Failed: " + err.message;   // Return a success/error indicator.
        }
    return result;
    $$;