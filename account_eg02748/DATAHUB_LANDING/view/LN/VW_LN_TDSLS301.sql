CREATE OR REPLACE VIEW DATAHUB_LANDING.VW_LN_TDSLS301 AS SELECT
                        src:adco::integer AS adco, 
                        src:adco_kw::varchar AS adco_kw, 
                        src:adcs::varchar AS adcs, 
                        src:adcs_ref_compnr::integer AS adcs_ref_compnr, 
                        src:aeco::integer AS aeco, 
                        src:aeco_kw::varchar AS aeco_kw, 
                        src:aeed::integer AS aeed, 
                        src:aeed_kw::varchar AS aeed_kw, 
                        src:aemq::integer AS aemq, 
                        src:aemq_kw::varchar AS aemq_kw, 
                        src:afrb::integer AS afrb, 
                        src:afrb_kw::varchar AS afrb_kw, 
                        src:bamt::numeric(38, 17) AS bamt, 
                        src:bamt_dtwc::numeric(38, 17) AS bamt_dtwc, 
                        src:bamt_lclc::numeric(38, 17) AS bamt_lclc, 
                        src:bamt_rfrc::numeric(38, 17) AS bamt_rfrc, 
                        src:bamt_rpc1::numeric(38, 17) AS bamt_rpc1, 
                        src:bamt_rpc2::numeric(38, 17) AS bamt_rpc2, 
                        src:bfbp::varchar AS bfbp, 
                        src:bfbp_ref_compnr::integer AS bfbp_ref_compnr, 
                        src:bpcl::varchar AS bpcl, 
                        src:bpcl_ref_compnr::integer AS bpcl_ref_compnr, 
                        src:bptc::varchar AS bptc, 
                        src:bptc_ref_compnr::integer AS bptc_ref_compnr, 
                        src:camt::numeric(38, 17) AS camt, 
                        src:camt_dtwc::numeric(38, 17) AS camt_dtwc, 
                        src:camt_lclc::numeric(38, 17) AS camt_lclc, 
                        src:camt_rfrc::numeric(38, 17) AS camt_rfrc, 
                        src:camt_rpc1::numeric(38, 17) AS camt_rpc1, 
                        src:camt_rpc2::numeric(38, 17) AS camt_rpc2, 
                        src:ccrf::object AS ccrf, 
                        src:ccty::varchar AS ccty, 
                        src:ccty_cvat_ref_compnr::integer AS ccty_cvat_ref_compnr, 
                        src:ccty_ref_compnr::integer AS ccty_ref_compnr, 
                        src:cdat::datetime AS cdat, 
                        src:cdec::varchar AS cdec, 
                        src:cdec_ref_compnr::integer AS cdec_ref_compnr, 
                        src:cdis_1::varchar AS cdis_1, 
                        src:cdis_10::varchar AS cdis_10, 
                        src:cdis_11::varchar AS cdis_11, 
                        src:cdis_2::varchar AS cdis_2, 
                        src:cdis_3::varchar AS cdis_3, 
                        src:cdis_4::varchar AS cdis_4, 
                        src:cdis_5::varchar AS cdis_5, 
                        src:cdis_6::varchar AS cdis_6, 
                        src:cdis_7::varchar AS cdis_7, 
                        src:cdis_8::varchar AS cdis_8, 
                        src:cdis_9::varchar AS cdis_9, 
                        src:ceno::varchar AS ceno, 
                        src:citm::object AS citm, 
                        src:citt::varchar AS citt, 
                        src:cncd::varchar AS cncd, 
                        src:cofc::varchar AS cofc, 
                        src:cofc_ref_compnr::integer AS cofc_ref_compnr, 
                        src:compnr::integer AS compnr, 
                        src:cono::varchar AS cono, 
                        src:cono_ref_compnr::integer AS cono_ref_compnr, 
                        src:corn::object AS corn, 
                        src:cpgs::varchar AS cpgs, 
                        src:cpgs_ref_compnr::integer AS cpgs_ref_compnr, 
                        src:cpwc::integer AS cpwc, 
                        src:cpwc_kw::varchar AS cpwc_kw, 
                        src:crep::varchar AS crep, 
                        src:crep_ref_compnr::integer AS crep_ref_compnr, 
                        src:cups::varchar AS cups, 
                        src:cups_ref_compnr::integer AS cups_ref_compnr, 
                        src:cuqs::varchar AS cuqs, 
                        src:cuqs_ref_compnr::integer AS cuqs_ref_compnr, 
                        src:cvat::varchar AS cvat, 
                        src:cvps::numeric(38, 17) AS cvps, 
                        src:cvqs::numeric(38, 17) AS cvqs, 
                        src:cwar::varchar AS cwar, 
                        src:cwar_ref_compnr::integer AS cwar_ref_compnr, 
                        src:deleted::boolean AS deleted, 
                        src:dest::integer AS dest, 
                        src:dest_kw::varchar AS dest_kw, 
                        src:disc_1::numeric(38, 17) AS disc_1, 
                        src:disc_10::numeric(38, 17) AS disc_10, 
                        src:disc_11::numeric(38, 17) AS disc_11, 
                        src:disc_2::numeric(38, 17) AS disc_2, 
                        src:disc_3::numeric(38, 17) AS disc_3, 
                        src:disc_4::numeric(38, 17) AS disc_4, 
                        src:disc_5::numeric(38, 17) AS disc_5, 
                        src:disc_6::numeric(38, 17) AS disc_6, 
                        src:disc_7::numeric(38, 17) AS disc_7, 
                        src:disc_8::numeric(38, 17) AS disc_8, 
                        src:disc_9::numeric(38, 17) AS disc_9, 
                        src:dlpt::varchar AS dlpt, 
                        src:dmth_1::integer AS dmth_1, 
                        src:dmth_10::integer AS dmth_10, 
                        src:dmth_11::integer AS dmth_11, 
                        src:dmth_2::integer AS dmth_2, 
                        src:dmth_3::integer AS dmth_3, 
                        src:dmth_4::integer AS dmth_4, 
                        src:dmth_5::integer AS dmth_5, 
                        src:dmth_6::integer AS dmth_6, 
                        src:dmth_7::integer AS dmth_7, 
                        src:dmth_8::integer AS dmth_8, 
                        src:dmth_9::integer AS dmth_9, 
                        src:dmth_kw_1::varchar AS dmth_kw_1, 
                        src:dmth_kw_10::varchar AS dmth_kw_10, 
                        src:dmth_kw_11::varchar AS dmth_kw_11, 
                        src:dmth_kw_2::varchar AS dmth_kw_2, 
                        src:dmth_kw_3::varchar AS dmth_kw_3, 
                        src:dmth_kw_4::varchar AS dmth_kw_4, 
                        src:dmth_kw_5::varchar AS dmth_kw_5, 
                        src:dmth_kw_6::varchar AS dmth_kw_6, 
                        src:dmth_kw_7::varchar AS dmth_kw_7, 
                        src:dmth_kw_8::varchar AS dmth_kw_8, 
                        src:dmth_kw_9::varchar AS dmth_kw_9, 
                        src:dsor::integer AS dsor, 
                        src:dsor_kw::varchar AS dsor_kw, 
                        src:dssc_1::varchar AS dssc_1, 
                        src:dssc_10::varchar AS dssc_10, 
                        src:dssc_11::varchar AS dssc_11, 
                        src:dssc_2::varchar AS dssc_2, 
                        src:dssc_3::varchar AS dssc_3, 
                        src:dssc_4::varchar AS dssc_4, 
                        src:dssc_5::varchar AS dssc_5, 
                        src:dssc_6::varchar AS dssc_6, 
                        src:dssc_7::varchar AS dssc_7, 
                        src:dssc_8::varchar AS dssc_8, 
                        src:dssc_9::varchar AS dssc_9, 
                        src:dtrm::integer AS dtrm, 
                        src:dtrm_kw::varchar AS dtrm_kw, 
                        src:dttl::integer AS dttl, 
                        src:edat::datetime AS edat, 
                        src:effn::integer AS effn, 
                        src:effn_ref_compnr::integer AS effn_ref_compnr, 
                        src:elgb::integer AS elgb, 
                        src:elgb_kw::varchar AS elgb_kw, 
                        src:exmt::integer AS exmt, 
                        src:exmt_kw::varchar AS exmt_kw, 
                        src:gamt_dtwc::numeric(38, 17) AS gamt_dtwc, 
                        src:gamt_lclc::numeric(38, 17) AS gamt_lclc, 
                        src:gamt_rfrc::numeric(38, 17) AS gamt_rfrc, 
                        src:gamt_rpc1::numeric(38, 17) AS gamt_rpc1, 
                        src:gamt_rpc2::numeric(38, 17) AS gamt_rpc2, 
                        src:gamt_trnc::numeric(38, 17) AS gamt_trnc, 
                        src:hqan::integer AS hqan, 
                        src:hqan_kw::varchar AS hqan_kw, 
                        src:hval::integer AS hval, 
                        src:hval_kw::varchar AS hval_kw, 
                        src:icap::integer AS icap, 
                        src:icap_kw::varchar AS icap_kw, 
                        src:icyp::integer AS icyp, 
                        src:icyp_kw::varchar AS icyp_kw, 
                        src:ieva::integer AS ieva, 
                        src:ieva_kw::varchar AS ieva_kw, 
                        src:imcs::varchar AS imcs, 
                        src:iqab::integer AS iqab, 
                        src:iqab_kw::varchar AS iqab_kw, 
                        src:item::varchar AS item, 
                        src:item_ref_compnr::integer AS item_ref_compnr, 
                        src:item_site_ref_compnr::integer AS item_site_ref_compnr, 
                        src:item_stsi_ref_compnr::integer AS item_stsi_ref_compnr, 
                        src:ldam_1::numeric(38, 17) AS ldam_1, 
                        src:ldam_10::numeric(38, 17) AS ldam_10, 
                        src:ldam_11::numeric(38, 17) AS ldam_11, 
                        src:ldam_2::numeric(38, 17) AS ldam_2, 
                        src:ldam_3::numeric(38, 17) AS ldam_3, 
                        src:ldam_4::numeric(38, 17) AS ldam_4, 
                        src:ldam_5::numeric(38, 17) AS ldam_5, 
                        src:ldam_6::numeric(38, 17) AS ldam_6, 
                        src:ldam_7::numeric(38, 17) AS ldam_7, 
                        src:ldam_8::numeric(38, 17) AS ldam_8, 
                        src:ldam_9::numeric(38, 17) AS ldam_9, 
                        src:leng::numeric(38, 17) AS leng, 
                        src:maxv::numeric(38, 17) AS maxv, 
                        src:minv::numeric(38, 17) AS minv, 
                        src:mqtl::numeric(38, 17) AS mqtl, 
                        src:namt_dtwc::numeric(38, 17) AS namt_dtwc, 
                        src:namt_lclc::numeric(38, 17) AS namt_lclc, 
                        src:namt_rfrc::numeric(38, 17) AS namt_rfrc, 
                        src:namt_rpc1::numeric(38, 17) AS namt_rpc1, 
                        src:namt_rpc2::numeric(38, 17) AS namt_rpc2, 
                        src:namt_trnc::numeric(38, 17) AS namt_trnc, 
                        src:ofbp::varchar AS ofbp, 
                        src:ofbp_ref_compnr::integer AS ofbp_ref_compnr, 
                        src:osrp::varchar AS osrp, 
                        src:osrp_ref_compnr::integer AS osrp_ref_compnr, 
                        src:owno::object AS owno, 
                        src:pbor::integer AS pbor, 
                        src:pbor_kw::varchar AS pbor_kw, 
                        src:pcpr::integer AS pcpr, 
                        src:pcpr_kw::varchar AS pcpr_kw, 
                        src:pono::integer AS pono, 
                        src:prbo::varchar AS prbo, 
                        src:prbo_ref_compnr::integer AS prbo_ref_compnr, 
                        src:pric::numeric(38, 17) AS pric, 
                        src:priu::integer AS priu, 
                        src:priu_kw::varchar AS priu_kw, 
                        src:ptpa::varchar AS ptpa, 
                        src:ptpa_ref_compnr::integer AS ptpa_ref_compnr, 
                        src:qicl::numeric(38, 17) AS qicl, 
                        src:qicl_buar::numeric(38, 17) AS qicl_buar, 
                        src:qicl_buln::numeric(38, 17) AS qicl_buln, 
                        src:qicl_bupc::numeric(38, 17) AS qicl_bupc, 
                        src:qicl_butm::numeric(38, 17) AS qicl_butm, 
                        src:qicl_buvl::numeric(38, 17) AS qicl_buvl, 
                        src:qicl_buwg::numeric(38, 17) AS qicl_buwg, 
                        src:qicl_trnu::numeric(38, 17) AS qicl_trnu, 
                        src:qiiv::numeric(38, 17) AS qiiv, 
                        src:qiiv_buar::numeric(38, 17) AS qiiv_buar, 
                        src:qiiv_buln::numeric(38, 17) AS qiiv_buln, 
                        src:qiiv_bupc::numeric(38, 17) AS qiiv_bupc, 
                        src:qiiv_butm::numeric(38, 17) AS qiiv_butm, 
                        src:qiiv_buvl::numeric(38, 17) AS qiiv_buvl, 
                        src:qiiv_buwg::numeric(38, 17) AS qiiv_buwg, 
                        src:qiiv_trnu::numeric(38, 17) AS qiiv_trnu, 
                        src:qimo::numeric(38, 17) AS qimo, 
                        src:qomn::numeric(38, 17) AS qomn, 
                        src:qomx::numeric(38, 17) AS qomx, 
                        src:qoor::numeric(38, 17) AS qoor, 
                        src:qoor_buar::numeric(38, 17) AS qoor_buar, 
                        src:qoor_buln::numeric(38, 17) AS qoor_buln, 
                        src:qoor_bupc::numeric(38, 17) AS qoor_bupc, 
                        src:qoor_butm::numeric(38, 17) AS qoor_butm, 
                        src:qoor_buvl::numeric(38, 17) AS qoor_buvl, 
                        src:qoor_buwg::numeric(38, 17) AS qoor_buwg, 
                        src:qoor_invu::numeric(38, 17) AS qoor_invu, 
                        src:rcod::varchar AS rcod, 
                        src:rcod_ref_compnr::integer AS rcod_ref_compnr, 
                        src:revi::varchar AS revi, 
                        src:rpds::integer AS rpds, 
                        src:rpds_kw::varchar AS rpds_kw, 
                        src:sdat::datetime AS sdat, 
                        src:sdsc::integer AS sdsc, 
                        src:sdsc_kw::varchar AS sdsc_kw, 
                        src:sequencenumber::integer AS sequencenumber, 
                        src:sfbp::varchar AS sfbp, 
                        src:sfbp_ref_compnr::integer AS sfbp_ref_compnr, 
                        src:site::varchar AS site, 
                        src:site_ref_compnr::integer AS site_ref_compnr, 
                        src:stad::varchar AS stad, 
                        src:stad_dlpt_ref_compnr::integer AS stad_dlpt_ref_compnr, 
                        src:stad_ref_compnr::integer AS stad_ref_compnr, 
                        src:stbp::varchar AS stbp, 
                        src:stbp_ref_compnr::integer AS stbp_ref_compnr, 
                        src:stcn::varchar AS stcn, 
                        src:stcn_ref_compnr::integer AS stcn_ref_compnr, 
                        src:stsi::varchar AS stsi, 
                        src:stsi_ref_compnr::integer AS stsi_ref_compnr, 
                        src:stwh::varchar AS stwh, 
                        src:stwh_ref_compnr::integer AS stwh_ref_compnr, 
                        src:thic::numeric(38, 17) AS thic, 
                        src:timestamp::datetime AS timestamp, 
                        src:txta::integer AS txta, 
                        src:txta_ref_compnr::integer AS txta_ref_compnr, 
                        src:ucms::integer AS ucms, 
                        src:ucms_kw::varchar AS ucms_kw, 
                        src:username::varchar AS username, 
                        src:widt::numeric(38, 17) AS widt, 
            CASE
                WHEN 'LN' = 'LN'
                THEN src:"deleted"::BOOLEAN
                WHEN 'LN' = 'IPS'
                THEN src:"DATALAKE_DELETED"::BOOLEAN
                ELSE src:"_DELETED"::BOOLEAN
            END as ETL_DELETED,
            etl_load_datetime,
            etl_load_metadatafilename,
            ETL_RANK,
            IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) as ETL_RANK_TIMESTAMP
            FROM 
            (
            select 
                src,
                etl_load_datetime,
                etl_load_metadatafilename,
                ROWNUMBER as ETL_RANK
                from
                (
                    SELECT
    
                        
                src:compnr,
                src:cono,
                src:pono,
                src:cofc,
            src:sequencenumber
                ,src,
                etl_load_datetime,
                etl_load_metadatafilename,
                ROW_NUMBER() OVER (PARTITION BY 
                                        
                src:compnr,
                src:cono,
                src:pono,
                src:cofc  ORDER BY 
            src:sequencenumber desc,IFNULL(TRY_TO_TIMESTAMP(replace(right(replace(lower(etl_load_metadatafilename),'.json'),23),'_','-'), 'yyyy-mm-dd-HH-MI-SS-FF') ,etl_load_datetime) desc) as ROWNUMBER
                FROM DATAHUB_LANDING.LN_TDSLS301 as strm))