CREATE OR REPLACE VIEW ${buildvar.env}_WBP_SHARE.DATAHUB_SHARED_WBP.VW_STORM_MISC
AS
SELECT 
  A1."ACQTYPE" AS "Acquistion Type"
, A2."ADDRKEY" AS "Address"
, A2."UNITID" AS "Asset ID"
, A2."COMPKEY" AS "CompKey"
, A1."COSTCENTRE" AS "Cost Centre Code"
, 'TBD' AS "Cost Centre Description"
, A1."CRITICALITY" AS "Criticality Code"
, 'TBD' AS "Criticality Description"
, A2."DPTH" AS "Depth"
, A2."UNITDESC" AS "Description"
, A2."DIAM" AS "Diameter"
, A1."FORDISPOSAL" AS "Disposal Reason"
, A1."DRAWINGNO" AS "Drawing No"
, A1."DRAWINGNOREF" AS "Drawing No Ref"
, A2."BGTNO" AS "Equipment No"
, A2."EXPDATE" AS "Expire Date"
, A2."AREA" AS "Facility Code"
, 'TBD' AS "Facility Description"
, A2."HT" AS "Height"
, A2."INSTDATE" AS "Installed"
, A2."ASBLT" AS "Legacy Key"
, A2."LEN" AS "Length"
, A2."MATL" AS "Material Code"
, 'TBD' AS "Material Description"
, A1."MODELNO" AS "Model #"
, A2."OWN" AS "Ownership Code"
, 'TBD' AS "Ownership Description"
, A2."MAPNO" AS "Position"
, A2."SUBAREA" AS "Process Code"
, 'TBD' AS "Process Description"
, A1."SAFETYCRITICAL" AS "Safety Critical Element"
, A2."SERVSTAT" AS "Service Status"
, A2."LOC" AS "Set Code"
, 'TBD' AS "Set Description"
, A2."SURF" AS "Surface Cover Code"
, 'TBD' AS "Surface Cover Description"
, A2."DISTRICT" AS "System Code"
, 'TBD' AS "System Description"
, A2."UNITTYPE" AS "Unit Type Code"
, 'TBD' AS "Unit Type Description"
, A2."WT" AS "Weight"
, A2."WID" AS "Width"
, 'TBD' AS "Pipe Class"


, ad."NZHOUSENO" AS "Street Number"
, CONCAT(ad."NZSTNAME",' ',ad."NZSTTYPE") AS "Street Name"
, ad."NZSUBURB" AS "City"
, ad."NZPOSTCODE" AS "Postal Code"

, A1.MAKE                           					  AS "Make"
, A2.SERNO                                                AS "Serial Number"
, A1.ZONECATCHMENT                  					  AS "Water Zone/Sewer Catchment"
, XSTORMMISCELLANEOUS.BEARINGTYPE                         AS "Bearing Type"
, XSTORMMISCELLANEOUS.BOLTDOWN                            AS "Boltdown"
, XSTORMMISCELLANEOUS.CAPACITY                            AS "Capacity (m3)"
, XSTORMMISCELLANEOUS.COVERTYPE                           AS "Cover Type"
, XSTORMMISCELLANEOUS.DESIGNSPEED                         AS "Design Speed (RPM)"
, XSTORMMISCELLANEOUS.DIAMEXT                    		  AS "Diameter External (mm)"
, XSTORMMISCELLANEOUS.DIAMINT                    		  AS "Diameter Internal (mm)"
, XSTORMMISCELLANEOUS.ENERGYRATING                        AS "Energy Rating (Kw)"
, XSTORMMISCELLANEOUS.FRAMESIZE                           AS "Frame Size"
, XSTORMMISCELLANEOUS.FUNCOUPUT                    		  AS "Functional Output Mechanical Rotating"
, XSTORMMISCELLANEOUS.HINGED                              AS "Hinged"
, XSTORMMISCELLANEOUS.IMPELLORDIA                         AS "Impeller Diameter (mm)"
, XSTORMMISCELLANEOUS.IMPELLORTYPE                        AS "Impeller Type"
, XSTORMMISCELLANEOUS.INHIBITLEVEL                        AS "Inhibit Level (M)"
, XSTORMMISCELLANEOUS.CURRENTIN                           AS "Input Current (Amps)"
, XSTORMMISCELLANEOUS.VOLTAGEIN                           AS "Input Voltage (Volt)"
, XSTORMMISCELLANEOUS.VOLTAGEINTYPE                       AS "Input Voltage Type"
, XSTORMMISCELLANEOUS.INVLEVEL                         	  AS "Invert Level (M)"
, XSTORMMISCELLANEOUS.DROPMH                       	      AS "Is Drop Manhole"
, XSTORMMISCELLANEOUS.LIDLEVEL                            AS "Lid Level (M)"
, XSTORMMISCELLANEOUS.LOCKABLE                            AS "Lockable"
, XSTORMMISCELLANEOUS.CURRENTOUT                          AS "Output Current (Amps)"
, XSTORMMISCELLANEOUS.VOLTAGEOUT                          AS "Output Voltage (Volt)"
, XSTORMMISCELLANEOUS.VOLTAGEOUTTYPE                      AS "Output Voltage Type"
, XSTORMMISCELLANEOUS.OVERFLOWLEVEL                       AS "Overflow Level (M)"
, XSTORMMISCELLANEOUS.OVERFLOWTYPE                        AS "Overflow Type"
, XSTORMMISCELLANEOUS.PHASES                              AS "Phases"
, XSTORMMISCELLANEOUS.PRESSURERATING                      AS "Pressure Rating (kPa)"
, XSTORMMISCELLANEOUS.REMOVABLE                           AS "Removable"
, XSTORMMISCELLANEOUS.STAGES                              AS "Stages"
, XSTORMMISCELLANEOUS.STFCABINET                          AS "STF Cabinet"
, XSTORMMISCELLANEOUS.STFFAN                              AS "STF Fan"
, XSTORMMISCELLANEOUS.STFFILTER                           AS "STF Filter"
, XSTORMMISCELLANEOUS.STFHEATER                           AS "STF Heater"
, XSTORMMISCELLANEOUS.STFLIGHTARRESTOR                    AS "STF Lightening Arrestor"
, XSTORMMISCELLANEOUS.STFREDUNDANCY                       AS "STF Redundancy Module"
, XSTORMMISCELLANEOUS.STFSTANDBYUNIT                      AS "STF Standby Unit"
, XSTORMMISCELLANEOUS.STFTEMP                             AS "STF Temperature Monitor"
, XSTORMMISCELLANEOUS.STFTRANSCEIVER                      AS "STF Transceiver"
, XSTORMMISCELLANEOUS.STFVENT                             AS "STF Vent"
, XSTORMMISCELLANEOUS.STIFFRATING                         AS "Stiffness Rating (SN)"
, XSTORMMISCELLANEOUS.SUBTYPEFEATURES                     AS "SubType Features"
, A1.WARRANTYEND                    					  AS "Warranty End Date"
, A1.WARRANTYSTART                  					  AS "Warranty Start Date"
, XSTORMMISCELLANEOUS.BODYTYPE                            AS "Body Type"
, XSTORMMISCELLANEOUS.COMMSPROTOCOL                       AS "Communications Protocol"
, XSTORMMISCELLANEOUS.CONSTMETHOD                         AS "Construction Method"
, XSTORMMISCELLANEOUS.COOLING                             AS "Cooling"
, XSTORMMISCELLANEOUS.DESIGNRESILIENCE                    AS "Design Resilience"
, XSTORMMISCELLANEOUS.DISCHARGECAP                   	  AS "Discharge Capacity (m3 per sec)"
, XSTORMMISCELLANEOUS.QUAKEDESIGN                         AS "Earthquake Design Level"
, XSTORMMISCELLANEOUS.EXTCOAT                     	      AS "External Coating"
, XSTORMMISCELLANEOUS.FALLPROTECT                         AS "Fall Protection"
, XSTORMMISCELLANEOUS.FUELTYPE                            AS "Fuel Type"
, XSTORMMISCELLANEOUS.FUNCAREA                      	  AS "Functional Area"
, XSTORMMISCELLANEOUS.GRDLEVEL                        	  AS "Ground Level"
, XSTORMMISCELLANEOUS.HAZARDRATING                        AS "Hazardous Rating"
, XSTORMMISCELLANEOUS.IPRATING                            AS "Ingress Protection Rating"
, XSTORMMISCELLANEOUS.DIAMINLET                       	  AS "Inlet Diameter"
, XSTORMMISCELLANEOUS.INSTALLMOUNT                   	  AS "Installation Mounting"
, XSTORMMISCELLANEOUS.INSTALLORIENT             	      AS "Installation Orientation"
, XSTORMMISCELLANEOUS.INSTRUMENTRANGE                     AS "Instrument Range"
, XSTORMMISCELLANEOUS.INSULATIONCLASS                     AS "Insulation Class"
, XSTORMMISCELLANEOUS.INTLINING                      	  AS "Internal Lining"
, XSTORMMISCELLANEOUS.JTTYPE                           	  AS "Joint Method"
, XSTORMMISCELLANEOUS.LOADRATING                          AS "Load Rating (kN)"
, XSTORMMISCELLANEOUS.LOCALITY                            AS "Locality"
, XSTORMMISCELLANEOUS.MAXFLOW                             AS "Maximum Flow"
, XSTORMMISCELLANEOUS.MINFLOW                             AS "Minimum Flow"
, XSTORMMISCELLANEOUS.MEDIATYPE                           AS "Media Type"
, XSTORMMISCELLANEOUS.DIAMOUTLET                      	  AS "Outlet Diameter"
, XSTORMMISCELLANEOUS.PHOTO3D                             AS "Photo/3D Model"
, XSTORMMISCELLANEOUS.SPILLWAYTYPE                        AS "Spillway Type"
, XSTORMMISCELLANEOUS.AREA                                AS "Surface Area (m2)"
, XSTORMMISCELLANEOUS.TORQUE                              AS "Torque Input Rating"
, XSTORMMISCELLANEOUS.TORQUEOUT                           AS "Torque Output Rating"


FROM
  "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_STORM_COMPSTMS" as A2
  INNER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_WSLASSETS_XALLASSETSDP02" as A1 ON A2.COMPKEY = A1.COMPKEY AND A1.BUSINESSAREA IN ('WBC','WBE','WBW')
  LEFT OUTER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_PROPERTY_ADDRESS" as ad ON ad.ADDRKEY = a2.ADDRKEY AND ad.OPTA = 'WBP'
  LEFT OUTER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET".IPS_WSLASSETSSTORM_XSTORMMISCELLANEOUS  AS XSTORMMISCELLANEOUS ON A2.COMPKEY = XSTORMMISCELLANEOUS.COMPKEY 
  WHERE A2.BLDGFLOOR = 1003;