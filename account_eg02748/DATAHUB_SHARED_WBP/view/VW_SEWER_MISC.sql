CREATE OR REPLACE VIEW ${buildvar.env}_WBP_SHARE.DATAHUB_SHARED_WBP.VW_SEWER_MISC
AS
SELECT
  A2."ADDRKEY" AS "Address"
, A2."UNITID" AS "Asset ID"
, A2."COMPKEY" AS "CompKey"
, A2."BGTNO" AS "Equipment No"
, A2."UNITDESC" AS "Description"
, A1."DRAWINGNO" AS "Drawing No"
, A1."DRAWINGNOREF" AS "Drawing No Ref"
, A2."ASBLT" AS "Legacy Key"
, A2."AREA" AS "Facility Code"
, 'TBD' AS "Facility Description"
, A2."SUBAREA" AS "Process Code"
, 'TBD' AS "Process Description"
, A2."DISTRICT" AS "System Code"
, 'TBD' AS "System Description"
, A2."LOC" AS "Set Code"
, 'TBD' AS "Set Description"
, A2."MAPNO" AS "Position"
, A2."UNITTYPE" AS "Unit Type Code"
, 'TBD' AS "Unit Type Description"
, A1."MODELNO" AS "Model #"
, A2."SURF" AS "Surface Cover Code"
, 'TBD' AS "Surface Cover Description"
, A2."MATL" AS "Material Code"
, 'TBD' AS "Material Description"
, A2."LEN" AS "Length"
, A2."WID" AS "Width"
, A2."HT" AS "Height"
, A2."DIAM" AS "Diameter"
, A2."WT" AS "Weight"
, A2."DPTH" AS "Depth"
, A2."INSTDATE" AS "Installed"
, A1."ACQTYPE" AS "Acquistion Type"
, A1."CRITICALITY" AS "Criticality Code"
, 'TBD' AS "Criticality Description"
, A1."SAFETYCRITICAL" AS "Safety Critical Element"
, A2."SERVSTAT" AS "Service Status"
, A2."OWN" AS "Ownership Code"
, 'TBD' AS "Ownership Description"
, A1."COSTCENTRE" AS "Cost Centre Code"
, 'TBD' AS "Cost Centre Description"
, A2."EXPDATE" AS "Expire Date"
, A1."FORDISPOSAL" AS "Disposal Reason"
, ad."NZHOUSENO" AS "Street Number"
, CONCAT(ad."NZSTNAME",' ',ad."NZSTTYPE") AS "Street Name"
, ad."NZSUBURB" AS "City"
, ad."NZPOSTCODE" AS "Postal Code"

, A1.MAKE                              						 AS "Make"
, A2.SERNO                                                   AS "Serial Number"
, A1.ZONECATCHMENT                     						 AS "Water Zone/Sewer Catchment"
, XSEWERMISCELLANEOUS.BEARINGTYPE                            AS "Bearing Type"
, XSEWERMISCELLANEOUS.BOLTDOWN                               AS "Boltdown"
, XSEWERMISCELLANEOUS.CAPACITY                               AS "Capacity (m3)"
, XSEWERMISCELLANEOUS.COVERTYPE                              AS "Cover Type"
, XSEWERMISCELLANEOUS.DESIGNSPEED                            AS "Design Speed (RPM)"
, XSEWERMISCELLANEOUS.DIAMEXT            					 AS "Diameter External (mm)"
, XSEWERMISCELLANEOUS.DIAMINT            					 AS "Diameter Internal (mm)"
, XSEWERMISCELLANEOUS.ENERGYRATING                           AS "Energy Rating (Kw)"
, XSEWERMISCELLANEOUS.FRAMESIZE                              AS "Frame Size"
, XSEWERMISCELLANEOUS.FUNCOUPUT            					 AS "Functional Output Mechanical Rotating"
, XSEWERMISCELLANEOUS.HINGED                                 AS "Hinged"
, XSEWERMISCELLANEOUS.IMPELLORDIA                            AS "Impeller Diameter (mm)"
, XSEWERMISCELLANEOUS.IMPELLORTYPE                           AS "Impeller Type"
, XSEWERMISCELLANEOUS.INHIBITLEVEL                           AS "Inhibit Level (M)"
, XSEWERMISCELLANEOUS.CURRENTIN                              AS "Input Current (Amps)"
, XSEWERMISCELLANEOUS.VOLTAGEIN                              AS "Input Voltage (Volt)"
, XSEWERMISCELLANEOUS.VOLTAGEINTYPE                          AS "Input Voltage Type"
, XSEWERMISCELLANEOUS.INVLEVEL                 				 AS "Invert Level (M)"
, XSEWERMISCELLANEOUS.DROPMH               					 AS "Is Drop Manhole"
, XSEWERMISCELLANEOUS.LIDLEVEL                               AS "Lid Level (M)"
, XSEWERMISCELLANEOUS.LOCKABLE                               AS "Lockable"
, XSEWERMISCELLANEOUS.CURRENTOUT                             AS "Output Current (Amps)"
, XSEWERMISCELLANEOUS.VOLTAGEOUT                             AS "Output Voltage (Volt)"
, XSEWERMISCELLANEOUS.VOLTAGEOUTTYPE                         AS "Output Voltage Type"
, XSEWERMISCELLANEOUS.OVERFLOWLEVEL                          AS "Overflow Level (M)"
, XSEWERMISCELLANEOUS.OVERFLOWTYPE                           AS "Overflow Type"
, XSEWERMISCELLANEOUS.PHASES                                 AS "Phases"
, XSEWERMISCELLANEOUS.PRESSURERATING                         AS "Pressure Rating (kPa)"
, XSEWERMISCELLANEOUS.REMOVABLE                              AS "Removable"
, XSEWERMISCELLANEOUS.STAGES                                 AS "Stages"
, XSEWERMISCELLANEOUS.STFCABINET                             AS "STF Cabinet"
, XSEWERMISCELLANEOUS.STFFAN                                 AS "STF Fan"
, XSEWERMISCELLANEOUS.STFFILTER                              AS "STF Filter"
, XSEWERMISCELLANEOUS.STFHEATER                              AS "STF Heater"
, XSEWERMISCELLANEOUS.STFLIGHTARRESTOR                       AS "STF Lightening Arrestor"
, XSEWERMISCELLANEOUS.STFREDUNDANCY                          AS "STF Redundancy Module"
, XSEWERMISCELLANEOUS.STFSTANDBYUNIT                         AS "STF Standby Unit"
, XSEWERMISCELLANEOUS.STFTEMP                                AS "STF Temperature Monitor"
, XSEWERMISCELLANEOUS.STFTRANSCEIVER                         AS "STF Transceiver"
, XSEWERMISCELLANEOUS.STFVENT                                AS "STF Vent"
, XSEWERMISCELLANEOUS.STIFFRATING                            AS "Stiffness Rating (SN)"
, XSEWERMISCELLANEOUS.SUBTYPEFEATURES                        AS "SubType Features"
, A1.WARRANTYEND                       						 AS "Warranty End Date"
, A1.WARRANTYSTART                     						 AS "Warranty Start Date"
, XSEWERMISCELLANEOUS.BODYTYPE                               AS "Body Type"
, XSEWERMISCELLANEOUS.COMMSPROTOCOL                          AS "Communications Protocol"
, XSEWERMISCELLANEOUS.CONSTMETHOD                            AS "Construction Method"
, XSEWERMISCELLANEOUS.COOLING                                AS "Cooling"
, XSEWERMISCELLANEOUS.DESIGNRESILIENCE                       AS "Design Resilience"
, XSEWERMISCELLANEOUS.DISCHARGECAP           				 AS "Discharge Capacity (m3 per sec)"
, XSEWERMISCELLANEOUS.QUAKEDESIGN                            AS "Earthquake Design Level"
, XSEWERMISCELLANEOUS.EXTCOAT             					 AS "External Coating"
, XSEWERMISCELLANEOUS.FALLPROTECT                            AS "Fall Protection"
, XSEWERMISCELLANEOUS.FUELTYPE                               AS "Fuel Type"
, XSEWERMISCELLANEOUS.FUNCAREA              				 AS "Functional Area"
, XSEWERMISCELLANEOUS.GRDLEVEL                      		 AS "Ground Level"
, XSEWERMISCELLANEOUS.HAZARDRATING                           AS "Hazardous Rating"
, XSEWERMISCELLANEOUS.IPRATING                               AS "Ingress Protection Rating"
, XSEWERMISCELLANEOUS.DIAMINLET               				 AS "Inlet Diameter"
, XSEWERMISCELLANEOUS.INSTALLMOUNT           				 AS "Installation Mounting"
, XSEWERMISCELLANEOUS.INSTALLORIENT     					 AS "Installation Orientation"
, XSEWERMISCELLANEOUS.INSTRUMENTRANGE                        AS "Instrument Range"
, XSEWERMISCELLANEOUS.INSULATIONCLASS                        AS "Insulation Class"
, XSEWERMISCELLANEOUS.INTLINING              				 AS "Internal Lining"
, XSEWERMISCELLANEOUS.JTTYPE                  				 AS "Joint Method"
, XSEWERMISCELLANEOUS.LOADRATING                             AS "Load Rating (kN)"
, XSEWERMISCELLANEOUS.LOCALITY                               AS "Locality"
, XSEWERMISCELLANEOUS.MAXFLOW                                AS "Maximum Flow"
, XSEWERMISCELLANEOUS.MINFLOW                                AS "Minimum Flow"
, XSEWERMISCELLANEOUS.MEDIATYPE                              AS "Media Type"
, XSEWERMISCELLANEOUS.DIAMOUTLET              				 AS "Outlet Diameter"
, XSEWERMISCELLANEOUS.PHOTO3D                                AS "Photo/3D Model"
, XSEWERMISCELLANEOUS.SPILLWAYTYPE                           AS "Spillway Type"
, XSEWERMISCELLANEOUS.AREA                                   AS "Surface Area (m2)"
, XSEWERMISCELLANEOUS.TORQUE                                 AS "Torque Input Rating"
, XSEWERMISCELLANEOUS.TORQUEOUT                              AS "Torque Output Rating"

FROM
  "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_ASSETMANAGEMENT_SEWER_COMPSMS" as A2
  INNER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_WSLASSETS_XALLASSETSDP02" as A1 ON A2.COMPKEY = A1.COMPKEY AND A1.BUSINESSAREA IN ('WBC','WBE','WBW')
  LEFT OUTER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET"."IPS_PROPERTY_ADDRESS" as ad ON ad.ADDRKEY = a2.ADDRKEY AND ad.OPTA = 'WBP'
  LEFT OUTER JOIN "${buildvar.env}_WCC_DATAWAREHOUSE"."DATAHUB_TARGET".IPS_WSLASSETSSEWER_XSEWERMISCELLANEOUS  AS XSEWERMISCELLANEOUS ON A2.COMPKEY = XSEWERMISCELLANEOUS.COMPKEY 
  WHERE A2.BLDGFLOOR = 1003;