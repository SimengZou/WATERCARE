create or replace view VW_SM_APSY_SMINF_CUR_DAILY(
	AE_ETL_JOB_ID2,
	M_PLATFORM_NAME,
	AE_ETL_JOB_ID1,
	AE_CODE,
	AE_MANUFACTURER_NAME,
	M_CUSTOM_2,
	M_ETL_JOB_ID2,
	M_RESOURCE_TYPE,
	M_ETL_JOB_ID1,
	AE_DESCRIPTION,
	M_PLATFORM_ID,
	AE_PLATFORM_ID,
	M_BILLING,
	AE_PRODUCT_CLASS,
	AE_CUSTOM_2,
	M_UNIT,
	M_UNIT_ID,
	M_VALUE,
	AE_UNIT_ID,
	AE_VALUE,
	M_PLATFORM_TIME,
	AE_PLATFORM_TIME,
	AE_CUSTOM_1,
	AE_ID,
	AE_METER_TIME,
	M_PRODUCT_CLASS,
	M_METER_TIME,
	AE_PLATFORM_NAME,
	M_CUSTOM_1,
	M_MANUFACTURER_NAME,
	M_RESOURCE_DESCRIPTION,
	ETL_LOAD_DATETIME,
	ETL_LOAD_METADATAFILENAME
) as 
SELECT ae_etl_job_id2,
m_platform_name,
ae_etl_job_id1,
ae_code,
ae_manufacturer_name,
m_custom_2,
m_etl_job_id2,
m_resource_type,
m_etl_job_id1,
ae_description,
m_platform_id,
ae_platform_id,
m_billing,
ae_product_class,
ae_custom_2,
m_unit,
m_unit_id,
m_value,
ae_unit_id,
ae_value,
dateadd('ms',m_platform_time/1000,'1970-01-01') as m_platform_time,
dateadd('ms',ae_platform_time/1000,'1970-01-01') as ae_platform_time ,
ae_custom_1,
ae_id,
dateadd('ms',ae_meter_time/1000,'1970-01-01')as ae_meter_time,
m_product_class,
dateadd('ms',m_meter_time /1000,'1970-01-01')as  m_meter_time ,
ae_platform_name,
m_custom_1,
m_manufacturer_name,
m_resource_description,
etl_load_datetime,
etl_load_metadatafilename
FROM datahub_target.sm_apsy_sminf_cur
WHERE M_RESOURCE_TYPE ='Water_Flow_Readings_Total_Daily' and M_BILLING =TRUE
ORDER BY M_METER_TIME DESC;