CREATE OR REPLACE VIEW DATAHUB_TARGET_HISTORY.IPS_METERMANAGEMENT_WATER_WATERMETERANALYSIS AS 
    SELECT 
        ADDBY, 
        ADDDTTM, 
        ADDRESS, 
        ADDRESSKEY, 
        ADDRESSKEY1, 
        APPROVE, 
        AUDITFLAG, 
        BATCHKEY, 
        COLORASSIGNMENTNEEDED, 
        COMPAREBILLABLE, 
        COMPAREESTIMATEDFLAG, 
        COMPAREHIGHBILLABLE, 
        COMPAREHIGHREADING, 
        COMPAREHIGHUSAGE, 
        COMPAREOPTION, 
        COMPAREREADING, 
        COMPAREREADINGDATE, 
        COMPAREREADINGKEY, 
        COMPARETOTALBILLABLEUSAGE, 
        COMPARETOTALUSAGE, 
        COMPAREUSAGE, 
        COMPAREUSAGEREADINGKEYS, 
        CURRENTBILLABLE, 
        CURRENTCOMPKEY, 
        CURRENTESTIMATEDFLAG, 
        CURRENTFIELDNOTES, 
        CURRENTHIGHBILLABLE, 
        CURRENTHIGHREADING, 
        CURRENTHIGHUSAGE, 
        CURRENTMETERID, 
        CURRENTREADING, 
        CURRENTREADINGDATE, 
        CURRENTREADINGKEY, 
        CURRENTTOTALBILLABLEUSAGE, 
        CURRENTTOTALUSAGE, 
        CURRENTUNITTYPE, 
        CURRENTUSAGE, 
        CURRENTUSAGEREADINGKEYS, 
        DATALAKE_DELETED, 
        DEFAULTACTION, 
        EXCEPTION, 
        EXCEPTIONTYPE, 
        HIGHMULTIPLIER, 
        INDEXNO, 
        ISPBCODESRVREQRESOLVED, 
        ISPBCODEWORESOLVED, 
        ISPROBLEMCODEEXCEPTION, 
        ISRDCODESRVREQRESOLVED, 
        ISRDCODEWORESOLVED, 
        ISREADERCODEEXCEPTION, 
        ISREADINGAPPROVED, 
        ISREREADRESOLVED, 
        KEYCOLUMN, 
        LOWMULTIPLIER, 
        MANUALREVIEWFLAG, 
        MODBY, 
        MODDTTM, 
        NOREADFLAG, 
        OLDESTACCOUNTKEY, 
        OLDESTACCOUNTNO, 
        OTHERACTION, 
        PARENTKEY, 
        POSITION, 
        PROBLEMCODE, 
        PROBLEMCODEBACKCOLOR, 
        PROBLEMCODESERVICEREQUESTNO, 
        PROBLEMCODESERVICEREQUESTTYPE, 
        PROBLEMCODETEXTCOLOR, 
        PROBLEMCODEWORKORDERNO, 
        PROBLEMCODEWORKORDERTYPE, 
        READERCODE, 
        READERCODEBACKCOLOR, 
        READERCODESERVICEREQUESTNO, 
        READERCODESERVICEREQUESTTYPE, 
        READERCODETEXTCOLOR, 
        READERCODEWORKORDERNO, 
        READERCODEWORKORDERTYPE, 
        READINGCOMPKEY, 
        READINGCYCLE, 
        READINGMETERID, 
        READINGTYPE, 
        READINGUNITTYPE, 
        REREAD, 
        REREADSERVICEREQUESTNO, 
        ROUTEID, 
        ROUTEKEY, 
        SEQUENCENO, 
        SERREQ, 
        USAGEPERCENTAGE, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        WATERMETERANALYSISKEY, 
        WORKORDER, 
        ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET_HISTORY.IPS_DELETED_METERMANAGEMENT_WATER_WATERMETERANALYSIS
    UNION ALL 
    SELECT 
        ADDBY, 
        ADDDTTM, 
        ADDRESS, 
        ADDRESSKEY, 
        ADDRESSKEY1, 
        APPROVE, 
        AUDITFLAG, 
        BATCHKEY, 
        COLORASSIGNMENTNEEDED, 
        COMPAREBILLABLE, 
        COMPAREESTIMATEDFLAG, 
        COMPAREHIGHBILLABLE, 
        COMPAREHIGHREADING, 
        COMPAREHIGHUSAGE, 
        COMPAREOPTION, 
        COMPAREREADING, 
        COMPAREREADINGDATE, 
        COMPAREREADINGKEY, 
        COMPARETOTALBILLABLEUSAGE, 
        COMPARETOTALUSAGE, 
        COMPAREUSAGE, 
        COMPAREUSAGEREADINGKEYS, 
        CURRENTBILLABLE, 
        CURRENTCOMPKEY, 
        CURRENTESTIMATEDFLAG, 
        CURRENTFIELDNOTES, 
        CURRENTHIGHBILLABLE, 
        CURRENTHIGHREADING, 
        CURRENTHIGHUSAGE, 
        CURRENTMETERID, 
        CURRENTREADING, 
        CURRENTREADINGDATE, 
        CURRENTREADINGKEY, 
        CURRENTTOTALBILLABLEUSAGE, 
        CURRENTTOTALUSAGE, 
        CURRENTUNITTYPE, 
        CURRENTUSAGE, 
        CURRENTUSAGEREADINGKEYS, 
        DATALAKE_DELETED, 
        DEFAULTACTION, 
        EXCEPTION, 
        EXCEPTIONTYPE, 
        HIGHMULTIPLIER, 
        INDEXNO, 
        ISPBCODESRVREQRESOLVED, 
        ISPBCODEWORESOLVED, 
        ISPROBLEMCODEEXCEPTION, 
        ISRDCODESRVREQRESOLVED, 
        ISRDCODEWORESOLVED, 
        ISREADERCODEEXCEPTION, 
        ISREADINGAPPROVED, 
        ISREREADRESOLVED, 
        KEYCOLUMN, 
        LOWMULTIPLIER, 
        MANUALREVIEWFLAG, 
        MODBY, 
        MODDTTM, 
        NOREADFLAG, 
        OLDESTACCOUNTKEY, 
        OLDESTACCOUNTNO, 
        OTHERACTION, 
        PARENTKEY, 
        POSITION, 
        PROBLEMCODE, 
        PROBLEMCODEBACKCOLOR, 
        PROBLEMCODESERVICEREQUESTNO, 
        PROBLEMCODESERVICEREQUESTTYPE, 
        PROBLEMCODETEXTCOLOR, 
        PROBLEMCODEWORKORDERNO, 
        PROBLEMCODEWORKORDERTYPE, 
        READERCODE, 
        READERCODEBACKCOLOR, 
        READERCODESERVICEREQUESTNO, 
        READERCODESERVICEREQUESTTYPE, 
        READERCODETEXTCOLOR, 
        READERCODEWORKORDERNO, 
        READERCODEWORKORDERTYPE, 
        READINGCOMPKEY, 
        READINGCYCLE, 
        READINGMETERID, 
        READINGTYPE, 
        READINGUNITTYPE, 
        REREAD, 
        REREADSERVICEREQUESTNO, 
        ROUTEID, 
        ROUTEKEY, 
        SEQUENCENO, 
        SERREQ, 
        USAGEPERCENTAGE, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        WATERMETERANALYSISKEY, 
        WORKORDER, 
        FALSE AS ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET.IPS_METERMANAGEMENT_WATER_WATERMETERANALYSIS;