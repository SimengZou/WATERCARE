CREATE OR REPLACE VIEW DATAHUB_TARGET_HISTORY.IPS_WSLBILLING_MIGSERVICES AS 
    SELECT 
        ACCOUNTNUMBER, 
        ACCOUNTSERVICEKEY, 
        ADDBY, 
        ADDDTTM, 
        ADDRESSKEY1, 
        ADDRESSKEY2, 
        ADDRESSKEY3, 
        ADDRESSKEY4, 
        ADDRESSKEY5, 
        ADDRESSKEY6, 
        ADDRESSKEY7, 
        ANNUALFIX, 
        BILLABLEPERC, 
        BILLABLEPERC1, 
        BILLABLEPERC2, 
        BILLABLEPERC3, 
        BILLABLEPERC4, 
        BILLABLEPERC5, 
        BILLABLEPERC6, 
        BILLABLEPERC7, 
        DATALAKE_DELETED, 
        LASTBILLDATE, 
        MIGSERVICESKEY, 
        MODBY, 
        MODDTTM, 
        MULTI, 
        NUMMETERS, 
        POSITION1, 
        POSITION2, 
        POSITION3, 
        POSITION4, 
        POSITION5, 
        POSITION6, 
        POSITION7, 
        PRICINGPLAN, 
        READDATE1, 
        READDATE2, 
        READDATE3, 
        READDATE4, 
        READDATE5, 
        READDATE6, 
        READDATE7, 
        SRVTYPE, 
        STARTDATE, 
        STARTKEY1, 
        STARTKEY2, 
        STARTKEY3, 
        STARTKEY4, 
        STARTKEY5, 
        STARTKEY6, 
        STARTKEY7, 
        STATUSMESG, 
        SUBFLAG1, 
        SUBFLAG2, 
        SUBFLAG3, 
        SUBFLAG4, 
        SUBFLAG5, 
        SUBFLAG6, 
        SUBFLAG7, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        WTRDATA1, 
        WTRDATA2, 
        WTRDATA3, 
        WTRDATA4, 
        WTRDATA5, 
        WTRDATA6, 
        WTRDATA7, 
        ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET_HISTORY.IPS_DELETED_WSLBILLING_MIGSERVICES
    UNION ALL 
    SELECT 
        ACCOUNTNUMBER, 
        ACCOUNTSERVICEKEY, 
        ADDBY, 
        ADDDTTM, 
        ADDRESSKEY1, 
        ADDRESSKEY2, 
        ADDRESSKEY3, 
        ADDRESSKEY4, 
        ADDRESSKEY5, 
        ADDRESSKEY6, 
        ADDRESSKEY7, 
        ANNUALFIX, 
        BILLABLEPERC, 
        BILLABLEPERC1, 
        BILLABLEPERC2, 
        BILLABLEPERC3, 
        BILLABLEPERC4, 
        BILLABLEPERC5, 
        BILLABLEPERC6, 
        BILLABLEPERC7, 
        DATALAKE_DELETED, 
        LASTBILLDATE, 
        MIGSERVICESKEY, 
        MODBY, 
        MODDTTM, 
        MULTI, 
        NUMMETERS, 
        POSITION1, 
        POSITION2, 
        POSITION3, 
        POSITION4, 
        POSITION5, 
        POSITION6, 
        POSITION7, 
        PRICINGPLAN, 
        READDATE1, 
        READDATE2, 
        READDATE3, 
        READDATE4, 
        READDATE5, 
        READDATE6, 
        READDATE7, 
        SRVTYPE, 
        STARTDATE, 
        STARTKEY1, 
        STARTKEY2, 
        STARTKEY3, 
        STARTKEY4, 
        STARTKEY5, 
        STARTKEY6, 
        STARTKEY7, 
        STATUSMESG, 
        SUBFLAG1, 
        SUBFLAG2, 
        SUBFLAG3, 
        SUBFLAG4, 
        SUBFLAG5, 
        SUBFLAG6, 
        SUBFLAG7, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        WTRDATA1, 
        WTRDATA2, 
        WTRDATA3, 
        WTRDATA4, 
        WTRDATA5, 
        WTRDATA6, 
        WTRDATA7, 
        FALSE AS ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET.IPS_WSLBILLING_MIGSERVICES;