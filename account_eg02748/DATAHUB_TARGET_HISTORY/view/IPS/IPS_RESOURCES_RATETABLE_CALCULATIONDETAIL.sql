CREATE OR REPLACE VIEW DATAHUB_TARGET_HISTORY.IPS_RESOURCES_RATETABLE_CALCULATIONDETAIL AS 
    SELECT 
        ADDBY, 
        ADDDTTM, 
        BASEBILLABLEUSAGE, 
        CALCULATIONDETAILKEY, 
        CALCULATIONTABLE, 
        CONVERTEDUNITS, 
        DATALAKE_DELETED, 
        DAYSBETWEENREADS, 
        EFFDATE, 
        EFFTODATE, 
        FULLAMT, 
        ISPRORATESTEPSRATECHANGE, 
        MODBY, 
        MODDTTM, 
        NUMBEROFSTEPS, 
        PRORATEAMT, 
        RATETABLEDETAILKEY, 
        RTCHG1, 
        RTCHG10, 
        RTCHG2, 
        RTCHG3, 
        RTCHG4, 
        RTCHG5, 
        RTCHG6, 
        RTCHG7, 
        RTCHG8, 
        RTCHG9, 
        RTMAXCHG, 
        RTMINCHG, 
        RTPRORATESTEP1, 
        RTPRORATESTEP10, 
        RTPRORATESTEP2, 
        RTPRORATESTEP3, 
        RTPRORATESTEP4, 
        RTPRORATESTEP5, 
        RTPRORATESTEP6, 
        RTPRORATESTEP7, 
        RTPRORATESTEP8, 
        RTPRORATESTEP9, 
        RTRATECODE, 
        RTSTDDAYS, 
        RTUNIT, 
        RTUOM, 
        RTUSG1, 
        RTUSG10, 
        RTUSG2, 
        RTUSG3, 
        RTUSG4, 
        RTUSG5, 
        RTUSG6, 
        RTUSG7, 
        RTUSG8, 
        RTUSG9, 
        RTUSGDAYS, 
        SINGLERATE, 
        SRVUSGDAYS, 
        TOTALBILLABLEUSAGE, 
        TOTALUSAGEDAYS, 
        USEFORPRORATING, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET_HISTORY.IPS_DELETED_RESOURCES_RATETABLE_CALCULATIONDETAIL
    UNION ALL 
    SELECT 
        ADDBY, 
        ADDDTTM, 
        BASEBILLABLEUSAGE, 
        CALCULATIONDETAILKEY, 
        CALCULATIONTABLE, 
        CONVERTEDUNITS, 
        DATALAKE_DELETED, 
        DAYSBETWEENREADS, 
        EFFDATE, 
        EFFTODATE, 
        FULLAMT, 
        ISPRORATESTEPSRATECHANGE, 
        MODBY, 
        MODDTTM, 
        NUMBEROFSTEPS, 
        PRORATEAMT, 
        RATETABLEDETAILKEY, 
        RTCHG1, 
        RTCHG10, 
        RTCHG2, 
        RTCHG3, 
        RTCHG4, 
        RTCHG5, 
        RTCHG6, 
        RTCHG7, 
        RTCHG8, 
        RTCHG9, 
        RTMAXCHG, 
        RTMINCHG, 
        RTPRORATESTEP1, 
        RTPRORATESTEP10, 
        RTPRORATESTEP2, 
        RTPRORATESTEP3, 
        RTPRORATESTEP4, 
        RTPRORATESTEP5, 
        RTPRORATESTEP6, 
        RTPRORATESTEP7, 
        RTPRORATESTEP8, 
        RTPRORATESTEP9, 
        RTRATECODE, 
        RTSTDDAYS, 
        RTUNIT, 
        RTUOM, 
        RTUSG1, 
        RTUSG10, 
        RTUSG2, 
        RTUSG3, 
        RTUSG4, 
        RTUSG5, 
        RTUSG6, 
        RTUSG7, 
        RTUSG8, 
        RTUSG9, 
        RTUSGDAYS, 
        SINGLERATE, 
        SRVUSGDAYS, 
        TOTALBILLABLEUSAGE, 
        TOTALUSAGEDAYS, 
        USEFORPRORATING, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        FALSE AS ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET.IPS_RESOURCES_RATETABLE_CALCULATIONDETAIL;