CREATE OR REPLACE VIEW DATAHUB_TARGET_HISTORY.IPS_PORTAL_MEMBERSHIP AS 
    SELECT 
        ACTIVATEDDATE, 
        ACTIVATIONCODE, 
        ADDBY, 
        ADDDTTM, 
        APPROVEDDATE, 
        CONTACT, 
        DATALAKE_DELETED, 
        EXPDATE, 
        FAILEDPASSWORDANSWERCOUNT, 
        FAILEDPASSWORDCOUNT, 
        ISACTIVATED, 
        ISAPPROVED, 
        ISLOCKEDOUT, 
        ISPWDRESETREQ, 
        LASTLOGINDATE, 
        LASTPASSWORDCHANGEDDATE, 
        LASTPASSWORDRESETDATE, 
        LOCKEDOUTDATE, 
        MEMBERSHIPKEY, 
        MODBY, 
        MODDTTM, 
        PARENTUSER, 
        PASSWORDANSWERHASH, 
        PASSWORDANSWERSALT, 
        PASSWORDHASH, 
        PASSWORDQUESTION, 
        PASSWORDSALT, 
        USERNAME, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET_HISTORY.IPS_DELETED_PORTAL_MEMBERSHIP
    UNION ALL 
    SELECT 
        ACTIVATEDDATE, 
        ACTIVATIONCODE, 
        ADDBY, 
        ADDDTTM, 
        APPROVEDDATE, 
        CONTACT, 
        DATALAKE_DELETED, 
        EXPDATE, 
        FAILEDPASSWORDANSWERCOUNT, 
        FAILEDPASSWORDCOUNT, 
        ISACTIVATED, 
        ISAPPROVED, 
        ISLOCKEDOUT, 
        ISPWDRESETREQ, 
        LASTLOGINDATE, 
        LASTPASSWORDCHANGEDDATE, 
        LASTPASSWORDRESETDATE, 
        LOCKEDOUTDATE, 
        MEMBERSHIPKEY, 
        MODBY, 
        MODDTTM, 
        PARENTUSER, 
        PASSWORDANSWERHASH, 
        PASSWORDANSWERSALT, 
        PASSWORDHASH, 
        PASSWORDQUESTION, 
        PASSWORDSALT, 
        USERNAME, 
        VARIATION_ID, 
        VARIATION_ID AS ETL_SEQUENCE_NUMBER,
        FALSE AS ETL_IS_DELETED,
        ETL_LOAD_DATETIME,
        ETL_LOAD_METADATAFILENAME
    FROM DATAHUB_TARGET.IPS_PORTAL_MEMBERSHIP;